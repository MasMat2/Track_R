"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2857],{1639:(E,f,e)=>{e.r(f),e.d(f,{default:()=>p});var h=e(12),a=e(433),g=e(6895),n=e(1571),v=e(933),C=e(4602),c=e(4384);const m=["jaasContainer"],p=[{path:"",children:[{path:"answer-call/:meet-name",component:(()=>{var s;class _{constructor(o,i,d){this.orientationService=o,this.router=i,this.dataJitsiService=d,this.domain="8x8.vc",this.isAudioMuted=!1,this.isVideoMuted=!1}ngOnInit(){}executeCommand(o){if("hangup"==o){const i=document.getElementById("jaas-container");return i&&(i.innerHTML=""),this.router.navigate(["/home"]),this.orientationService.lockPortrait(),void this.dataJitsiService.hangup()}"toggleAudio"==o&&(this.isAudioMuted=!this.isAudioMuted),"toggleVideo"==o&&(this.isVideoMuted=!this.isVideoMuted)}}return(s=_).\u0275fac=function(o){return new(o||s)(n.Y36(C.H),n.Y36(c.F0),n.Y36(v.s))},s.\u0275cmp=n.Xpm({type:s,selectors:[["app-answer-meet"]],standalone:!0,features:[n.jDz],decls:2,vars:0,consts:[["id","jaas-container"],["jaasContainer",""]],template:function(o,i){1&o&&n._UZ(0,"div",0,1)},dependencies:[h.Pc,g.ez,a.u5],styles:['@charset "UTF-8";#jaas-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;position:relative}.hangup-btn[_ngcontent-%COMP%]{position:absolute;bottom:0;padding:0;text-align:end;direction:revert;height:10%}']}),_})()},{path:"create-call/:id-chat",component:(()=>{var s;class _{constructor(o,i,d){this.dataJitsiService=o,this.orientationService=i,this.router=d,this.chats=[],this.isAudioMuted=!1,this.isVideoMuted=!1}ngOnInit(){}ngAfterViewInit(){}executeCommand(o){if("hangup"==o){const i=document.getElementById("jaas-container");return i&&(i.innerHTML=""),this.router.navigate(["/home"]),this.orientationService.lockPortrait(),void this.dataJitsiService.hangup()}"toggleAudio"==o&&(this.isAudioMuted=!this.isAudioMuted),"toggleVideo"==o&&(this.isVideoMuted=!this.isVideoMuted)}}return(s=_).\u0275fac=function(o){return new(o||s)(n.Y36(v.s),n.Y36(C.H),n.Y36(c.F0))},s.\u0275cmp=n.Xpm({type:s,selectors:[["app-create-jitsi-meet"]],viewQuery:function(o,i){if(1&o&&n.Gf(m,5),2&o){let d;n.iGM(d=n.CRH())&&(i.jaasContainer=d.first)}},standalone:!0,features:[n.jDz],decls:2,vars:0,consts:[["id","jaas-container"],["jaasContainer",""]],template:function(o,i){1&o&&n._UZ(0,"div",0,1)},dependencies:[h.Pc,g.ez,a.u5],styles:['@charset "UTF-8";#jaas-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}.hangup-btn[_ngcontent-%COMP%]{position:absolute;bottom:0;padding:0;text-align:end;direction:revert;height:10%}']}),_})()}]}]},9160:(E,f,e)=>{e.d(f,{L:()=>o});var h=e(5861),a=e(9856),g=e(5079),n=e(1651),v=e(162),C=e(1135),c=e(9300),m=e(5698),P=e(7414),D=e(262),p=e(2340),s=e(1571),_=e(2644),l=e(5423);let o=(()=>{var i;class d{constructor(t,r){this.ChatPersonaService=t,this.authService=r,this.connectionStatus=new C.X(a.A.Disconnected),this.chatSubject=new C.X([]),this.chat$=this.chatSubject.asObservable(),this.endpoint="hub/chat",this.iniciarConexion()}iniciarConexion(){var t=this;return(0,h.Z)(function*(){const r=yield t.authService.obtenerToken();if(!r)return;const u=`${p.N.urlBackend}${t.endpoint}`,A={accessTokenFactory:()=>r,transport:g.n.LongPolling};t.connection=(new n.s).configureLogging(v.i.Debug).withUrl(u,A).build(),t.connection.on("NuevoChat",(M,S)=>t.onNuevoChat(M,S)),t.connection.on("NuevaConexion",M=>t.onNuevaConexion(M)),t.connection.on("CargarChats",M=>t.onCargarChats(M)),t.connectionStatus.next(a.A.Connecting),yield t.connection.start()})()}detenerConexion(){var t=this;return(0,h.Z)(function*(){t.connectionStatus.next(a.A.Disconnecting),yield t.connection.stop(),t.chatSubject.next([]),t.connectionStatus.next(a.A.Disconnected)})()}obtenerNotificaciones(){return this.chatSubject.value}onNuevoChat(t,r){var u=this;return(0,h.Z)(function*(){t.fecha=new Date,u.chatSubject.value.push(t)})()}onNuevaConexion(t){for(const r of t)r.fecha=new Date(r.fecha);this.chatSubject.next(t)}onCargarChats(t){this.chatSubject.next(t)}ensureConnection(){var t=this;return(0,h.Z)(function*(){if(t.connection.state!==a.A.Connected){if(t.connection.state===a.A.Disconnected||t.connection.state===a.A.Disconnecting)throw new Error("No se ha iniciado la conexion con el Hub de Notificaciones");(t.connection.state===a.A.Connecting||t.connection.state===a.A.Reconnecting)&&t.connectionStatus.asObservable().pipe((0,c.h)(u=>u===a.A.Connected),(0,m.q)(1),(0,P.V)(1e4),(0,D.K)(()=>{throw new Error("No se pudo establecer la conexi\xf3n con el Hub de Notificaciones")}))}})()}agregarChat(t,r){var u=this;return(0,h.Z)(function*(){yield u.ensureConnection(),yield u.connection.invoke("NuevoChat",t,r)})()}abandonarChat(t){let r=this.chatSubject.value;r=r.filter(u=>u.idChat!=t),this.chatSubject.next(r)}}return(i=d).\u0275fac=function(t){return new(t||i)(s.LFG(_.R),s.LFG(l.e))},i.\u0275prov=s.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),d})()},2644:(E,f,e)=>{e.d(f,{R:()=>g});var h=e(1571),a=e(529);let g=(()=>{var n;class v{constructor(c){this.http=c,this.dataUrl="ChatPersona/"}agregarPersonas(c){return this.http.post(this.dataUrl,c)}obtenerIdUsuario(){return this.http.get(`${this.dataUrl}IdUsuario`)}obtenerIdPacientesPadecimiento(c){return this.http.get(`${this.dataUrl}Padecimiento/${c}`)}}return(n=v).\u0275fac=function(c){return new(c||n)(h.LFG(a.eN))},n.\u0275prov=h.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),v})()}}]);