"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3843],{1443:(Z,M,l)=>{l.d(M,{ez:()=>h,tP:()=>a});var a=(()=>{return(u=a||(a={})).Documents="DOCUMENTS",u.Data="DATA",u.Library="LIBRARY",u.Cache="CACHE",u.External="EXTERNAL",u.ExternalStorage="EXTERNAL_STORAGE",a;var u})(),h=(()=>{return(u=h||(h={})).UTF8="utf8",u.ASCII="ascii",u.UTF16="utf16",h;var u})()},6715:(Z,M,l)=>{l.d(M,{k$:()=>h,y$:()=>a});var a=(()=>{return(u=a||(a={})).Heavy="HEAVY",u.Medium="MEDIUM",u.Light="LIGHT",a;var u})(),h=(()=>{return(u=h||(h={})).Success="SUCCESS",u.Warning="WARNING",u.Error="ERROR",h;var u})()},3843:(Z,M,l)=>{l.r(M),l.d(M,{default:()=>Do});var a=l(9149),h=l(6895),o=l(1571),y=l(9160),u=l(4273),F=l(4328),k=l(1481);let N=(()=>{var e;class c{constructor(t,n,r,s){this.ChatHubServiceService=t,this.chatMensajeHubService=n,this.archivoService=r,this.sanitizer=s,this.chats=[],this.mensajes=[],this.clickEnChat=!1}ngOnInit(){this.obtenerChats(),this.obtenerMensajes()}obtenerChats(){this.chats$=this.ChatHubServiceService.chat$,this.chats$.subscribe(t=>{this.chats=t,this.obtenerUltimoMensaje()})}obtenerMensajes(){this.chatMensajes$=this.chatMensajeHubService.chatMensaje$,this.chatMensajes$.subscribe(t=>{this.mensajes=t,this.obtenerUltimoMensaje()})}enviarMensaje(t){this.chatMensajeHubService.enviarMensaje({fecha:new Date,idChat:t,mensaje:this.contenido,idPersona:5333,idArchivo:0})}obtenerChatSeleccionado(t){this.idChatSeleccionado=t,this.mensajesChatSeleccionado=this.mensajes.find(n=>n.some(r=>r.idChat===this.idChatSeleccionado))||[],this.clickEnChat=!0}obtenerUltimoMensaje(){let t=this.mensajes.map(n=>{var r;return(null===(r=n[n.length-1])||void 0===r?void 0:r.mensaje)||""});this.chats.forEach((n,r)=>{n.ultimoMensaje=t[r]})}}return(e=c).\u0275fac=function(t){return new(t||e)(o.Y36(y.L),o.Y36(u.U),o.Y36(F.g),o.Y36(k.H7))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-chat-movil"]],standalone:!0,features:[o.jDz],decls:1,vars:0,template:function(t,n){1&t&&o._UZ(0,"ion-router-outlet")},dependencies:[a.Pc,a.jP,h.ez]}),c})();var J=l(8622),v=l(433),T=l(2583),p=l(1297),O=l(4384),Y=l(226),I=l(2644);function G(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"ion-toolbar",12)(1,"ion-searchbar",13),o.NdJ("ionChange",function(n){o.CHM(i);const r=o.oxw();return o.KtG(r.buscarChat(n))}),o.qZA()()}}function H(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"div",18)(1,"ion-item",19)(2,"ion-input",20),o.NdJ("ngModelChange",function(n){o.CHM(i);const r=o.oxw(2);return o.KtG(r.tituloChat=n)}),o.qZA(),o.TgZ(3,"ion-button",21),o.NdJ("click",function(){o.CHM(i);const n=o.oxw(2);return o.KtG(n.crearChat())}),o._UZ(4,"ion-icon",22),o.qZA()()()}if(2&e){const i=o.oxw(2);o.xp6(2),o.Q6J("ngModel",i.tituloChat)}}function $(e,c){if(1&e&&o._UZ(0,"ion-img",29),2&e){const i=o.oxw().$implicit;o.Q6J("src",i.urlImagen)}}function z(e,c){1&e&&o._UZ(0,"ion-img",30)}function R(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"div",23),o.NdJ("click",function(){const r=o.CHM(i).$implicit,s=o.oxw(2);return o.KtG(s.doctorClick(r.idUsuarioDoctor))}),o.TgZ(1,"div",24)(2,"ion-avatar"),o.YNc(3,$,1,1,"ion-img",25),o.YNc(4,z,1,0,"ion-img",26),o.qZA(),o.TgZ(5,"div",27),o._UZ(6,"ion-icon",7),o.qZA()(),o.TgZ(7,"div",28)(8,"ion-label")(9,"p"),o._uU(10),o.qZA()()()()}if(2&e){const i=c.$implicit;o.xp6(3),o.Q6J("ngIf",i.urlImagen),o.xp6(1),o.Q6J("ngIf",!i.urlImagen),o.xp6(6),o.Oqu(i.nombre)}}function L(e,c){if(1&e&&(o.TgZ(0,"div",14),o.YNc(1,H,5,1,"div",15),o.TgZ(2,"div",16),o.YNc(3,R,11,3,"div",17),o.qZA()()),2&e){const i=o.oxw();o.xp6(1),o.Q6J("ngIf",i.doctorSeleccionado),o.xp6(2),o.Q6J("ngForOf",i.misDoctores)}}function Q(e,c){if(1&e&&o._UZ(0,"ion-img",29),2&e){const i=o.oxw().$implicit;o.Q6J("src",i.urlImagen)}}function q(e,c){1&e&&o._UZ(0,"ion-img",30)}function K(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"ion-list")(1,"ion-item",31),o.NdJ("click",function(){const r=o.CHM(i).$implicit,s=o.oxw();return o.KtG(s.enviarIdChat(r.idChat||0))}),o.TgZ(2,"ion-avatar",32),o.YNc(3,Q,1,1,"ion-img",25),o.YNc(4,q,1,0,"ion-img",26),o.qZA(),o.TgZ(5,"ion-label")(6,"h3"),o._uU(7),o.qZA(),o.TgZ(8,"p"),o._uU(9),o.qZA()()()()}if(2&e){const i=c.$implicit;o.xp6(3),o.Q6J("ngIf",i.urlImagen),o.xp6(1),o.Q6J("ngIf",!i.urlImagen),o.xp6(3),o.hij(" ",i.titulo," "),o.xp6(2),o.hij(" ",i.ultimoMensaje," ")}}let X=(()=>{var e;class c{constructor(t,n,r,s,d,g){this.router=t,this.ChatHubServiceService=n,this.archivoService=r,this.sanitizer=s,this.doctoresService=d,this.ChatPersonaService=g,this.usuarios=[],this.doctorSeleccionado=!1,this.verListaDoctores=!1,(0,T.a)({addCircle:p.ZWo,chatboxOutline:p.DMF,send:p.lWK})}ionViewWillEnter(){this.obtenerChats(),this.consultarDoctores(),this.obtenerIdUsuario()}obtenerIdUsuario(){this.ChatPersonaService.obtenerIdUsuario().subscribe(t=>{this.idUsuario=t})}obtenerChats(){this.chats$=this.ChatHubServiceService.chat$,this.chats$.subscribe(t=>{t.forEach(n=>{if(null!=n.imagenBase64){let r="data:"+n.tipoMime+";base64,"+n.imagenBase64;this.sanitizer.bypassSecurityTrustUrl(r),n.urlImagen=r}}),this.chats=t,this.chatsFiltradosPorBusqueda=t})}enviarIdChat(t){this.router.navigate(["home/chat-movil/chat",t])}consultarDoctores(){this.doctoresService.consultarExpedienteConImagenes().subscribe(t=>{t.forEach(n=>{null!=n.imagenBase64&&(n.urlImagen="data:"+n.tipoMime+";base64,"+n.imagenBase64)}),this.misDoctores=t})}doctorClick(t){this.doctorSeleccionado=!this.doctorSeleccionado,this.usuarios=[],this.usuarios.push(this.idUsuario),this.usuarios.push(t)}crearChat(){this.ChatHubServiceService.agregarChat({fecha:new Date,habilitado:!0,idCreadorChat:this.usuarios[this.usuarios.length-1],titulo:this.tituloChat},this.usuarios),this.tituloChat="",this.usuarios=[],this.doctorSeleccionado=!1}mostrarListaDoctores(){this.verListaDoctores=!this.verListaDoctores,this.doctorSeleccionado=!1}buscarChat(t){const n=t.target.value;this.chatsFiltradosPorBusqueda=this.chats,n&&""!=n.trim()&&(this.chatsFiltradosPorBusqueda=this.chatsFiltradosPorBusqueda.filter(r=>r.titulo.toLowerCase().indexOf(n.toLowerCase())>-1||r.ultimoMensaje.toLowerCase().indexOf(n.toLowerCase())>-1))}}return(e=c).\u0275fac=function(t){return new(t||e)(o.Y36(O.F0),o.Y36(y.L),o.Y36(F.g),o.Y36(k.H7),o.Y36(Y.q),o.Y36(I.R))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-barra-chats"]],standalone:!0,features:[o._Bn([]),o.jDz],decls:15,vars:3,consts:[[1,"ion-no-border"],[1,"primary-toolbar"],["slot","end"],[3,"click"],[2,"position","relative"],["name","chatbox-outline",2,"font-size","1.5em"],[2,"position","absolute","top","-6px","right","-6px"],["name","add-circle"],["class","barra-busqueda",4,"ngIf"],["class","contactos",4,"ngIf"],[1,"chats"],[4,"ngFor","ngForOf"],[1,"barra-busqueda"],["show-cancel-button","focus","placeholder","Buscar","animated","",3,"ionChange"],[1,"contactos"],["class","generar-chat",4,"ngIf"],[1,"lista-doctores"],["class","doctor",3,"click",4,"ngFor","ngForOf"],[1,"generar-chat"],["lines","none"],["label","Generar chat: ","placeholder","Nombre del chat","labelPlacement","floating","name","tituloChat",1,"nombre-chat",3,"ngModel","ngModelChange"],["slot","end","fill","clear",3,"click"],["slot","icon-only","name","send"],[1,"doctor",3,"click"],[1,"imagen"],[3,"src",4,"ngIf"],["alt","profile pic","src","https://ionicframework.com/docs/img/demos/avatar.svg",4,"ngIf"],[1,"icono-agregar"],[1,"nombre"],[3,"src"],["alt","profile pic","src","https://ionicframework.com/docs/img/demos/avatar.svg"],["lines","none","button","true",1,"chat",3,"click"],["slot","start"]],template:function(t,n){1&t&&(o.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),o._uU(3,"Chats"),o.qZA(),o.TgZ(4,"ion-buttons",2)(5,"ion-button",3),o.NdJ("click",function(){return n.mostrarListaDoctores()}),o.TgZ(6,"div",4),o._UZ(7,"ion-icon",5),o.TgZ(8,"div",6),o._UZ(9,"ion-icon",7),o.qZA()()()()(),o.YNc(10,G,2,0,"ion-toolbar",8),o.qZA(),o.TgZ(11,"ion-content"),o.YNc(12,L,4,2,"div",9),o.TgZ(13,"div",10),o.YNc(14,K,10,4,"ion-list",11),o.qZA()()),2&t&&(o.xp6(10),o.Q6J("ngIf",!n.verListaDoctores),o.xp6(2),o.Q6J("ngIf",n.verListaDoctores),o.xp6(2),o.Q6J("ngForOf",n.chatsFiltradosPorBusqueda))},dependencies:[J.U$,h.ez,h.sg,h.O5,a.Pc,a.BJ,a.YG,a.Sm,a.W2,a.Gu,a.gu,a.Xz,a.pK,a.Ie,a.Q$,a.q_,a.VI,a.wd,a.sr,a.j9,v.u5,v.JJ,v.On],styles:['[_ngcontent-%COMP%]:root{--color-primario: #9BD8AC;--color-secundario: #9ED1FE;--color-terceario: #671E75;--color-fuente-secundario: #7F7F7F;--background-primario: #0278E4;--background-secundario: #11B2A9;--background-terceario: #671E75;--ion-color-primary: #9BD8AC;--ion-color-primary-rgb: 155, 216, 172;--ion-color-primary-contrast: #000000;--ion-color-primary-contrast-rgb: 0, 0, 0;--ion-color-primary-shade: #6CC686;--ion-color-primary-tint: #B6E2C2;--ion-color-secondary: #9ED1FE;--ion-color-secondary-rgb: 158, 209, 254;--ion-color-secondary-contrast: #000000;--ion-color-secondary-contrast-rgb: 0, 0, 0;--ion-color-secondary-shade: #86C6FE;--ion-color-secondary-tint: #C2E2FE;--ion-color-tertiary: #671E75;--ion-color-tertiary-rgb: 103, 30, 117;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255, 255, 255;--ion-color-tertiary-shade: #471551;--ion-color-tertiary-tint: #802692;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45, 211, 111;--ion-color-success-contrast: #ffffff;--ion-color-success-contrast-rgb: 255, 255, 255;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255, 196, 9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0, 0, 0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235, 68, 90;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255, 255, 255;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-dark: #222428;--ion-color-dark-rgb: 34, 36, 40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255, 255, 255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146, 148, 156;--ion-color-medium-contrast: #ffffff;--ion-color-medium-contrast-rgb: 255, 255, 255;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244, 245, 248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0, 0, 0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9;--accent-color-green: #9bd8ac;--primary-50: #F3F4FA;--primary-100: #EAEBF5;--primary-200: #D8D9ED;--primary-300: #C0C2E1;--primary-400: #A8A6D3;--primary-500: #958FC5;--primary-600: #8377B4;--primary-700: #695e93;--primary-800: #5C547F;--primary-900: #4D4867;--primary-950: #2D2A3C;--neutral-50: #FFFFFF;--neutral-100: #F4F4F4;--neutral-200: #DCDCDC;--neutral-300: #BDBDBD;--neutral-400: #989898;--neutral-500: #7C7C7C;--neutral-600: #656565;--neutral-700: #525252;--neutral-800: #464646;--neutral-900: #292929;--neutral-950: #000000;--error-100: #F9DEDC;--error-200: #B3261E;--error-300: #410E0B;--font-display: "Gayathri", sans-serif;--font-body: "Inter", sans-serif}[_ngcontent-%COMP%]:root   .ion-color-morado-custom[_ngcontent-%COMP%]{--ion-color-base: var(--primary-700);--ion-color-base-rgb: var(--primary-700);--ion-color-contrast: var(--neutral-50);--ion-color-contrast-rgb: var(--neutral-50);--ion-color-shade: var(--primary-950);--ion-color-tint: var(--primary-300)}ion-content[_ngcontent-%COMP%]{--background: var(--neutral-100)}ion-header[_ngcontent-%COMP%]{border-radius:10px;background:var(--neutral-100)}button.alert-button.alert-button-custom[_ngcontent-%COMP%]{color:var(--primary-600)}ion-alert.custom-alert[_ngcontent-%COMP%]   button.alert-button[_ngcontent-%COMP%]{color:var(--primary-600)}ion-alert.custom-select-alert[_ngcontent-%COMP%]   .alert-button-group[_ngcontent-%COMP%]   button.alert-button[_ngcontent-%COMP%]{color:var(--primary-600)}ion-alert.custom-select-alert[_ngcontent-%COMP%]   .alert-radio-group[_ngcontent-%COMP%]   button.alert-radio-button[_ngcontent-%COMP%]   .alert-radio-icon[_ngcontent-%COMP%]{border-color:var(--primary-500)}ion-alert.custom-select-alert[_ngcontent-%COMP%]   .alert-radio-group[_ngcontent-%COMP%]   button.alert-radio-button[_ngcontent-%COMP%]   .alert-radio-icon[_ngcontent-%COMP%]   .alert-radio-inner[_ngcontent-%COMP%]{background-color:var(--primary-700)}@media (prefers-color-scheme: dark){body[_ngcontent-%COMP%]{--ion-color-primary: #428cff;--ion-color-primary-rgb: 66,140,255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255,255,255;--ion-color-primary-shade: #3a7be0;--ion-color-primary-tint: #5598ff;--ion-color-secondary: #50c8ff;--ion-color-secondary-rgb: 80,200,255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255,255,255;--ion-color-secondary-shade: #46b0e0;--ion-color-secondary-tint: #62ceff;--ion-color-tertiary: #6a64ff;--ion-color-tertiary-rgb: 106,100,255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255,255,255;--ion-color-tertiary-shade: #5d58e0;--ion-color-tertiary-tint: #7974ff;--ion-color-success: #2fdf75;--ion-color-success-rgb: 47,223,117;--ion-color-success-contrast: #000000;--ion-color-success-contrast-rgb: 0,0,0;--ion-color-success-shade: #29c467;--ion-color-success-tint: #44e283;--ion-color-warning: #ffd534;--ion-color-warning-rgb: 255,213,52;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0,0,0;--ion-color-warning-shade: #e0bb2e;--ion-color-warning-tint: #ffd948;--ion-color-danger: #ff4961;--ion-color-danger-rgb: 255,73,97;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255,255,255;--ion-color-danger-shade: #e04055;--ion-color-danger-tint: #ff5b71;--ion-color-dark: #f4f5f8;--ion-color-dark-rgb: 244,245,248;--ion-color-dark-contrast: #000000;--ion-color-dark-contrast-rgb: 0,0,0;--ion-color-dark-shade: #d7d8da;--ion-color-dark-tint: #f5f6f9;--ion-color-medium: #989aa2;--ion-color-medium-rgb: 152,154,162;--ion-color-medium-contrast: #000000;--ion-color-medium-contrast-rgb: 0,0,0;--ion-color-medium-shade: #86888f;--ion-color-medium-tint: #a2a4ab;--ion-color-light: #222428;--ion-color-light-rgb: 34,36,40;--ion-color-light-contrast: #ffffff;--ion-color-light-contrast-rgb: 255,255,255;--ion-color-light-shade: #1e2023;--ion-color-light-tint: #383a3e}}ion-header[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-weight:700}ion-header[_ngcontent-%COMP%]   .primary-toolbar[_ngcontent-%COMP%]{--border-width: 1px 0;--border-color: var(--neutral-200)}.barra-busqueda[_ngcontent-%COMP%]{--background: var(--neutral-100)}.barra-busqueda[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{--background: var(--primary-100);--border-radius: 5px}.contactos[_ngcontent-%COMP%]   .lista-doctores[_ngcontent-%COMP%]{border:1px solid var(--neutral-200);background:var(--neutral-50);display:flex;overflow-x:scroll;overflow-y:hidden;align-items:center}.contactos[_ngcontent-%COMP%]   .lista-doctores[_ngcontent-%COMP%]   .doctor[_ngcontent-%COMP%]{height:20vh;min-width:33.33%;display:inline-block}.contactos[_ngcontent-%COMP%]   .lista-doctores[_ngcontent-%COMP%]   .doctor[_ngcontent-%COMP%]   .imagen[_ngcontent-%COMP%]{margin-top:10px;position:relative;height:50%}.contactos[_ngcontent-%COMP%]   .lista-doctores[_ngcontent-%COMP%]   .doctor[_ngcontent-%COMP%]   .imagen[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{margin:auto}.contactos[_ngcontent-%COMP%]   .lista-doctores[_ngcontent-%COMP%]   .doctor[_ngcontent-%COMP%]   .imagen[_ngcontent-%COMP%]   .icono-agregar[_ngcontent-%COMP%]{position:absolute;top:0;right:0;font-size:1.2em}.contactos[_ngcontent-%COMP%]   .lista-doctores[_ngcontent-%COMP%]   .doctor[_ngcontent-%COMP%]   .nombre[_ngcontent-%COMP%]{height:10vh}.contactos[_ngcontent-%COMP%]   .lista-doctores[_ngcontent-%COMP%]   .doctor[_ngcontent-%COMP%]   .nombre[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{text-align:center}.contactos[_ngcontent-%COMP%]   .lista-doctores[_ngcontent-%COMP%]   .doctor[_ngcontent-%COMP%]   .nombre[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9em}.contactos[_ngcontent-%COMP%]   .generar-chat[_ngcontent-%COMP%]   .nombre-chat[_ngcontent-%COMP%]{--padding-end: 10px;--padding-start: 10px;--padding-bottom: 10px;border:0px}.contactos[_ngcontent-%COMP%]   .generar-chat[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--primary-700)}.contactos[_ngcontent-%COMP%]   .generar-chat[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{font-size:1em;--ripple-color: var(--primary-200)}.chats[_ngcontent-%COMP%]{height:78vh;padding-top:3vh}.chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{background:var(--neutral-100)}.chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   .chat[_ngcontent-%COMP%]{--background: var(--neutral-100)}.chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   .chat[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{--border-radius: 15px}.chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   .chat[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.9em;font-weight:700}.chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   .chat[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8em}']}),c})();var C=l(5861),A=l(7423);const x=(0,A.fo)("VoiceRecorder",{web:()=>l.e(797).then(l.bind(l,797)).then(e=>new e.VoiceRecorderWeb)});var P=l(1443);const j=(0,A.fo)("Filesystem",{web:()=>l.e(6364).then(l.bind(l,6364)).then(e=>new e.FilesystemWeb)});var S=l(3930),W=l(4997);let E=(()=>{var e;class c{constructor(t){this.platform=t}isWeb(){const t=this.platform.platforms();return t.includes("desktop")||t.includes("mobileweb")}isMobile(){const t=this.platform.platforms();return(t.includes("android")||t.includes("ios"))&&!this.isWeb()}}return(e=c).\u0275fac=function(t){return new(t||e)(o.LFG(W.t4))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),c})();function V(e,c){if(1&e&&o._UZ(0,"ion-img",9),2&e){const i=o.oxw(2);o.Q6J("src",i.archivoBase64)}}function oo(e,c){if(1&e&&o._UZ(0,"audio",10),2&e){const i=o.oxw(2);o.Q6J("src",i.archivoBase64,o.LSH)}}function to(e,c){if(1&e&&(o.TgZ(0,"div",6),o.YNc(1,V,1,1,"ion-img",7),o.YNc(2,oo,1,1,"audio",8),o.qZA()),2&e){const i=o.oxw();o.xp6(1),o.Q6J("ngIf","image"===i.type),o.xp6(1),o.Q6J("ngIf","audio"===i.type)}}function no(e,c){if(1&e&&o._UZ(0,"ngx-extended-pdf-viewer",11),2&e){const i=o.oxw();o.Q6J("base64Src",i.archivo.archivo)("filenameForDownload",i.archivo.nombre)("useBrowserLocale",!0)("zoom","page-actual")("textLayer",!0)("zoom","auto")}}let eo=(()=>{var e;class c{constructor(t,n){this.modalController=t,this.plataformaService=n,(0,T.a)({chevronBack:p.Mny,downloadOutline:p.aO1})}ngOnInit(){this.type=this.archivo.archivoMime.split("/")[0],this.archivoBase64="data:"+this.archivo.archivoMime+";base64,"+this.archivo.archivo}regresarBtn(){this.modalController.dismiss()}descargarArchivo(){this.plataformaService.isMobile()?this.downloadFileMobile(this.archivo.archivo,this.archivo.nombre,this.archivo.archivoMime):this.plataformaService.isWeb()&&this.downloadFileWeb(this.archivo.archivo,this.archivo.nombre,this.archivo.archivoMime)}downloadFileMobile(t,n,r){return(0,C.Z)(function*(){try{yield j.requestPermissions();const g=(yield j.writeFile({path:`${n}`,data:t,directory:P.tP.External,recursive:!0})).uri;console.log(g)}catch(s){console.error("Error al descargar el archivo:",s)}})()}downloadFileWeb(t,n,r){const s=atob(t),d=new Array(s.length);for(let m=0;m<s.length;m++)d[m]=s.charCodeAt(m);const g=new Uint8Array(d),_=new Blob([g],{type:"application/octet-stream"}),b=URL.createObjectURL(_),f=document.createElement("a");document.body.appendChild(f),f.style.display="none",f.href=b,f.download=`${n}`,f.click(),URL.revokeObjectURL(b)}}return(e=c).\u0275fac=function(t){return new(t||e)(o.Y36(a.IN),o.Y36(E))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-archivo-previsualizar"]],standalone:!0,features:[o.jDz],decls:13,vars:2,consts:[[1,"header"],["fill","clear",3,"click"],["slot","icon-only","name","chevron-back"],["class","contenedor",4,"ngIf"],[3,"base64Src","filenameForDownload","useBrowserLocale","zoom","textLayer",4,"ngIf"],["slot","icon-only","name","download-outline"],[1,"contenedor"],["class","imagen",3,"src",4,"ngIf"],["controls","",3,"src",4,"ngIf"],[1,"imagen",3,"src"],["controls","",3,"src"],[3,"base64Src","filenameForDownload","useBrowserLocale","zoom","textLayer"]],template:function(t,n){1&t&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons")(3,"ion-button",1),o.NdJ("click",function(){return n.regresarBtn()}),o._UZ(4,"ion-icon",2),o.qZA()()()(),o.TgZ(5,"ion-content"),o.YNc(6,to,3,2,"div",3),o.YNc(7,no,1,6,"ngx-extended-pdf-viewer",4),o.qZA(),o.TgZ(8,"ion-footer")(9,"ion-toolbar")(10,"ion-buttons")(11,"ion-button",1),o.NdJ("click",function(){return n.descargarArchivo()}),o._UZ(12,"ion-icon",5),o.qZA()()()()),2&t&&(o.xp6(6),o.Q6J("ngIf","application"!==n.type),o.xp6(1),o.Q6J("ngIf","application"===n.type))},dependencies:[h.ez,h.O5,a.Pc,a.YG,a.Sm,a.W2,a.fr,a.Gu,a.gu,a.Xz,a.sr,S.g3,S.S3],styles:["ion-content[_ngcontent-%COMP%]{--background: var(--neutral-950)}.contenedor[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center}"]}),c})();var io=l(7579),ro=l(2805),ao=l(2722),co=l(2529),so=l(8746),lo=l(4004),D=l(6715);const U=(0,A.fo)("Haptics",{web:()=>l.e(5001).then(l.bind(l,5001)).then(e=>new e.HapticsWeb)});let uo=(()=>{var e;class c{constructor(){this.press=new o.vpe,this.pressGesture={name:"press",enabled:!1,interval:251},this.pressTimeout=null,this.isPressing=!1,this.lastTap=0,this.tapCount=0,this.tapTimeout=null}ngOnInit(){this.pressGesture.enabled=!0}onPress(t){this.pressGesture.enabled&&this.handlePressing(t.type)}handlePressing(t){"touchstart"==t?this.pressTimeout=setTimeout(()=>{this.isPressing=!0,this.press.emit("start")},this.pressGesture.interval):"touchend"==t&&(clearTimeout(this.pressTimeout),this.isPressing&&(this.press.emit("end"),this.resetTaps()),setTimeout(()=>this.isPressing=!1,50))}resetTaps(){clearTimeout(this.tapTimeout),this.tapCount=0,this.tapTimeout=null,this.lastTap=0}}return(e=c).\u0275fac=function(t){return new(t||e)},e.\u0275dir=o.lG2({type:e,selectors:[["","appPress",""]],hostBindings:function(t,n){1&t&&o.NdJ("touchstart",function(s){return n.onPress(s)})("touchend",function(s){return n.onPress(s)})},outputs:{press:"press"},standalone:!0}),c})(),ho=(()=>{var e;class c{constructor(t,n){this.gestureCtrl=t,this.el=n,this.swipe=new o.vpe,this.swipeGesture={name:"swipe",enabled:!1,interval:250,threshold:15,reportInterval:void 0,direction:["",""]},this.GESTURE_CREATED=!1,this.moveTimeout=null,this.isMoving=!1,this.lastSwipeReport=null}ngOnInit(){this.swipeGesture.enabled=!0,this.swipeGesture.direction=["left","right"],this.createGesture()}createGesture(){this.GESTURE_CREATED||(this.gestureCtrl.create({gestureName:"swipe-gesture",el:this.el.nativeElement,onStart:()=>{this.swipeGesture.enabled&&(this.isMoving=!0,this.moveTimeout=setInterval(()=>{this.isMoving=!1},249))},onMove:n=>{this.swipeGesture.enabled&&this.handleMoving("moving",n)},onEnd:n=>{this.swipeGesture.enabled&&this.handleMoving("moveend",n)}},!0).enable(),this.GESTURE_CREATED=!0)}handleMoving(t,n){null!==this.moveTimeout&&(clearTimeout(this.moveTimeout),this.moveTimeout=null);const r=n.deltaX,s=n.deltaY,d=Math.abs(r),g=Math.abs(s),_=this.swipeGesture.reportInterval||"live",b=this.swipeGesture.threshold;if(d<b&&g<b)return;const f=this.isMoving&&(null===this.lastSwipeReport||"live"===_||"end"===_&&"moveend"==t);if(this.lastSwipeReport=n.timeStamp,f){let m={dirX:void 0,dirY:void 0,swipeType:t,...n};d>b&&(r>0?m.dirX="right":r<0&&(m.dirX="left")),g>b&&(s>0?m.dirY="down":s<0&&(m.dirY="up"));const w=this.swipeGesture.direction;(w.includes(m.dirX)||w.includes(m.dirY))&&this.swipe.emit(m)}"moveend"==t&&null!==this.lastSwipeReport&&(this.isMoving=!1,this.lastSwipeReport=null)}}return(e=c).\u0275fac=function(t){return new(t||e)(o.Y36(a.TH),o.Y36(o.SBq))},e.\u0275dir=o.lG2({type:e,selectors:[["","appSwipe",""]],outputs:{swipe:"swipe"},standalone:!0}),c})();var B=l(458),go=l(3051),mo=l(529);let fo=(()=>{var e;class c{constructor(t){this.http=t,this.dataUrl="ArchivoTrackr/"}subirArchivo(t){return this.http.post(this.dataUrl,t)}getArchivo(t){return this.http.get(this.dataUrl+t)}}return(e=c).\u0275fac=function(t){return new(t||e)(o.LFG(mo.eN))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),c})();const po=["fileInput"],_o=["movableSpan"];function bo(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"ion-content")(1,"ion-list")(2,"ion-item",26),o.NdJ("click",function(){o.CHM(i);const n=o.oxw();return o.KtG(n.abandonarChat())}),o._uU(3,"Abandonar Chat"),o.qZA()()()}}function vo(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"textarea",33,34),o.NdJ("ngModelChange",function(n){o.CHM(i);const r=o.oxw(2);return o.KtG(r.msg=n)})("keyup.enter",function(){o.CHM(i);const n=o.oxw(2);return o.KtG(n.enviarMensaje())}),o._uU(2,"          "),o.qZA()}if(2&e){const i=o.oxw(2);o.Q6J("ngModel",i.msg)}}function Co(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"ion-header")(1,"ion-toolbar",27)(2,"ion-buttons")(3,"ion-button",6),o.NdJ("click",function(){o.CHM(i);const n=o.oxw();return o.KtG(n.cancelarEnviarFoto())}),o._UZ(4,"ion-icon",3),o.qZA()()()(),o.TgZ(5,"ion-content")(6,"div",28),o._UZ(7,"ion-img",29),o.qZA()(),o.TgZ(8,"ion-footer")(9,"ion-toolbar",30),o.YNc(10,vo,3,1,"textarea",31),o.TgZ(11,"ion-buttons",5)(12,"ion-button",6),o.NdJ("click",function(){o.CHM(i);const n=o.oxw();return o.KtG(n.enviarMensaje())}),o._UZ(13,"ion-icon",32),o.qZA()()()()}if(2&e){const i=o.oxw();o.xp6(7),o.Q6J("src",i.fotoTomada),o.xp6(3),o.Q6J("ngIf",!i.grabacionIniciada)}}function Mo(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"button",40),o.NdJ("click",function(){o.CHM(i);const n=o.oxw(2).$implicit,r=o.oxw();return o.KtG(r.clickArchivo(n.idArchivo))}),o._UZ(1,"i",41),o._uU(2),o.qZA()}if(2&e){const i=o.oxw(2).$implicit;o.xp6(2),o.hij(" ",i.archivoNombre," ")}}function yo(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"div",37)(1,"div",38),o.NdJ("click",function(){o.CHM(i);const n=o.oxw().$implicit,r=o.oxw();return o.KtG(r.validarMeet(n.mensaje))}),o._uU(2),o._UZ(3,"br"),o.YNc(4,Mo,3,1,"button",39),o._UZ(5,"br"),o._uU(6),o.qZA()()}if(2&e){const i=o.oxw().$implicit,t=o.oxw();o.xp6(2),o.hij(" ",i.mensaje," "),o.xp6(2),o.Q6J("ngIf",0!==i.idArchivo),o.xp6(2),o.hij(" ",t.imprimirFecha(i.fecha)," ")}}function xo(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"button",46),o.NdJ("click",function(){o.CHM(i);const n=o.oxw(2).$implicit,r=o.oxw();return o.KtG(r.clickArchivo(n.idArchivo))}),o._UZ(1,"i",41),o._uU(2),o.qZA()}if(2&e){const i=o.oxw(2).$implicit;o.xp6(2),o.hij(" ",i.archivoNombre," ")}}function Po(e,c){if(1&e&&(o.TgZ(0,"div",42)(1,"div",43)(2,"div",44),o._uU(3),o.qZA(),o._uU(4),o._UZ(5,"br"),o.YNc(6,xo,3,1,"button",45),o._UZ(7,"br"),o._uU(8),o.qZA()()),2&e){const i=o.oxw().$implicit,t=o.oxw();o.xp6(3),o.Oqu(i.nombrePersona),o.xp6(1),o.hij(" ",i.mensaje," "),o.xp6(2),o.Q6J("ngIf",0!==i.idArchivo),o.xp6(2),o.hij(" ",t.imprimirFecha(i.fecha)," ")}}function Oo(e,c){if(1&e&&(o.TgZ(0,"div"),o.YNc(1,yo,7,3,"div",35),o.YNc(2,Po,9,4,"div",36),o.qZA()),2&e){const i=c.$implicit,t=o.oxw();o.xp6(1),o.Q6J("ngIf",t.mostrarMensaje(i.idPersona)),o.xp6(1),o.Q6J("ngIf",!t.mostrarMensaje(i.idPersona))}}function wo(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"div",50),o._UZ(1,"audio",51),o.TgZ(2,"ion-buttons",52)(3,"ion-button",6),o.NdJ("click",function(){o.CHM(i);const n=o.oxw(2);return o.KtG(n.changeAudio())}),o._UZ(4,"ion-icon",53),o.qZA()()()}if(2&e){const i=o.oxw(2);o.xp6(1),o.Q6J("src",i.audio2,o.LSH)}}function To(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"div",50)(1,"ion-item",54),o._UZ(2,"ion-icon",55),o.TgZ(3,"ion-label"),o._uU(4),o.qZA()(),o.TgZ(5,"ion-buttons",52)(6,"ion-button",6),o.NdJ("click",function(){o.CHM(i);const n=o.oxw(2);return o.KtG(n.eliminarArchivo())}),o._UZ(7,"ion-icon",53),o.qZA()()()}if(2&e){const i=o.oxw(2);o.xp6(4),o.Oqu(null==i.archivo?null:i.archivo.name)}}function Ao(e,c){if(1&e&&(o.TgZ(0,"ion-toolbar",47),o.YNc(1,wo,5,1,"div",48),o.YNc(2,To,8,1,"div",49),o.qZA()),2&e){const i=o.oxw();o.xp6(1),o.Q6J("ngIf",i.isAudio),o.xp6(1),o.Q6J("ngIf",i.archivo)}}function jo(e,c){if(1&e&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&e){const i=o.oxw(2);o.xp6(1),o.hij(" ",i.duracionAudio," ")}}function Zo(e,c){if(1&e&&(o.TgZ(0,"div",56)(1,"div",57)(2,"ion-buttons",1)(3,"ion-button",58),o._UZ(4,"ion-icon",59),o.qZA()(),o.YNc(5,jo,2,1,"span",60),o.ALo(6,"async"),o.qZA(),o.TgZ(7,"span",61,62),o._uU(9," Desliza para cancelar "),o._UZ(10,"ion-icon",63),o.qZA()()),2&e){const i=o.oxw();o.xp6(5),o.Q6J("ngIf",o.lcZ(6,1,i.timer$))}}function Fo(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"ion-buttons",64)(1,"ion-button",6),o.NdJ("click",function(){o.CHM(i);const n=o.oxw();return o.KtG(n.openFileInput())}),o._UZ(2,"ion-icon",65),o.qZA(),o.TgZ(3,"input",66,67),o.NdJ("change",function(n){o.CHM(i);const r=o.oxw();return o.KtG(r.onFileSelected(n))}),o.qZA()()}}function ko(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"textarea",68,34),o.NdJ("ngModelChange",function(n){o.CHM(i);const r=o.oxw();return o.KtG(r.msg=n)})("keyup.enter",function(){o.CHM(i);const n=o.oxw();return o.KtG(n.enviarMensaje())}),o._uU(2,"      "),o.qZA()}if(2&e){const i=o.oxw();o.Q6J("ngModel",i.msg)}}function Io(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"ion-button",26),o.NdJ("click",function(){o.CHM(i);const n=o.oxw(2);return o.KtG(n.tomarFoto())}),o._UZ(1,"ion-icon",73),o.qZA()}}function So(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"ion-buttons",69),o.YNc(1,Io,2,0,"ion-button",70),o.TgZ(2,"ion-button",71),o.NdJ("press",function(n){o.CHM(i);const r=o.oxw();return o.KtG(r.presionarGrabarAudio(n))})("swipe",function(n){o.CHM(i);const r=o.oxw();return o.KtG(r.deslizarCancelarAudio(n))}),o._UZ(3,"ion-icon",72),o.qZA()()}if(2&e){const i=o.oxw();o.xp6(1),o.Q6J("ngIf",!i.grabacionIniciada)}}function Eo(e,c){if(1&e){const i=o.EpF();o.TgZ(0,"ion-buttons",74)(1,"div",18)(2,"ion-button",75),o.NdJ("click",function(){o.CHM(i);const n=o.oxw();return o.KtG(n.enviarMensaje())}),o._UZ(3,"ion-icon",76),o.qZA()()()}if(2&e){const i=o.oxw();o.xp6(2),o.Q6J("disabled",""===i.msg||void 0===i.msg)}}const Do=[{path:"",component:N,children:[{path:"",component:X},{path:"chat/:id",component:(()=>{var e;class c{constructor(t,n,r,s,d,g,_,b,f,m,w){this.ChatMensajeHubService=t,this.ChatPersonaService=n,this.router=r,this.route=s,this.ChatHubServiceService=d,this.ArchivoService=g,this.plataformaService=_,this.ModalController=b,this.capacitorUtils=f,this.PopoverController=m,this.rout=w,this.msg="",this.chat={fecha:new Date,habilitado:!0,titulo:"Chat",idCreadorChat:0},this.escribiendo=!1,this.isModalOpen=!1,this.stop$=new io.x,this.duracionAudio="",this.duracion=0,this.archivo=void 0,this.isAudio=!1,this.grabacionIniciada=!1,this.grabacionCancelada=!1,this.audio="",(0,T.a)({videocamOutline:p.sEt,chevronBack:p.Mny,cameraOutline:p.kuq,paperPlane:p.IAR,trash:p._Ij,documentOutline:p.Pf6,mic:p.ymr,micOutline:p.sBf,send:p.lWK})}ionViewWillEnter(){this.obtenerIdUsuario(),this.obtenerIdChat(),this.solicitarPermisos()}obtenerIdChat(){this.router.params.subscribe(t=>{this.idChat=Number(t.id),this.obtenerMensajes(),this.obtenerChat()})}obtenerChat(){this.ChatHubServiceService.chat$.subscribe(t=>{this.chat=t.find(n=>n.idChat==this.idChat)||{fecha:new Date,habilitado:!1,idCreadorChat:0}})}enviarMensaje(){var t=this;return(0,C.Z)(function*(){if(/^\n+$/.test(t.msg))return void(t.msg="");let r={fecha:new Date,idChat:t.idChat,mensaje:t.msg,idPersona:5333,archivo:"",idArchivo:0};if(t.archivo){let s=yield t.convertirBase64String();s=s.split(",")[1],r.archivo=s,r.archivoNombre=t.archivo.name,r.archivoTipoMime=t.archivo.type,r.fechaRealizacion=new Date,r.nombre=t.archivo.name}if(t.fotoTomada){let g=`Trackr-Image_${(0,go.Z)(new Date,"yyyy-MM-dd HH:mm:ss")}.jpeg`,_=t.fotoTomada.split(",")[1];r.archivo=_,r.archivoNombre=g,r.archivoTipoMime="image/jpeg",r.fechaRealizacion=new Date,r.nombre=g}""!=t.audio&&(r.archivo=t.audio,r.archivoNombre=`audio-${Date.now()}.wav`,r.archivoTipoMime="audio/wav",r.fechaRealizacion=new Date,r.nombre=`audio-${Date.now()}.wav`),t.ChatMensajeHubService.enviarMensaje(r),0==t.mensajes.length&&t.ChatMensajeHubService.chatMensaje$.subscribe(s=>{t.mensajes=s.find(d=>d.some(g=>g.idChat===t.idChat))||[]}),t.msg="",t.fotoTomada="",t.isModalOpen=!1,t.archivo=void 0,t.audio="",t.audio2="",t.isAudio=!1})()}obtenerIdUsuario(){this.ChatPersonaService.obtenerIdUsuario().subscribe(t=>{this.idUsuario=t})}mostrarMensaje(t){return t==this.idUsuario}obtenerMensajes(){this.chatMensajes$=this.ChatMensajeHubService.chatMensaje$,this.chatMensajes$.subscribe(t=>{this.chatMensajes=t,this.obtenerChatSeleccionado()})}obtenerChatSeleccionado(){this.mensajes=this.chatMensajes.find(t=>t.some(n=>n.idChat==this.idChat))||[]}regresarBtn(){this.route.navigate(["home/chat-movil"])}onFileSelected(t){this.archivo=t.target.files[0]}readFileAsByteArray(t){return new Promise((n,r)=>{const s=new FileReader;s.onload=d=>{const _=new Uint8Array(d.target.result);n(_)},s.onerror=d=>{r(d)},s.readAsArrayBuffer(t)})}convertirBase64String(){return new Promise((t,n)=>{if(this.archivo){const r=new FileReader;r.onload=s=>{t(s.target.result)},r.onerror=s=>{n(s)},r.readAsDataURL(this.archivo)}else n("No se ha seleccionado ning\xfan archivo.")})}subirArchivo(){var t=this;return(0,C.Z)(function*(){if(t.archivo){let n=yield t.readFileAsByteArray(t.archivo),r={idUsuario:5333,archivo:Array.from(n),archivoNombre:t.archivo.name,archivoTipoMime:t.archivo.type,fechaRealizacion:new Date,nombre:t.archivo.name};t.ArchivoService.subirArchivo(r).subscribe(s=>{})}})()}clickArchivo(t){var n=this;this.ArchivoService.getArchivo(t).subscribe(function(){var r=(0,C.Z)(function*(s){(yield n.ModalController.create({component:eo,componentProps:{archivo:s}})).present()});return function(s){return r.apply(this,arguments)}}())}downloadFileMobile(t,n,r){return(0,C.Z)(function*(){try{yield j.writeFile({path:`${P.tP.Data}/${n}`,data:t,directory:P.tP.External,recursive:!0})}catch(s){console.error("Error al descargar el archivo:",s)}})()}downloadFileWeb(t,n,r){const s=atob(t),d=new Array(s.length);for(let m=0;m<s.length;m++)d[m]=s.charCodeAt(m);const g=new Uint8Array(d),_=new Blob([g],{type:"application/octet-stream"}),b=URL.createObjectURL(_),f=document.createElement("a");document.body.appendChild(f),f.style.display="none",f.href=b,f.download=`${n}`,f.click(),URL.revokeObjectURL(b)}openFileInput(){""!=this.audio&&(this.audio="",this.audio2="",this.isAudio=!1),this.fileInput.nativeElement.click()}imprimirFecha(t){let n=new Date(t);return`${n.getDate()}/${n.getMonth()+1}/${n.getFullYear()} - ${n.getHours()}:${n.getMinutes()}`}ngAfterViewChecked(){this.scrollContentToBottom()}scrollContentToBottom(){this.content.scrollToBottom()}eliminarArchivo(){this.archivo=void 0}changeAudio(){this.audio="",this.audio2="",this.isAudio=!this.isAudio}solicitarPermisos(){x.hasAudioRecordingPermission().then(t=>{t.value||x.requestAudioRecordingPermission()})}grabar(){this.grabacionIniciada||(this.grabacionIniciada=!0,x.startRecording().then(t=>{this.calcularDuracion()}))}detenerGrabacion(){this.grabacionIniciada&&!this.grabacionCancelada?(this.archivo&&(this.archivo=void 0),x.stopRecording().then(t=>{this.grabacionIniciada=!1,this.isAudio=!0,t.value&&(this.audio=t.value.recordDataBase64,this.audio2="data:audio/wav;base64,"+t.value.recordDataBase64)})):this.grabacionCancelada=!1}cancelarGrabacion(){this.grabacionIniciada&&(this.archivo&&(this.archivo=void 0),x.stopRecording().then(t=>{this.grabacionCancelada=!0,this.grabacionIniciada=!1}))}calcularDuracion(){if(!this.grabacionIniciada)return this.duracion=0,void(this.duracionAudio="");this.timer$=(0,ro.H)(0,1e3).pipe((0,ao.R)(this.stop$),(0,co.o)(t=>this.duracion>=0),(0,so.x)(()=>{this.duracion=0}),(0,lo.U)(t=>{this.duracion=this.duracion+1;const n=Math.floor(this.duracion/60),r=(this.duracion%60).toString().padStart(2,"0");return this.duracionAudio=`${n}:${r}`,this.duracion}))}crearLlamada(){this.route.navigate(["/home/video-jitsi/create-call",this.idChat])}contestarLlamada(t){this.route.navigate(["/home/video-jitsi/answer-call",t])}validarMeet(t){if(t.includes("trackr-"+this.idChat)){const r=t.match(/trackr-\d{3}-\d+/);r&&r.length>0?this.contestarLlamada(r[0]):console.log("Error al validar codigo meet jitsi.")}}escribiendoMensaje(){return!/^ *$/.test(this.msg)}presionarGrabarAudio(t){"start"==t&&(U.impact({style:D.y$.Light}),this.grabar()),"end"==t&&(U.impact({style:D.y$.Light}),this.detenerGrabacion())}deslizarCancelarAudio(t){"left"==t.dirX&&(t.currentX<=t.startX-100&&this.cancelarGrabacion(),this.grabacionCancelada||this.updateSpanPosition(t.currentX-t.startX+15))}updateSpanPosition(t){this.movableSpan.nativeElement.style.transform=`translateX(calc(-50% + ${t}px))`}tomarFoto(){var t=this;return(0,C.Z)(function*(){t.archivo=void 0,t.audio="",t.audio2="",t.isAudio=!1,t.fotoTomada=yield t.capacitorUtils.takePicture(),t.isModalOpen=!0})()}cancelarEnviarFoto(){this.msg="",this.fotoTomada="",this.isModalOpen=!1}abandonarChat(){var t=this;return(0,C.Z)(function*(){t.ChatMensajeHubService.abandonarChat(t.idChat),t.ChatMensajeHubService.enviarMensaje({idChat:t.idChat,fecha:new Date,idPersona:0,mensaje:"He abandonado el chat",idArchivo:0}),yield t.PopoverController.dismiss(),t.regresarBtn()})()}}return(e=c).\u0275fac=function(t){return new(t||e)(o.Y36(u.U),o.Y36(I.R),o.Y36(O.gz),o.Y36(O.F0),o.Y36(y.L),o.Y36(fo),o.Y36(E),o.Y36(a.IN),o.Y36(B.Z),o.Y36(a.Dh),o.Y36(O.gz))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-mensajes"]],viewQuery:function(t,n){if(1&t&&(o.Gf(po,5),o.Gf(a.W2,5),o.Gf(_o,5)),2&t){let r;o.iGM(r=o.CRH())&&(n.fileInput=r.first),o.iGM(r=o.CRH())&&(n.content=r.first),o.iGM(r=o.CRH())&&(n.movableSpan=r.first)}},standalone:!0,features:[o._Bn([B.Z]),o.jDz],decls:31,vars:9,consts:[[1,"chat-header"],["slot","start"],["fill","clear","routerLink","home/chat-movil",3,"click"],["slot","icon-only","name","chevron-back"],[1,"ion-text-center","ion-align-items-center",2,"padding","1vh 2vw 1vh 2vw","font-size","1em","font-weight","bold"],["slot","end"],["fill","clear",3,"click"],["name","videocam-outline"],["fill","clear","id","puntos-trigger"],["name","ellipsis-vertical-outline"],["trigger","puntos-trigger","triggerAction","click"],[1,"enviar-foto-modal",3,"isOpen"],[1,"chat-container"],[1,"listado"],["scrollContainer",""],[2,"height","2vh"],[4,"ngFor","ngForOf"],[1,"chat-footer"],[1,"form-group"],["class","optional-toolbar",4,"ngIf"],[1,"main-toolbar"],["class","grabando-audio-container",4,"ngIf"],["slot","start","class","left-buttons",4,"ngIf"],["class","texto-mensaje","name","mensaje","type","text","maxlength","800","autocomplete","off","style","width: 100%","rows","1","required","",3,"ngModel","ngModelChange","keyup.enter",4,"ngIf"],["slot","end","class","right-buttons",4,"ngIf"],["slot","end","class","left-buttons",4,"ngIf"],[3,"click"],[1,"header"],[1,"contenedor-imagen"],[1,"imagen",3,"src"],[1,"footer"],["placeholder","A\xf1ade un comentario...","class","texto-mensaje","name","mensaje","type","text","maxlength","800","autocomplete","off","rows","1","required","",3,"ngModel","ngModelChange","keyup.enter",4,"ngIf"],["slot","icon-only","name","send",2,"color","var(--primary-700)"],["placeholder","A\xf1ade un comentario...","name","mensaje","type","text","maxlength","800","autocomplete","off","rows","1","required","",1,"texto-mensaje",3,"ngModel","ngModelChange","keyup.enter"],["descripcion","ngModel"],["class","message user",4,"ngIf"],["class","message other",4,"ngIf"],[1,"message","user"],[1,"message-bubble",3,"click"],["class","btn btn-1 archivo",3,"click",4,"ngIf"],[1,"btn","btn-1","archivo",3,"click"],[1,"fa","fa-file",2,"font-size","24px"],[1,"message","other"],[1,"message-bubble"],[1,"nombre"],["class","btn archivo",3,"click",4,"ngIf"],[1,"btn","archivo",3,"click"],[1,"optional-toolbar"],["style","display: flex; justify-content: space-between;  margin: 1vw 2vw 0 2vw;",4,"ngIf"],["style","display: flex; justify-content: space-between; margin: 1vw 2vw 0 2vw;",4,"ngIf"],[2,"display","flex","justify-content","space-between","margin","1vw 2vw 0 2vw"],["controls","",3,"src"],[2,"color","red","opacity","0.5"],["name","trash","slot","icon-only"],["lines","none"],["slot","start","name","document-outline"],[1,"grabando-audio-container"],[1,"contador-tiempo"],["fill","clear","disabled",""],["size","small","slot","icon-only","name","mic"],[4,"ngIf"],[2,"position","absolute","transform","translateX(-50%)","left","50%"],["movableSpan",""],["slot","icon-only","name","chevron-back",2,"position","absolute","right","-10%","bottom","18%"],["slot","start",1,"left-buttons"],["slot","icon-only","name","document-outline",2,"color","var(--primary-700)"],["type","file","id","fileInput",2,"display","none",3,"change"],["fileInput",""],["name","mensaje","type","text","maxlength","800","autocomplete","off","rows","1","required","",1,"texto-mensaje",2,"width","100%",3,"ngModel","ngModelChange","keyup.enter"],["slot","end",1,"right-buttons"],[3,"click",4,"ngIf"],["appSwipe","","appPress","",3,"press","swipe"],["slot","icon-only","name","mic-outline",2,"color","var(--primary-700)"],["slot","icon-only","name","camera-outline",2,"color","var(--primary-700)"],["slot","end",1,"left-buttons"],["type","submit",3,"disabled","click"],["slot","icon-only","name","paper-plane",2,"color","var(--primary-700)"]],template:function(t,n){1&t&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1)(3,"ion-button",2),o.NdJ("click",function(){return n.regresarBtn()}),o._UZ(4,"ion-icon",3),o.qZA()(),o.TgZ(5,"ion-title",4),o._uU(6),o.qZA(),o.TgZ(7,"ion-buttons",5)(8,"ion-button",6),o.NdJ("click",function(){return n.crearLlamada()}),o._UZ(9,"ion-icon",7),o.qZA(),o.TgZ(10,"ion-button",8),o._UZ(11,"ion-icon",9),o.qZA(),o.TgZ(12,"ion-popover",10),o.YNc(13,bo,4,0,"ng-template"),o.qZA()()()(),o.TgZ(14,"ion-content")(15,"ion-modal",11),o.YNc(16,Co,14,2,"ng-template"),o.qZA(),o.TgZ(17,"div",12)(18,"div",13,14),o._UZ(20,"div",15),o.YNc(21,Oo,3,2,"div",16),o.qZA()()(),o.TgZ(22,"ion-footer",17)(23,"div",18),o.YNc(24,Ao,3,2,"ion-toolbar",19),o.TgZ(25,"ion-toolbar",20),o.YNc(26,Zo,11,3,"div",21),o.YNc(27,Fo,5,0,"ion-buttons",22),o.YNc(28,ko,3,1,"textarea",23),o.YNc(29,So,4,1,"ion-buttons",24),o.YNc(30,Eo,4,1,"ion-buttons",25),o.qZA()()()),2&t&&(o.xp6(6),o.hij(" ",n.chat.titulo," "),o.xp6(9),o.Q6J("isOpen",n.isModalOpen),o.xp6(6),o.Q6J("ngForOf",n.mensajes),o.xp6(3),o.Q6J("ngIf",n.isAudio||n.archivo),o.xp6(2),o.Q6J("ngIf",n.grabacionIniciada),o.xp6(1),o.Q6J("ngIf",!n.grabacionIniciada),o.xp6(1),o.Q6J("ngIf",!n.grabacionIniciada),o.xp6(1),o.Q6J("ngIf",!n.escribiendoMensaje()),o.xp6(1),o.Q6J("ngIf",n.escribiendoMensaje()))},dependencies:[v.u5,v.Fj,v.JJ,v.Q7,v.nD,v.On,h.ez,h.sg,h.O5,h.Ov,a.Pc,a.YG,a.Sm,a.W2,a.fr,a.Gu,a.gu,a.Xz,a.Ie,a.Q$,a.q_,a.wd,a.sr,a.ki,a.d8,a.YI,uo,ho],styles:['[_ngcontent-%COMP%]:root{--color-primario: #9BD8AC;--color-secundario: #9ED1FE;--color-terceario: #671E75;--color-fuente-secundario: #7F7F7F;--background-primario: #0278E4;--background-secundario: #11B2A9;--background-terceario: #671E75;--ion-color-primary: #9BD8AC;--ion-color-primary-rgb: 155, 216, 172;--ion-color-primary-contrast: #000000;--ion-color-primary-contrast-rgb: 0, 0, 0;--ion-color-primary-shade: #6CC686;--ion-color-primary-tint: #B6E2C2;--ion-color-secondary: #9ED1FE;--ion-color-secondary-rgb: 158, 209, 254;--ion-color-secondary-contrast: #000000;--ion-color-secondary-contrast-rgb: 0, 0, 0;--ion-color-secondary-shade: #86C6FE;--ion-color-secondary-tint: #C2E2FE;--ion-color-tertiary: #671E75;--ion-color-tertiary-rgb: 103, 30, 117;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255, 255, 255;--ion-color-tertiary-shade: #471551;--ion-color-tertiary-tint: #802692;--ion-color-success: #2dd36f;--ion-color-success-rgb: 45, 211, 111;--ion-color-success-contrast: #ffffff;--ion-color-success-contrast-rgb: 255, 255, 255;--ion-color-success-shade: #28ba62;--ion-color-success-tint: #42d77d;--ion-color-warning: #ffc409;--ion-color-warning-rgb: 255, 196, 9;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0, 0, 0;--ion-color-warning-shade: #e0ac08;--ion-color-warning-tint: #ffca22;--ion-color-danger: #eb445a;--ion-color-danger-rgb: 235, 68, 90;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255, 255, 255;--ion-color-danger-shade: #cf3c4f;--ion-color-danger-tint: #ed576b;--ion-color-dark: #222428;--ion-color-dark-rgb: 34, 36, 40;--ion-color-dark-contrast: #ffffff;--ion-color-dark-contrast-rgb: 255, 255, 255;--ion-color-dark-shade: #1e2023;--ion-color-dark-tint: #383a3e;--ion-color-medium: #92949c;--ion-color-medium-rgb: 146, 148, 156;--ion-color-medium-contrast: #ffffff;--ion-color-medium-contrast-rgb: 255, 255, 255;--ion-color-medium-shade: #808289;--ion-color-medium-tint: #9d9fa6;--ion-color-light: #f4f5f8;--ion-color-light-rgb: 244, 245, 248;--ion-color-light-contrast: #000000;--ion-color-light-contrast-rgb: 0, 0, 0;--ion-color-light-shade: #d7d8da;--ion-color-light-tint: #f5f6f9;--accent-color-green: #9bd8ac;--primary-50: #F3F4FA;--primary-100: #EAEBF5;--primary-200: #D8D9ED;--primary-300: #C0C2E1;--primary-400: #A8A6D3;--primary-500: #958FC5;--primary-600: #8377B4;--primary-700: #695e93;--primary-800: #5C547F;--primary-900: #4D4867;--primary-950: #2D2A3C;--neutral-50: #FFFFFF;--neutral-100: #F4F4F4;--neutral-200: #DCDCDC;--neutral-300: #BDBDBD;--neutral-400: #989898;--neutral-500: #7C7C7C;--neutral-600: #656565;--neutral-700: #525252;--neutral-800: #464646;--neutral-900: #292929;--neutral-950: #000000;--error-100: #F9DEDC;--error-200: #B3261E;--error-300: #410E0B;--font-display: "Gayathri", sans-serif;--font-body: "Inter", sans-serif}[_ngcontent-%COMP%]:root   .ion-color-morado-custom[_ngcontent-%COMP%]{--ion-color-base: var(--primary-700);--ion-color-base-rgb: var(--primary-700);--ion-color-contrast: var(--neutral-50);--ion-color-contrast-rgb: var(--neutral-50);--ion-color-shade: var(--primary-950);--ion-color-tint: var(--primary-300)}ion-content[_ngcontent-%COMP%]{--background: var(--neutral-100)}ion-header[_ngcontent-%COMP%]{border-radius:10px;background:var(--neutral-100)}button.alert-button.alert-button-custom[_ngcontent-%COMP%]{color:var(--primary-600)}ion-alert.custom-alert[_ngcontent-%COMP%]   button.alert-button[_ngcontent-%COMP%]{color:var(--primary-600)}ion-alert.custom-select-alert[_ngcontent-%COMP%]   .alert-button-group[_ngcontent-%COMP%]   button.alert-button[_ngcontent-%COMP%]{color:var(--primary-600)}ion-alert.custom-select-alert[_ngcontent-%COMP%]   .alert-radio-group[_ngcontent-%COMP%]   button.alert-radio-button[_ngcontent-%COMP%]   .alert-radio-icon[_ngcontent-%COMP%]{border-color:var(--primary-500)}ion-alert.custom-select-alert[_ngcontent-%COMP%]   .alert-radio-group[_ngcontent-%COMP%]   button.alert-radio-button[_ngcontent-%COMP%]   .alert-radio-icon[_ngcontent-%COMP%]   .alert-radio-inner[_ngcontent-%COMP%]{background-color:var(--primary-700)}@media (prefers-color-scheme: dark){body[_ngcontent-%COMP%]{--ion-color-primary: #428cff;--ion-color-primary-rgb: 66,140,255;--ion-color-primary-contrast: #ffffff;--ion-color-primary-contrast-rgb: 255,255,255;--ion-color-primary-shade: #3a7be0;--ion-color-primary-tint: #5598ff;--ion-color-secondary: #50c8ff;--ion-color-secondary-rgb: 80,200,255;--ion-color-secondary-contrast: #ffffff;--ion-color-secondary-contrast-rgb: 255,255,255;--ion-color-secondary-shade: #46b0e0;--ion-color-secondary-tint: #62ceff;--ion-color-tertiary: #6a64ff;--ion-color-tertiary-rgb: 106,100,255;--ion-color-tertiary-contrast: #ffffff;--ion-color-tertiary-contrast-rgb: 255,255,255;--ion-color-tertiary-shade: #5d58e0;--ion-color-tertiary-tint: #7974ff;--ion-color-success: #2fdf75;--ion-color-success-rgb: 47,223,117;--ion-color-success-contrast: #000000;--ion-color-success-contrast-rgb: 0,0,0;--ion-color-success-shade: #29c467;--ion-color-success-tint: #44e283;--ion-color-warning: #ffd534;--ion-color-warning-rgb: 255,213,52;--ion-color-warning-contrast: #000000;--ion-color-warning-contrast-rgb: 0,0,0;--ion-color-warning-shade: #e0bb2e;--ion-color-warning-tint: #ffd948;--ion-color-danger: #ff4961;--ion-color-danger-rgb: 255,73,97;--ion-color-danger-contrast: #ffffff;--ion-color-danger-contrast-rgb: 255,255,255;--ion-color-danger-shade: #e04055;--ion-color-danger-tint: #ff5b71;--ion-color-dark: #f4f5f8;--ion-color-dark-rgb: 244,245,248;--ion-color-dark-contrast: #000000;--ion-color-dark-contrast-rgb: 0,0,0;--ion-color-dark-shade: #d7d8da;--ion-color-dark-tint: #f5f6f9;--ion-color-medium: #989aa2;--ion-color-medium-rgb: 152,154,162;--ion-color-medium-contrast: #000000;--ion-color-medium-contrast-rgb: 0,0,0;--ion-color-medium-shade: #86888f;--ion-color-medium-tint: #a2a4ab;--ion-color-light: #222428;--ion-color-light-rgb: 34,36,40;--ion-color-light-contrast: #ffffff;--ion-color-light-contrast-rgb: 255,255,255;--ion-color-light-shade: #1e2023;--ion-color-light-tint: #383a3e}}.message[_ngcontent-%COMP%]{margin-bottom:10px;overflow:hidden}.user[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background-color:var(--primary-700);color:var(--neutral-50);font-family:var(--font-body);border-radius:10px 10px 0;margin-right:3vw;float:right}.user[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .archivo[_ngcontent-%COMP%]{color:var(--neutral-50)}.other[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]{background-color:var(--neutral-50);color:var(--neutral-900);margin-left:3vw;border-radius:10px 10px 10px 0;font-family:var(--font-body);float:left}.other[_ngcontent-%COMP%]   .message-bubble[_ngcontent-%COMP%]   .archivo[_ngcontent-%COMP%]{color:var(--neutral-900)}.message-bubble[_ngcontent-%COMP%]{padding:10px;max-width:70%}.message-bubble[_ngcontent-%COMP%]   .nombre[_ngcontent-%COMP%]{font-weight:700;padding:0%}.listado[_ngcontent-%COMP%]{height:100%;overflow-y:auto;align-self:flex-end;background-color:var(--primary-50)}.final[_ngcontent-%COMP%]{position:relative;bottom:0;padding-bottom:2vh;padding-top:2vh}.chat-header[_ngcontent-%COMP%]{--background: var(--neutral-50);height:8vh}.chat-container[_ngcontent-%COMP%]{overflow:scroll}.chat-footer[_ngcontent-%COMP%]   .optional-toolbar[_ngcontent-%COMP%]   audio[_ngcontent-%COMP%]::-webkit-media-controls-panel{background-color:var(--neutral-50)}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]{height:8vh}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .grabando-audio-container[_ngcontent-%COMP%]{display:flex;align-items:center}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .grabando-audio-container[_ngcontent-%COMP%]   .contador-tiempo[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:99;background-color:var(--neutral-50);padding-right:2vw}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .grabando-audio-container[_ngcontent-%COMP%]   .contador-tiempo[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{color:red;opacity:.5}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .texto-mensaje[_ngcontent-%COMP%]{border:0px;border-radius:5px;background-color:var(--primary-50)}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .texto-mensaje[_ngcontent-%COMP%]:focus{outline:none!important;border:1px solid;border-color:var(--primary-700)}.enviar-foto-modal[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: var(--neutral-950)}.enviar-foto-modal[_ngcontent-%COMP%]   .contenedor-imagen[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center}.enviar-foto-modal[_ngcontent-%COMP%]   .texto-mensaje[_ngcontent-%COMP%]{margin-left:10vw;width:70vw;border:0px;border-radius:5px;background-color:var(--primary-50)}.enviar-foto-modal[_ngcontent-%COMP%]   .texto-mensaje[_ngcontent-%COMP%]:focus{outline:none!important;border:1px solid;border-color:var(--primary-700)}']}),c})()},{path:"**",redirectTo:"",pathMatch:"full"}]}]}}]);