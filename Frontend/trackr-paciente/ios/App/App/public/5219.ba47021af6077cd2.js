"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5219],{6715:(z,N,m)=>{m.d(N,{k$:()=>u,y$:()=>y});var y=(()=>{return(P=y||(y={})).Heavy="HEAVY",P.Medium="MEDIUM",P.Light="LIGHT",y;var P})(),u=(()=>{return(P=u||(u={})).Success="SUCCESS",P.Warning="WARNING",P.Error="ERROR",u;var P})()},5219:(z,N,m)=>{m.r(N),m.d(N,{default:()=>ye});var y=m(5861),u=m(12),_=m(6895),t=m(1571),P=m(9160),F=m(4273),A=m(529);let H=(()=>{var r;class n{constructor(e){this.http=e,this.dataUrl="archivo/"}obtenerUsuarioImagen(e){return this.http.get(this.dataUrl+`usuario/${e}`,{responseType:"blob"})}obtenerUsuarioEnSesionImagen(){return this.http.get(this.dataUrl+"usuarioEnSesionImagen",{responseType:"blob"})}}return(r=n).\u0275fac=function(e){return new(e||r)(t.LFG(A.eN))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),n})();var q=m(1481),Y=m(2644);let ct=(()=>{var r;class n{constructor(e,o,s,a,c){this.ChatHubServiceService=e,this.chatMensajeHubService=o,this.archivoService=s,this.sanitizer=a,this.chatPersonaService=c,this.chats=[],this.mensajes=[],this.clickEnChat=!1}ngOnInit(){var e=this;return(0,y.Z)(function*(){e.obtenerChats(),e.obtenerMensajes(),e.idUsuario=yield e.chatPersonaService.obtenerIdUsuarioAsync()})()}obtenerChats(){this.chats$=this.ChatHubServiceService.chat$,this.chats$.subscribe(e=>{this.chats=e,this.obtenerUltimoMensaje()})}obtenerMensajes(){this.chatMensajes$=this.chatMensajeHubService.chatMensaje$,this.chatMensajes$.subscribe(e=>{this.mensajes=e,this.obtenerUltimoMensaje()})}enviarMensaje(e){this.chatMensajeHubService.enviarMensaje({fecha:new Date,idChat:e,mensaje:this.contenido,idPersona:this.idUsuario,idArchivo:0})}obtenerChatSeleccionado(e){this.idChatSeleccionado=e,this.mensajesChatSeleccionado=this.mensajes.find(o=>o.some(s=>s.idChat===this.idChatSeleccionado))||[],this.clickEnChat=!0}obtenerUltimoMensaje(){let e=this.mensajes.map(s=>{var a,c;return{mensajes:(null===(a=s[s.length-1])||void 0===a?void 0:a.mensaje)||"",chat:(null===(c=s[0])||void 0===c?void 0:c.idChat)||0}}),o=this.mensajes.map(s=>{var a,c;return{fecha:(null===(a=s[s.length-1])||void 0===a?void 0:a.fecha)||new Date,chat:(null===(c=s[0])||void 0===c?void 0:c.idChat)||0}});this.chats.forEach(s=>{var a,c;s.ultimoMensaje=(null===(a=e.filter(h=>h.chat==s.idChat)[0])||void 0===a?void 0:a.mensajes)||"",s.fechaUltimoMensaje=(null===(c=o.filter(h=>h.chat==s.idChat)[0])||void 0===c?void 0:c.fecha)||new Date})}}return(r=n).\u0275fac=function(e){return new(e||r)(t.Y36(P.L),t.Y36(F.U),t.Y36(H),t.Y36(q.H7),t.Y36(Y.R))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-chat-movil"]],standalone:!0,features:[t.jDz],decls:1,vars:0,template:function(e,o){1&e&&t._UZ(0,"ion-router-outlet")},dependencies:[u.Pc,u.jP,_.ez]}),n})();var lt=m(8622),Z=m(433),G=m(2583),B=m(1297),Q=m(2384),ht=m(1814);function dt(r,n){if(1&r&&t._UZ(0,"ion-img",19),2&r){const i=t.oxw().$implicit;t.Q6J("src",i.urlImagen)}}function ut(r,n){1&r&&t._UZ(0,"ion-img",20)}function pt(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"ion-item",15)(1,"ion-avatar",16),t.YNc(2,dt,1,1,"ion-img",17),t.YNc(3,ut,1,0,"ion-img",18),t.qZA(),t.TgZ(4,"ion-label",3),t.NdJ("click",function(){const s=t.CHM(i).$implicit,a=t.oxw(2);return t.KtG(a.mostrarAlertCrearChat(s.idUsuarioDoctor))}),t._uU(5),t.qZA()()}if(2&r){const i=n.$implicit;t.xp6(2),t.Q6J("ngIf",i.urlImagen),t.xp6(1),t.Q6J("ngIf",!i.urlImagen),t.xp6(2),t.AsE("",i.titulo," ",i.nombre,"")}}function mt(r,n){if(1&r&&(t.TgZ(0,"ion-list",13),t.YNc(1,pt,6,4,"ion-item",14),t.qZA()),2&r){const i=t.oxw();t.xp6(1),t.Q6J("ngForOf",i.doctoresFiltrados)}}function gt(r,n){if(1&r&&t._UZ(0,"ion-img",19),2&r){const i=t.oxw().$implicit;t.Q6J("src",i.urlImagen)}}function ft(r,n){1&r&&t._UZ(0,"ion-img",20)}function vt(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"ion-item",15)(1,"ion-avatar",16),t.YNc(2,gt,1,1,"ion-img",17),t.YNc(3,ft,1,0,"ion-img",18),t.qZA(),t.TgZ(4,"ion-label",3),t.NdJ("click",function(){const s=t.CHM(i).$implicit,a=t.oxw(3);return t.KtG(a.mostrarAlertCrearChat(s.idUsuarioDoctor))}),t._uU(5),t.qZA()()}if(2&r){const i=n.$implicit;t.xp6(2),t.Q6J("ngIf",i.urlImagen),t.xp6(1),t.Q6J("ngIf",!i.urlImagen),t.xp6(2),t.AsE("",i.titulo," ",i.nombre,"")}}function _t(r,n){if(1&r&&(t.TgZ(0,"ion-list",22)(1,"ion-item-divider",23),t._uU(2),t.qZA(),t.YNc(3,vt,6,4,"ion-item",14),t.qZA()),2&r){const i=t.oxw().$implicit;t.xp6(2),t.hij(" ",i.letra," "),t.xp6(1),t.Q6J("ngForOf",i.doctores)}}function Ct(r,n){if(1&r&&(t.ynx(0),t.YNc(1,_t,4,2,"ion-list",21),t.BQk()),2&r){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",!i.filtrando)}}let bt=(()=>{var r;class n{constructor(e,o,s,a){this.modalCtrl=e,this.ChatPersonaService=o,this.ChatHubServiceService=s,this.alertController=a,this.gruposDoctores=[],this.usuarios=[],this.doctorSeleccionado=!1,this.idDoctorSelecionado=0,this.filtrando=!1,(0,G.a)({"chevron-left":"assets/img/svg/chevron-left.svg","chevron-right":"assets/img/svg/chevron-right.svg"})}ngOnInit(){this.doctores.sort((e,o)=>e.nombre>o.nombre?1:-1),this.organizarDoctores(this.doctores),this.obtenerIdUsuario()}regresarBtn(){this.modalCtrl.dismiss()}organizarDoctores(e){const o={};e.forEach(s=>{const a=s.nombre.charAt(0).toUpperCase();o[a]||(o[a]=[]),o[a].push(s)}),this.gruposDoctores=Object.keys(o).map(s=>({letra:s,doctores:o[s]}))}crearChat(){this.ChatHubServiceService.agregarChat({fecha:new Date,habilitado:!0,idCreadorChat:this.usuarios[this.usuarios.length-1],titulo:this.tituloChat,idChat:0},this.usuarios),this.tituloChat="",this.usuarios=[],this.doctorSeleccionado=!1}obtenerIdUsuario(){this.ChatPersonaService.obtenerIdUsuario().subscribe(e=>{this.idUsuario=e})}handleSearch(e){""!=e?(this.filtrando=!0,this.doctoresFiltrados=this.doctores.filter(o=>{var s;return null===(s=o.nombre)||void 0===s?void 0:s.toLowerCase().includes(e.toLowerCase())})):this.filtrando=!1}mostrarAlertCrearChat(e){var o=this;return(0,y.Z)(function*(){const s=yield o.alertController.create({header:"Crear chat",subHeader:"\xbfDesea crear un chat con este doctor?",cssClass:"custom-alert color-primary icon-info two-buttons",backdropDismiss:!1,buttons:[{text:"Cancelar",role:"cancel"},{text:"Crear",role:"confirm",handler:()=>{o.doctorSeleccionado=!o.doctorSeleccionado,o.idDoctorSelecionado=e,o.usuarios=[],o.usuarios.push(o.idUsuario),o.usuarios.push(e),o.crearChat()}}]});yield s.present(),"confirm"==(yield s.onDidDismiss()).role&&o.regresarBtn()})()}}return(r=n).\u0275fac=function(e){return new(e||r)(t.Y36(u.IN),t.Y36(Y.R),t.Y36(P.L),t.Y36(ht.Br))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-nuevo-chat-doctores"]],standalone:!0,features:[t._Bn([]),t.jDz],decls:19,vars:2,consts:[[1,"ion-no-border"],[1,"contenedor-header-light"],["slot","start",1,"start"],[3,"click"],["name","chevron-left"],[1,"primary"],[1,"contenedor-principal"],[1,"titulo"],[1,"contenedor-barra-busqueda"],[3,"search"],[1,"lista-doctores"],["style","margin-top: 16px;","lines","none",4,"ngIf"],[4,"ngFor","ngForOf"],["lines","none",2,"margin-top","16px"],["class","doctor","detail","","button","","detailIcon","chevron-right",4,"ngFor","ngForOf"],["detail","","button","","detailIcon","chevron-right",1,"doctor"],["slot","start"],["alt","profile pic",3,"src",4,"ngIf"],["alt","profile pic","src","assets/img/svg/Image_placeholder.svg",4,"ngIf"],["alt","profile pic",3,"src"],["alt","profile pic","src","assets/img/svg/Image_placeholder.svg"],["lines","none",4,"ngIf"],["lines","none"],[1,"divider"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header",0)(1,"div",1)(2,"ion-toolbar")(3,"ion-buttons",2)(4,"ion-button",3),t.NdJ("click",function(){return o.regresarBtn()}),t._UZ(5,"ion-icon",4),t.TgZ(6,"ion-label"),t._uU(7,"Atr\xe1s"),t.qZA()()()()()(),t.TgZ(8,"ion-content",5)(9,"div",6)(10,"div",7)(11,"ion-text")(12,"h3"),t._uU(13,"Nuevo chat"),t.qZA()()(),t.TgZ(14,"div",8)(15,"app-searchbar",9),t.NdJ("search",function(a){return o.handleSearch(a)}),t.qZA()(),t.TgZ(16,"div",10),t.YNc(17,mt,2,1,"ion-list",11),t.YNc(18,Ct,2,1,"ng-container",12),t.qZA()()()),2&e&&(t.xp6(17),t.Q6J("ngIf",o.filtrando),t.xp6(1),t.Q6J("ngForOf",o.gruposDoctores))},dependencies:[_.ez,_.sg,_.O5,u.Pc,u.BJ,u.YG,u.Sm,u.W2,u.Gu,u.gu,u.Xz,u.Ie,u.rH,u.Q$,u.q_,u.yW,u.sr,Z.u5,Q.U],styles:[".contenedor-principal[_ngcontent-%COMP%]{height:100%}.contenedor-principal[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]{height:8vh;padding:16px 32px 0}.contenedor-principal[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{text-align:start}.contenedor-principal[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--primary-700);font-family:var(--font-display);font-size:24px;font-weight:700;line-height:32px}.contenedor-barra-busqueda[_ngcontent-%COMP%]{padding:0 32px 16px}.lista-doctores[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{padding:0;background:var(--primary-50)}.lista-doctores[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{height:64px;--padding-start: 32px;font-family:var(font-body);font-size:16px;font-weight:700;--color: var(--neutral-900);--background: var(--primary-50);border:none}.lista-doctores[_ngcontent-%COMP%]   .doctor[_ngcontent-%COMP%]{--padding-start: 32px;--inner-padding-end: 32px;--min-height: 64px;--detail-icon-color: var(--neutral-400);--detail-icon-font-size: 24px;--detail-icon-opacity: 1;border-bottom:1px solid var(--neutral-200)}.lista-doctores[_ngcontent-%COMP%]   .doctor[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{height:40px;width:40px}.lista-doctores[_ngcontent-%COMP%]   .doctor[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-family:var(--font-body);font-size:16px;color:var(--neutral-900)}"]}),n})();var J=m(4384),Mt=m(9134);function yt(r,n){1&r&&(t.TgZ(0,"div",12)(1,"ion-text")(2,"p"),t._uU(3,"A\xfan no hay chats"),t.qZA(),t.TgZ(4,"p"),t._uU(5,"Empieza una nueva conversaci\xf3n"),t.qZA()()())}function xt(r,n){if(1&r&&t._UZ(0,"ion-img",20),2&r){const i=t.oxw().$implicit;t.Q6J("src",i.urlImagen)}}function Pt(r,n){1&r&&t._UZ(0,"ion-img",21)}function wt(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"ion-item",14),t.NdJ("click",function(){const s=t.CHM(i).$implicit,a=t.oxw(2);return t.KtG(a.enviarIdChat(s.idChat||0))}),t.TgZ(1,"ion-avatar",15),t.YNc(2,xt,1,1,"ion-img",16),t.YNc(3,Pt,1,0,"ion-img",17),t.qZA(),t.TgZ(4,"ion-label")(5,"h3"),t._uU(6),t.qZA(),t.TgZ(7,"p"),t._uU(8),t.qZA()(),t.TgZ(9,"div",18)(10,"p",19),t._uU(11),t.ALo(12,"date"),t.qZA()()()}if(2&r){const i=n.$implicit;t.xp6(2),t.Q6J("ngIf",i.urlImagen),t.xp6(1),t.Q6J("ngIf",!i.urlImagen),t.xp6(3),t.hij(" ",i.titulo," "),t.xp6(2),t.hij(" ",i.ultimoMensaje," "),t.xp6(3),t.Oqu(t.xi3(12,5,i.fechaUltimoMensaje,"dd/MM"))}}function Ot(r,n){if(1&r&&(t.TgZ(0,"ion-list"),t.YNc(1,wt,13,8,"ion-item",13),t.ALo(2,"async"),t.qZA()),2&r){const i=t.oxw();t.xp6(1),t.Q6J("ngForOf",i.filtrando?i.chatsFiltradosPorBusqueda:t.lcZ(2,1,i.chats$))}}let Tt=(()=>{var r;class n{constructor(e,o,s,a,c,h,l){this.router=e,this.ChatHubServiceService=o,this.archivoService=s,this.sanitizer=a,this.doctoresService=c,this.ChatPersonaService=h,this.modalCtrl=l,this.usuarios=[],this.doctorSeleccionado=!1,this.verListaDoctores=!1,this.filtrando=!1,(0,G.a)({addCircle:B.ZWo,chatboxOutline:B.DMF,send:B.lWK,"chat-plus":" ../assets/img/svg/chat-plus.svg"})}ionViewWillEnter(){this.obtenerChats(),this.consultarDoctores(),this.obtenerIdUsuario()}obtenerIdUsuario(){this.ChatPersonaService.obtenerIdUsuario().subscribe(e=>{this.idUsuario=e})}obtenerChats(){this.chats$=this.ChatHubServiceService.chat$,this.chats$.subscribe(e=>{e.forEach(o=>{if(null!=o.imagenBase64){let s="data:"+o.tipoMime+";base64,"+o.imagenBase64;this.sanitizer.bypassSecurityTrustUrl(s),o.urlImagen=s}}),this.chats=e,this.chatsFiltradosPorBusqueda=e})}enviarIdChat(e){this.router.navigate(["home/chat-movil/chat",e])}consultarDoctores(){this.doctoresService.consultarExpedienteConImagenes().subscribe(e=>{e.forEach(o=>{null!=o.imagenBase64&&(o.urlImagen="data:"+o.tipoMime+";base64,"+o.imagenBase64)}),this.misDoctores=e})}doctorClick(e){this.doctorSeleccionado=!this.doctorSeleccionado,this.usuarios=[],this.usuarios.push(this.idUsuario),this.usuarios.push(e)}crearChat(){this.ChatHubServiceService.agregarChat({fecha:new Date,fechaUltimoMensaje:new Date,habilitado:!0,idCreadorChat:this.usuarios[this.usuarios.length-1],titulo:this.tituloChat},this.usuarios),this.tituloChat="",this.usuarios=[],this.doctorSeleccionado=!1}mostrarListaDoctores(){var e=this;return(0,y.Z)(function*(){(yield e.modalCtrl.create({component:bt,componentProps:{doctores:e.misDoctores}})).present()})()}buscarChat(e){const o=e.target.value;this.chatsFiltradosPorBusqueda=this.chats,o&&""!=o.trim()&&(this.chatsFiltradosPorBusqueda=this.chatsFiltradosPorBusqueda.filter(s=>s.titulo.toLowerCase().indexOf(o.toLowerCase())>-1||s.ultimoMensaje.toLowerCase().indexOf(o.toLowerCase())>-1))}listaVacia(){var e;return 0==(null===(e=this.chats)||void 0===e?void 0:e.length)}handleSearch(e){""!=e?(this.filtrando=!0,this.chatsFiltradosPorBusqueda=this.chats.filter(o=>{var s,a;return(null===(s=o.ultimoMensaje)||void 0===s?void 0:s.toLowerCase().includes(e.toLowerCase()))||(null===(a=o.titulo)||void 0===a?void 0:a.toLowerCase().includes(e.toLowerCase()))})):this.filtrando=!1}}return(r=n).\u0275fac=function(e){return new(e||r)(t.Y36(J.F0),t.Y36(P.L),t.Y36(H),t.Y36(q.H7),t.Y36(Mt.q),t.Y36(Y.R),t.Y36(u.IN))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-barra-chats"]],standalone:!0,features:[t._Bn([]),t.jDz],decls:15,vars:2,consts:[[1,"ion-no-border"],[1,"contenedor-header-dark"],["slot","end",1,"end"],[1,"icon-only",3,"click"],["name","chat-plus"],[1,"primary"],[1,"contenedor-principal"],[1,"contenedor-barra-busqueda"],[3,"search"],[1,"lista-chats"],["class","lista-vacia",4,"ngIf"],[4,"ngIf"],[1,"lista-vacia"],["class","chat","lines","none","button","",3,"click",4,"ngFor","ngForOf"],["lines","none","button","",1,"chat",3,"click"],["slot","start"],[3,"src",4,"ngIf"],["src","assets/img/svg/Image_placeholder.svg",4,"ngIf"],["slot","end",1,"meta-data-end"],["id","fecha"],[3,"src"],["src","assets/img/svg/Image_placeholder.svg"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header",0)(1,"div",1)(2,"ion-toolbar")(3,"ion-title"),t._uU(4,"Chats"),t.qZA(),t.TgZ(5,"ion-buttons",2)(6,"ion-button",3),t.NdJ("click",function(){return o.mostrarListaDoctores()}),t._UZ(7,"ion-icon",4),t.qZA()()()()(),t.TgZ(8,"ion-content",5)(9,"div",6)(10,"div",7)(11,"app-searchbar",8),t.NdJ("search",function(a){return o.handleSearch(a)}),t.qZA()(),t.TgZ(12,"div",9),t.YNc(13,yt,6,0,"div",10),t.YNc(14,Ot,3,3,"ion-list",11),t.qZA()()()),2&e&&(t.xp6(13),t.Q6J("ngIf",o.listaVacia()),t.xp6(1),t.Q6J("ngIf",!o.listaVacia()))},dependencies:[lt.U$,_.ez,_.sg,_.O5,_.Ov,_.uU,u.Pc,u.BJ,u.YG,u.Sm,u.W2,u.Gu,u.gu,u.Xz,u.Ie,u.Q$,u.q_,u.yW,u.wd,u.sr,Z.u5,Q.U],styles:[".contenedor-principal[_ngcontent-%COMP%]{background:var(--primary-50);height:100%}.contenedor-barra-busqueda[_ngcontent-%COMP%]{padding:32px}.lista-chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{padding:0}.lista-chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item.chat[_ngcontent-%COMP%]{--background: var(--primary-50);--inner-padding-end: 32px}.lista-chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item.chat[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{--border-radius: 16px;width:48px;height:48px}.lista-chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item.chat[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-family:var(--font-body)}.lista-chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item.chat[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{width:100%;font-size:16px;font-weight:700;color:var(--neutral-900);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block}.lista-chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item.chat[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:100%;font-size:14px;color:var(--neutral-500);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block}.lista-chats[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item.chat[_ngcontent-%COMP%]::part(native){padding-left:32px}.meta-data-end[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;height:100%;padding-top:10px;padding-bottom:10px}.meta-data-end[_ngcontent-%COMP%]   #fecha[_ngcontent-%COMP%]{margin:0;font-family:var(--font-body);font-size:10px;color:var(--neutral-500)}.meta-data-end[_ngcontent-%COMP%]   #badge[_ngcontent-%COMP%]{width:24px;height:20px;border-radius:40px;--background: var(--primary-200);--color: var(--primary-700)}"]}),n})();var X=m(7423);const R=(0,X.fo)("VoiceRecorder",{web:()=>m.e(797).then(m.bind(m,797)).then(r=>new r.VoiceRecorderWeb)});var W=m(1067),jt=m(2670),At=m(7579),St=m(9751),Zt=m(4986),Dt=m(3532),Et=m(1165),kt=m(2722),Nt=m(2529),Ut=m(8746),Rt=m(4004),K=m(6715);const V=(0,X.fo)("Haptics",{web:()=>m.e(5001).then(m.bind(m,5001)).then(r=>new r.HapticsWeb)});let Lt=(()=>{var r;class n{constructor(){this.press=new t.vpe,this.pressGesture={name:"press",enabled:!1,interval:251},this.pressTimeout=null,this.isPressing=!1,this.lastTap=0,this.tapCount=0,this.tapTimeout=null}ngOnInit(){this.pressGesture.enabled=!0}onPress(e){this.pressGesture.enabled&&this.handlePressing(e.type)}handlePressing(e){"touchstart"==e?this.pressTimeout=setTimeout(()=>{this.isPressing=!0,this.press.emit("start")},this.pressGesture.interval):"touchend"==e&&(clearTimeout(this.pressTimeout),this.isPressing&&(this.press.emit("end"),this.resetTaps()),setTimeout(()=>this.isPressing=!1,50))}resetTaps(){clearTimeout(this.tapTimeout),this.tapCount=0,this.tapTimeout=null,this.lastTap=0}}return(r=n).\u0275fac=function(e){return new(e||r)},r.\u0275dir=t.lG2({type:r,selectors:[["","appPress",""]],hostBindings:function(e,o){1&e&&t.NdJ("touchstart",function(a){return o.onPress(a)})("touchend",function(a){return o.onPress(a)})},outputs:{press:"press"},standalone:!0}),n})(),$t=(()=>{var r;class n{constructor(e,o){this.gestureCtrl=e,this.el=o,this.swipe=new t.vpe,this.swipeGesture={name:"swipe",enabled:!1,interval:250,threshold:15,reportInterval:void 0,direction:["",""]},this.GESTURE_CREATED=!1,this.moveTimeout=null,this.isMoving=!1,this.lastSwipeReport=null}ngOnInit(){this.swipeGesture.enabled=!0,this.swipeGesture.direction=["left","right"],this.createGesture()}createGesture(){this.GESTURE_CREATED||(this.gestureCtrl.create({gestureName:"swipe-gesture",el:this.el.nativeElement,onStart:()=>{this.swipeGesture.enabled&&(this.isMoving=!0,this.moveTimeout=setInterval(()=>{this.isMoving=!1},249))},onMove:o=>{this.swipeGesture.enabled&&this.handleMoving("moving",o)},onEnd:o=>{this.swipeGesture.enabled&&this.handleMoving("moveend",o)}},!0).enable(),this.GESTURE_CREATED=!0)}handleMoving(e,o){null!==this.moveTimeout&&(clearTimeout(this.moveTimeout),this.moveTimeout=null);const s=o.deltaX,a=o.deltaY,c=Math.abs(s),h=Math.abs(a),l=this.swipeGesture.reportInterval||"live",d=this.swipeGesture.threshold;if(c<d&&h<d)return;const g=this.isMoving&&(null===this.lastSwipeReport||"live"===l||"end"===l&&"moveend"==e);if(this.lastSwipeReport=o.timeStamp,g){let p={dirX:void 0,dirY:void 0,swipeType:e,...o};c>d&&(s>0?p.dirX="right":s<0&&(p.dirX="left")),h>d&&(a>0?p.dirY="down":a<0&&(p.dirY="up"));const f=this.swipeGesture.direction;(f.includes(p.dirX)||f.includes(p.dirY))&&this.swipe.emit(p)}"moveend"==e&&null!==this.lastSwipeReport&&(this.isMoving=!1,this.lastSwipeReport=null)}}return(r=n).\u0275fac=function(e){return new(e||r)(t.Y36(u.TH),t.Y36(t.SBq))},r.\u0275dir=t.lG2({type:r,selectors:[["","appSwipe",""]],outputs:{swipe:"swipe"},standalone:!0}),n})();var tt=m(7126),Ft=m(3051);function x(r,n,i,e){return new(i||(i=Promise))(function(o,s){function a(l){try{h(e.next(l))}catch(d){s(d)}}function c(l){try{h(e.throw(l))}catch(d){s(d)}}function h(l){var d;l.done?o(l.value):(d=l.value,d instanceof i?d:new i(function(g){g(d)})).then(a,c)}h((e=e.apply(r,n||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class L{constructor(){this.listeners={}}on(n,i,e){if(this.listeners[n]||(this.listeners[n]=new Set),this.listeners[n].add(i),null==e?void 0:e.once){const o=()=>{this.un(n,o),this.un(n,i)};return this.on(n,o),o}return()=>this.un(n,i)}un(n,i){var e;null===(e=this.listeners[n])||void 0===e||e.delete(i)}once(n,i){return this.on(n,i,{once:!0})}unAll(){this.listeners={}}emit(n,...i){this.listeners[n]&&this.listeners[n].forEach(e=>e(...i))}}const et={decode:function(r,n){return x(this,void 0,void 0,function*(){const i=new AudioContext({sampleRate:n});return i.decodeAudioData(r).finally(()=>i.close())})},createBuffer:function(r,n){return"number"==typeof r[0]&&(r=[r]),function(i){const e=i[0];if(e.some(o=>o>1||o<-1)){const o=e.length;let s=0;for(let a=0;a<o;a++){const c=Math.abs(e[a]);c>s&&(s=c)}for(const a of i)for(let c=0;c<o;c++)a[c]/=s}}(r),{duration:n,length:r[0].length,sampleRate:r[0].length/n,numberOfChannels:r.length,getChannelData:i=>null==r?void 0:r[i],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function nt(r,n){const i=n.xmlns?document.createElementNS(n.xmlns,r):document.createElement(r);for(const[e,o]of Object.entries(n))if("children"===e)for(const[s,a]of Object.entries(n))i.appendChild("string"==typeof a?document.createTextNode(a):nt(s,a));else"style"===e?Object.assign(i.style,o):"textContent"===e?i.textContent=o:i.setAttribute(e,o.toString());return i}function it(r,n,i){const e=nt(r,n||{});return null==i||i.appendChild(e),e}var Ht=Object.freeze({__proto__:null,createElement:it,default:it});const Yt={fetchBlob:function(r,n,i){return x(this,void 0,void 0,function*(){const e=yield fetch(r,i);if(e.status>=400)throw new Error(`Failed to fetch ${r}: ${e.status} (${e.statusText})`);return function(o,s){x(this,void 0,void 0,function*(){if(!o.body||!o.headers)return;const a=o.body.getReader(),c=Number(o.headers.get("Content-Length"))||0;let h=0;const l=g=>x(this,void 0,void 0,function*(){h+=(null==g?void 0:g.length)||0;const p=Math.round(h/c*100);s(p)}),d=()=>x(this,void 0,void 0,function*(){let g;try{g=yield a.read()}catch{return}g.done||(l(g.value),yield d())});d()})}(e.clone(),n),e.blob()})}};class Jt extends L{constructor(n){super(),this.isExternalMedia=!1,n.media?(this.media=n.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),n.mediaControls&&(this.media.controls=!0),n.autoplay&&(this.media.autoplay=!0),null!=n.playbackRate&&this.onMediaEvent("canplay",()=>{null!=n.playbackRate&&(this.media.playbackRate=n.playbackRate)},{once:!0})}onMediaEvent(n,i,e){return this.media.addEventListener(n,i,e),()=>this.media.removeEventListener(n,i,e)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const n=this.getSrc();n.startsWith("blob:")&&URL.revokeObjectURL(n)}canPlayType(n){return""!==this.media.canPlayType(n)}setSrc(n,i){const e=this.getSrc();if(n&&e===n)return;this.revokeSrc();const o=i instanceof Blob&&(this.canPlayType(i.type)||!n)?URL.createObjectURL(i):n;try{this.media.src=o}catch{this.media.src=n}}destroy(){this.media.pause(),this.isExternalMedia||(this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(n){this.media=n}play(){return x(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(n){this.media.currentTime=n}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(n){this.media.volume=n}getMuted(){return this.media.muted}setMuted(n){this.media.muted=n}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(n,i){null!=i&&(this.media.preservesPitch=i),this.media.playbackRate=n}getMediaElement(){return this.media}setSinkId(n){return this.media.setSinkId(n)}}class U extends L{constructor(n,i){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.subscriptions=[],this.options=n;const e=this.parentFromOptionsContainer(n.container);this.parent=e;const[o,s]=this.initHtml();e.appendChild(o),this.container=o,this.scrollContainer=s.querySelector(".scroll"),this.wrapper=s.querySelector(".wrapper"),this.canvasWrapper=s.querySelector(".canvases"),this.progressWrapper=s.querySelector(".progress"),this.cursor=s.querySelector(".cursor"),i&&s.appendChild(i),this.initEvents()}parentFromOptionsContainer(n){let i;if("string"==typeof n?i=document.querySelector(n):n instanceof HTMLElement&&(i=n),!i)throw new Error("Container not found");return i}initEvents(){const n=i=>{const e=this.wrapper.getBoundingClientRect();return[(i.clientX-e.left)/e.width,(i.clientY-e.top)/e.height]};if(this.wrapper.addEventListener("click",i=>{const[e,o]=n(i);this.emit("click",e,o)}),this.wrapper.addEventListener("dblclick",i=>{const[e,o]=n(i);this.emit("dblclick",e,o)}),!0!==this.options.dragToSeek&&"object"!=typeof this.options.dragToSeek||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:i,scrollWidth:e,clientWidth:o}=this.scrollContainer;this.emit("scroll",i/e,(i+o)/e,i,i+o)}),"function"==typeof ResizeObserver){const i=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{i().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const n=this.parent.clientWidth;n===this.lastContainerWidth&&"auto"!==this.options.height||(this.lastContainerWidth=n,this.reRender())}initDrag(){this.subscriptions.push(function(n,i,e,o,s=3,a=0,c=100){if(!n)return()=>{};const h=matchMedia("(pointer: coarse)").matches;let l=()=>{};const d=g=>{if(g.button!==a)return;g.preventDefault(),g.stopPropagation();let p=g.clientX,f=g.clientY,v=!1;const T=Date.now(),M=b=>{if(b.preventDefault(),b.stopPropagation(),h&&Date.now()-T<c)return;const j=b.clientX,D=b.clientY,E=j-p,I=D-f;if(v||Math.abs(E)>s||Math.abs(I)>s){const k=n.getBoundingClientRect(),{left:rt,top:at}=k;v||(null==e||e(p-rt,f-at),v=!0),i(E,I,j-rt,D-at),p=j,f=D}},C=b=>{if(v){const j=b.clientX,D=b.clientY,E=n.getBoundingClientRect(),{left:I,top:k}=E;null==o||o(j-I,D-k)}l()},w=b=>{b.relatedTarget&&b.relatedTarget!==document.documentElement||C(b)},S=b=>{v&&(b.stopPropagation(),b.preventDefault())},O=b=>{v&&b.preventDefault()};document.addEventListener("pointermove",M),document.addEventListener("pointerup",C),document.addEventListener("pointerout",w),document.addEventListener("pointercancel",w),document.addEventListener("touchmove",O,{passive:!1}),document.addEventListener("click",S,{capture:!0}),l=()=>{document.removeEventListener("pointermove",M),document.removeEventListener("pointerup",C),document.removeEventListener("pointerout",w),document.removeEventListener("pointercancel",w),document.removeEventListener("touchmove",O),setTimeout(()=>{document.removeEventListener("click",S,{capture:!0})},10)}};return n.addEventListener("pointerdown",d),()=>{l(),n.removeEventListener("pointerdown",d)}}(this.wrapper,(n,i,e)=>{this.emit("drag",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))},n=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,n/this.wrapper.getBoundingClientRect().width)))},n=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,n/this.wrapper.getBoundingClientRect().width)))}))}getHeight(n,i){var e;const o=(null===(e=this.audioData)||void 0===e?void 0:e.numberOfChannels)||1;if(null==n)return 128;if(!isNaN(Number(n)))return Number(n);if("auto"===n){const s=this.parent.clientHeight||128;return null!=i&&i.every(a=>!a.overlay)?s/o:s}return 128}initHtml(){const n=document.createElement("div"),i=n.attachShadow({mode:"open"});return i.innerHTML=`\n      <style>\n        :host {\n          user-select: none;\n          min-width: 1px;\n        }\n        :host audio {\n          display: block;\n          width: 100%;\n        }\n        :host .scroll {\n          overflow-x: auto;\n          overflow-y: hidden;\n          width: 100%;\n          position: relative;\n        }\n        :host .noScrollbar {\n          scrollbar-color: transparent;\n          scrollbar-width: none;\n        }\n        :host .noScrollbar::-webkit-scrollbar {\n          display: none;\n          -webkit-appearance: none;\n        }\n        :host .wrapper {\n          position: relative;\n          overflow: visible;\n          z-index: 2;\n        }\n        :host .canvases {\n          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;\n        }\n        :host .canvases > div {\n          position: relative;\n        }\n        :host canvas {\n          display: block;\n          position: absolute;\n          top: 0;\n          image-rendering: pixelated;\n        }\n        :host .progress {\n          pointer-events: none;\n          position: absolute;\n          z-index: 2;\n          top: 0;\n          left: 0;\n          width: 0;\n          height: 100%;\n          overflow: hidden;\n        }\n        :host .progress > div {\n          position: relative;\n        }\n        :host .cursor {\n          pointer-events: none;\n          position: absolute;\n          z-index: 5;\n          top: 0;\n          left: 0;\n          height: 100%;\n          border-radius: 2px;\n        }\n      </style>\n\n      <div class="scroll" part="scroll">\n        <div class="wrapper" part="wrapper">\n          <div class="canvases" part="canvases"></div>\n          <div class="progress" part="progress"></div>\n          <div class="cursor" part="cursor"></div>\n        </div>\n      </div>\n    `,[n,i]}setOptions(n){if(this.options.container!==n.container){const i=this.parentFromOptionsContainer(n.container);i.appendChild(this.container),this.parent=i}!0!==n.dragToSeek&&"object"!=typeof this.options.dragToSeek||this.initDrag(),this.options=n,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(n){this.scrollContainer.scrollLeft=n}setScrollPercentage(n){const{scrollWidth:i}=this.scrollContainer;this.setScroll(i*n)}destroy(){var n,i;this.subscriptions.forEach(e=>e()),this.container.remove(),null===(n=this.resizeObserver)||void 0===n||n.disconnect(),null===(i=this.unsubscribeOnScroll)||void 0===i||i.call(this)}createDelay(n=10){let i,e;const o=()=>{i&&clearTimeout(i),e&&e()};return this.timeouts.push(o),()=>new Promise((s,a)=>{o(),e=a,i=setTimeout(()=>{i=void 0,e=void 0,s()},n)})}convertColorValues(n){if(!Array.isArray(n))return n||"";if(n.length<2)return n[0]||"";const i=document.createElement("canvas"),e=i.getContext("2d"),o=i.height*(window.devicePixelRatio||1),s=e.createLinearGradient(0,0,0,o),a=1/(n.length-1);return n.forEach((c,h)=>{s.addColorStop(h*a,c)}),s}renderBarWaveform(n,i,e,o){const s=n[0],a=n[1]||n[0],c=s.length,{width:h,height:l}=e.canvas,d=l/2,g=window.devicePixelRatio||1,p=i.barWidth?i.barWidth*g:1,f=i.barGap?i.barGap*g:i.barWidth?p/2:0,v=i.barRadius||0,T=h/(p+f)/c,M=v&&"roundRect"in e?"roundRect":"rect";e.beginPath();let C=0,w=0,S=0;for(let O=0;O<=c;O++){const b=Math.round(O*T);if(b>C){const E=Math.round(w*d*o),I=E+Math.round(S*d*o)||1;let k=d-E;"top"===i.barAlign?k=0:"bottom"===i.barAlign&&(k=l-I),e[M](C*(p+f),k,p,I,v),C=b,w=0,S=0}const j=Math.abs(s[O]||0),D=Math.abs(a[O]||0);j>w&&(w=j),D>S&&(S=D)}e.fill(),e.closePath()}renderLineWaveform(n,i,e,o){const s=a=>{const c=n[a]||n[0],h=c.length,{height:l}=e.canvas,d=l/2,g=e.canvas.width/h;e.moveTo(0,d);let p=0,f=0;for(let v=0;v<=h;v++){const T=Math.round(v*g);if(T>p){const C=d+(Math.round(f*d*o)||1)*(0===a?-1:1);e.lineTo(p,C),p=T,f=0}const M=Math.abs(c[v]||0);M>f&&(f=M)}e.lineTo(p,d)};e.beginPath(),s(0),s(1),e.fill(),e.closePath()}renderWaveform(n,i,e){if(e.fillStyle=this.convertColorValues(i.waveColor),i.renderFunction)return void i.renderFunction(n,e);let o=i.barHeight||1;if(i.normalize){const s=Array.from(n[0]).reduce((a,c)=>Math.max(a,Math.abs(c)),0);o=s?1/s:1}i.barWidth||i.barGap||i.barAlign?this.renderBarWaveform(n,i,e,o):this.renderLineWaveform(n,i,e,o)}renderSingleCanvas(n,i,e,o,s,a,c){const h=window.devicePixelRatio||1,l=document.createElement("canvas");l.width=Math.round(e*h),l.height=Math.round(o*h),l.style.width=`${e}px`,l.style.height=`${o}px`,l.style.left=`${Math.round(s)}px`,a.appendChild(l);const d=l.getContext("2d");if(this.renderWaveform(n,i,d),l.width>0&&l.height>0){const g=l.cloneNode(),p=g.getContext("2d");p.drawImage(l,0,0),p.globalCompositeOperation="source-in",p.fillStyle=this.convertColorValues(i.progressColor),p.fillRect(0,0,l.width,l.height),c.appendChild(g)}}renderMultiCanvas(n,i,e,o,s,a){const c=window.devicePixelRatio||1,{clientWidth:h}=this.scrollContainer;if(h*c>=e)return void this.renderSingleCanvas(n,i,e,o,0,s,a);const l=e/c;let d=Math.min(U.MAX_CANVAS_WIDTH,h,l),g={};if(i.barWidth||i.barGap){const M=i.barWidth||.5,C=M+(i.barGap||M/2);d%C!=0&&(d=Math.floor(d/C)*C)}const p=M=>{if(M<0||M>=f||g[M])return;g[M]=!0;const C=M*d,w=Math.min(l-C,d);if(w<=0)return;const S=n.map(O=>{const b=Math.floor(C/l*O.length),j=Math.floor((C+w)/l*O.length);return O.slice(b,j)});this.renderSingleCanvas(S,i,w,o,C,s,a)},f=Math.ceil(l/d),T=Math.floor(this.scrollContainer.scrollLeft/l*f);p(T-1),p(T),p(T+1),f>1&&(this.unsubscribeOnScroll=this.on("scroll",()=>{const{scrollLeft:M}=this.scrollContainer,C=Math.floor(M/l*f);Object.keys(g).length>U.MAX_NODES&&(s.innerHTML="",a.innerHTML="",g={}),p(C-1),p(C),p(C+1)}))}renderChannel(n,i,e,o){var{overlay:s}=i,a=function(d,g){var p={};for(var f in d)Object.prototype.hasOwnProperty.call(d,f)&&g.indexOf(f)<0&&(p[f]=d[f]);if(null!=d&&"function"==typeof Object.getOwnPropertySymbols){var v=0;for(f=Object.getOwnPropertySymbols(d);v<f.length;v++)g.indexOf(f[v])<0&&Object.prototype.propertyIsEnumerable.call(d,f[v])&&(p[f[v]]=d[f[v]])}return p}(i,["overlay"]);const c=document.createElement("div"),h=this.getHeight(a.height,a.splitChannels);c.style.height=`${h}px`,s&&o>0&&(c.style.marginTop=`-${h}px`),this.canvasWrapper.style.minHeight=`${h}px`,this.canvasWrapper.appendChild(c);const l=c.cloneNode();this.progressWrapper.appendChild(l),this.renderMultiCanvas(n,a,e,h,c,l)}render(n){return x(this,void 0,void 0,function*(){var i;this.timeouts.forEach(h=>h()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",null!=this.options.width&&(this.scrollContainer.style.width="number"==typeof this.options.width?`${this.options.width}px`:this.options.width);const e=window.devicePixelRatio||1,o=this.scrollContainer.clientWidth,s=Math.ceil(n.duration*(this.options.minPxPerSec||0));this.isScrollable=s>o;const a=this.options.fillParent&&!this.isScrollable,c=(a?o:s)*e;if(this.wrapper.style.width=a?"100%":`${s}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=n,this.emit("render"),this.options.splitChannels)for(let h=0;h<n.numberOfChannels;h++){const l=Object.assign(Object.assign({},this.options),null===(i=this.options.splitChannels)||void 0===i?void 0:i[h]);this.renderChannel([n.getChannelData(h)],l,c,h)}else{const h=[n.getChannelData(0)];n.numberOfChannels>1&&h.push(n.getChannelData(1)),this.renderChannel(h,this.options,c,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){var n;if(null===(n=this.unsubscribeOnScroll)||void 0===n||n.call(this),delete this.unsubscribeOnScroll,!this.audioData)return;const{scrollWidth:i}=this.scrollContainer,{right:e}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&i!==this.scrollContainer.scrollWidth){const{right:o}=this.progressWrapper.getBoundingClientRect();let s=o-e;s*=2,s=s<0?Math.floor(s):Math.ceil(s),s/=2,this.scrollContainer.scrollLeft+=s}}zoom(n){this.options.minPxPerSec=n,this.reRender()}scrollIntoView(n,i=!1){const{scrollLeft:e,scrollWidth:o,clientWidth:s}=this.scrollContainer,a=n*o,c=e,h=e+s,l=s/2;if(this.isDragging)a+30>h?this.scrollContainer.scrollLeft+=30:a-30<c&&(this.scrollContainer.scrollLeft-=30);else{(a<c||a>h)&&(this.scrollContainer.scrollLeft=a-(this.options.autoCenter?l:0));const d=a-e-l;i&&this.options.autoCenter&&d>0&&(this.scrollContainer.scrollLeft+=Math.min(d,10))}{const d=this.scrollContainer.scrollLeft;this.emit("scroll",d/o,(d+s)/o,d,d+s)}}renderProgress(n,i){if(isNaN(n))return;const e=100*n;this.canvasWrapper.style.clipPath=`polygon(${e}% 0, 100% 0, 100% 100%, ${e}% 100%)`,this.progressWrapper.style.width=`${e}%`,this.cursor.style.left=`${e}%`,this.cursor.style.transform=`translateX(-${100===Math.round(e)?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(n,i)}exportImage(n,i,e){return x(this,void 0,void 0,function*(){const o=this.canvasWrapper.querySelectorAll("canvas");if(!o.length)throw new Error("No waveform data");if("dataURL"===e){const s=Array.from(o).map(a=>a.toDataURL(n,i));return Promise.resolve(s)}return Promise.all(Array.from(o).map(s=>new Promise((a,c)=>{s.toBlob(h=>{h?a(h):c(new Error("Could not export image"))},n,i)})))})}}U.MAX_CANVAS_WIDTH=8e3,U.MAX_NODES=10;class Wt extends L{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}class ot extends L{constructor(n=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=n,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return x(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(n){if(this.currentSrc=n,this._duration=void 0,!n)return this.buffer=null,void this.emit("emptied");fetch(n).then(i=>{if(i.status>=400)throw new Error(`Failed to fetch ${n}: ${i.status} (${i.statusText})`);return i.arrayBuffer()}).then(i=>this.currentSrc!==n?null:this.audioContext.decodeAudioData(i)).then(i=>{this.currentSrc===n&&(this.buffer=i,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var n;if(!this.paused)return;this.paused=!1,null===(n=this.bufferNode)||void 0===n||n.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let i=this.playedDuration*this._playbackRate;i>=this.duration&&(i=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,i),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var n;this.paused=!0,null===(n=this.bufferNode)||void 0===n||n.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return x(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(n){var i,e;null===(i=this.bufferNode)||void 0===i||i.stop(this.audioContext.currentTime+(n-this.currentTime)),null===(e=this.bufferNode)||void 0===e||e.addEventListener("ended",()=>{this.bufferNode=null,this.pause()},{once:!0})}setSinkId(n){return x(this,void 0,void 0,function*(){return this.audioContext.setSinkId(n)})}get playbackRate(){return this._playbackRate}set playbackRate(n){this._playbackRate=n,this.bufferNode&&(this.bufferNode.playbackRate.value=n)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(n){const i=!this.paused;i&&this._pause(),this.playedDuration=n/this._playbackRate,i&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var n,i;return null!==(n=this._duration)&&void 0!==n?n:(null===(i=this.buffer)||void 0===i?void 0:i.duration)||0}set duration(n){this._duration=n}get volume(){return this.gainNode.gain.value}set volume(n){this.gainNode.gain.value=n,this.emit("volumechange")}get muted(){return this._muted}set muted(n){this._muted!==n&&(this._muted=n,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(n){return/^(audio|video)\//.test(n)}getGainNode(){return this.gainNode}getChannelData(){const n=[];if(!this.buffer)return n;const i=this.buffer.numberOfChannels;for(let e=0;e<i;e++)n.push(this.buffer.getChannelData(e));return n}}const Gt={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class $ extends Jt{static create(n){return new $(n)}constructor(n){const i=n.media||("WebAudio"===n.backend?new ot:void 0);super({media:i,mediaControls:n.mediaControls,autoplay:n.autoplay,playbackRate:n.audioRate}),this.plugins=[],this.decodedData=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},Gt,n),this.timer=new Wt;const e=i?void 0:this.getMediaElement();this.renderer=new U(this.options,e),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const o=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");const{peaks:s,duration:a}=this.options;(o||s&&a)&&this.load(o,s,a).catch(()=>null)})}updateProgress(n=this.getCurrentTime()){return this.renderer.renderProgress(n/this.getDuration(),this.isPlaying()),n}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const n=this.updateProgress();this.emit("timeupdate",n),this.emit("audioprocess",n)}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const n=this.updateProgress();this.emit("timeupdate",n)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop()}),this.onMediaEvent("emptied",()=>{this.timer.stop()}),this.onMediaEvent("ended",()=>{this.emit("finish")}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",n=>{this.emit("error",n.error)}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(n,i)=>{this.options.interact&&(this.seekTo(n),this.emit("interaction",n*this.getDuration()),this.emit("click",n,i))}),this.renderer.on("dblclick",(n,i)=>{this.emit("dblclick",n,i)}),this.renderer.on("scroll",(n,i,e,o)=>{const s=this.getDuration();this.emit("scroll",n*s,i*s,e,o)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",n=>{this.emit("dragstart",n)}),this.renderer.on("dragend",n=>{this.emit("dragend",n)}));{let n;this.subscriptions.push(this.renderer.on("drag",i=>{if(!this.options.interact)return;let e;this.renderer.renderProgress(i),clearTimeout(n),this.isPlaying()?e=0:!0===this.options.dragToSeek?e=200:"object"==typeof this.options.dragToSeek&&void 0!==this.options.dragToSeek&&(e=this.options.dragToSeek.debounceTime),n=setTimeout(()=>{this.seekTo(i)},e),this.emit("interaction",i*this.getDuration()),this.emit("drag",i)}))}}initPlugins(){var n;null!==(n=this.options.plugins)&&void 0!==n&&n.length&&this.options.plugins.forEach(i=>{this.registerPlugin(i)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(n=>n()),this.mediaSubscriptions=[]}setOptions(n){this.options=Object.assign({},this.options,n),this.renderer.setOptions(this.options),n.audioRate&&this.setPlaybackRate(n.audioRate),null!=n.mediaControls&&(this.getMediaElement().controls=n.mediaControls)}registerPlugin(n){return n._init(this),this.plugins.push(n),this.subscriptions.push(n.once("destroy",()=>{this.plugins=this.plugins.filter(i=>i!==n)})),n}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(n){return this.renderer.setScroll(n)}setScrollTime(n){const i=n/this.getDuration();this.renderer.setScrollPercentage(i)}getActivePlugins(){return this.plugins}loadAudio(n,i,e,o){return x(this,void 0,void 0,function*(){var s;if(this.emit("load",n),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,!i&&!e){const c=this.options.fetchParams||{};window.AbortController&&!c.signal&&(this.abortController=new AbortController,c.signal=null===(s=this.abortController)||void 0===s?void 0:s.signal);const h=l=>this.emit("loading",l);i=yield Yt.fetchBlob(n,h,c)}this.setSrc(n,i);const a=yield new Promise(c=>{const h=o||this.getDuration();h?c(h):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>c(this.getDuration()),{once:!0}))});if(!n&&!i){const c=this.getMediaElement();c instanceof ot&&(c.duration=a)}if(e)this.decodedData=et.createBuffer(e,a||0);else if(i){const c=yield i.arrayBuffer();this.decodedData=yield et.decode(c,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(n,i,e){return x(this,void 0,void 0,function*(){try{return yield this.loadAudio(n,void 0,i,e)}catch(o){throw this.emit("error",o),o}})}loadBlob(n,i,e){return x(this,void 0,void 0,function*(){try{return yield this.loadAudio("",n,i,e)}catch(o){throw this.emit("error",o),o}})}zoom(n){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(n),this.emit("zoom",n)}getDecodedData(){return this.decodedData}exportPeaks({channels:n=2,maxLength:i=8e3,precision:e=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const o=Math.min(n,this.decodedData.numberOfChannels),s=[];for(let a=0;a<o;a++){const c=this.decodedData.getChannelData(a),h=[],l=c.length/i;for(let d=0;d<i;d++){const g=c.slice(Math.floor(d*l),Math.ceil((d+1)*l));let p=0;for(let f=0;f<g.length;f++){const v=g[f];Math.abs(v)>Math.abs(p)&&(p=v)}h.push(Math.round(p*e)/e)}s.push(h)}return s}getDuration(){let n=super.getDuration()||0;return 0!==n&&n!==1/0||!this.decodedData||(n=this.decodedData.duration),n}toggleInteraction(n){this.options.interact=n}setTime(n){super.setTime(n),this.updateProgress(n),this.emit("timeupdate",n)}seekTo(n){const i=this.getDuration()*n;this.setTime(i)}playPause(){return x(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(n){this.setTime(this.getCurrentTime()+n)}empty(){this.load("",[[0]],.001)}setMediaElement(n){this.unsubscribePlayerEvents(),super.setMediaElement(n),this.initPlayerEvents()}exportImage(){return x(this,arguments,void 0,function*(n="image/png",i=1,e="dataURL"){return this.renderer.exportImage(n,i,e)})}destroy(){var n;this.emit("destroy"),null===(n=this.abortController)||void 0===n||n.abort(),this.plugins.forEach(i=>i.destroy()),this.subscriptions.forEach(i=>i()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}$.BasePlugin=class extends L{constructor(r){super(),this.subscriptions=[],this.options=r}onInit(){}_init(r){this.wavesurfer=r,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(r=>r())}},$.dom=Ht;var st=m(3932);const Bt=["waveform"];function zt(r,n){1&r&&t._UZ(0,"i",8)}function qt(r,n){1&r&&t._UZ(0,"i",9)}let Qt=(()=>{var r;class n{constructor(e){this.archivoService=e,this.isAudioPlaying=new t.vpe,this.isPlaying=!1}ngOnInit(){}ngAfterViewInit(){this.waveform=$.create({container:this.waveformEl.nativeElement,barWidth:2,barGap:2,height:this.height,width:this.width,waveColor:"#FFFFFF",progressColor:"#A8A6D3",cursorWidth:0}),this.events(),this.descargarArchivo(this.idArchivo)}events(){this.waveform.on("ready",()=>{this.duracionAudio=this.calcularDuracion(this.waveform.getDuration())}),this.waveform.on("interaction",()=>{this.waveform.play()}),this.waveform.on("play",()=>{this.isPlaying=!0,this.isAudioPlayingEvent(!0)}),this.waveform.on("pause",()=>{this.isPlaying=!1,this.isAudioPlayingEvent(!1)})}playAudio(){this.waveform.play()}pauseAudio(){this.waveform.pause()}switchPlay(){this.isPlaying?this.pauseAudio():this.playAudio()}calcularDuracion(e){return`${Math.floor(e/60)}:${(e%60).toString().split(".")[0].padStart(2,"0")}`}descargarArchivo(e){this.archivoService.getArchivo(e).subscribe({next:o=>{this.archivo=`data:${o.archivoMime};base64,${o.archivo}`},error:()=>{console.error("Error al descargar el archivo")},complete:()=>{fetch(this.archivo).then(o=>o.blob()).then(o=>{this.waveform.loadBlob(o)})}})}isAudioPlayingEvent(e){this.isAudioPlaying.emit(e)}}return(r=n).\u0275fac=function(e){return new(e||r)(t.Y36(st.g))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-audio-wave"]],viewQuery:function(e,o){if(1&e&&t.Gf(Bt,5),2&e){let s;t.iGM(s=t.CRH())&&(o.waveformEl=s.first)}},inputs:{height:"height",width:"width",idArchivo:"idArchivo",color:"color"},outputs:{isAudioPlaying:"isAudioPlaying"},standalone:!0,features:[t.jDz],decls:11,vars:4,consts:[[1,"contenedor-principal",3,"ngClass"],[1,"controls",3,"click"],[1,"contenedor-icono"],["class","fa fa-play icono-play","aria-hidden","true",4,"ngIf"],["class","fa fa-pause icono-play","aria-hidden","true",4,"ngIf"],[1,"duracion"],[1,"contenedor-audio"],["waveform",""],["aria-hidden","true",1,"fa","fa-play","icono-play"],["aria-hidden","true",1,"fa","fa-pause","icono-play"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return o.switchPlay()}),t.TgZ(2,"div",2),t.YNc(3,zt,1,0,"i",3),t.YNc(4,qt,1,0,"i",4),t.qZA(),t.TgZ(5,"div",5)(6,"span"),t._uU(7),t.qZA()()(),t.TgZ(8,"div",6),t._UZ(9,"div",null,7),t.qZA()()),2&e&&(t.Q6J("ngClass",o.color),t.xp6(3),t.Q6J("ngIf",!o.isPlaying),t.xp6(1),t.Q6J("ngIf",o.isPlaying),t.xp6(3),t.Oqu(o.duracionAudio))},dependencies:[_.ez,_.mk,_.O5],styles:[".contenedor-principal[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;display:flex;align-items:center}.controls[_ngcontent-%COMP%]{cursor:pointer;display:flex;height:100%}.contenedor-icono[_ngcontent-%COMP%]{width:16px;display:flex;align-items:center;justify-content:center}.duracion[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center;font-family:var(--font-body);font-size:12px;margin-right:12px}.icono-play[_ngcontent-%COMP%]{font-size:10px;width:10px;height:10px}.dark[_ngcontent-%COMP%]   .icono-play[_ngcontent-%COMP%], .dark[_ngcontent-%COMP%]   .duracion[_ngcontent-%COMP%]{color:var(--neutral-50)}.light[_ngcontent-%COMP%]   .icono-play[_ngcontent-%COMP%], .light[_ngcontent-%COMP%]   .duracion[_ngcontent-%COMP%]{color:var(--primary-700)}"]}),n})();var Xt=m(9390),Kt=m(933);const Vt=["fileInput"],te=["movableSpan"],ee=["textarea"];function ne(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"ion-content")(1,"ion-list",28)(2,"ion-item",29),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.abandonarChat())}),t.TgZ(3,"ion-label"),t._uU(4,"Abandonar chat"),t.qZA()()()()}}function ie(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"ion-content")(1,"ion-list",28)(2,"ion-item",29),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.crearLlamadaJitsi())}),t.TgZ(3,"ion-label"),t._uU(4,"Jitsi"),t.qZA()(),t.TgZ(5,"ion-item",29),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.crearLlamadaWebRTC())}),t.TgZ(6,"ion-label"),t._uU(7,"WebRTC"),t.qZA()()()()}}function oe(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"textarea",39,40),t.NdJ("ngModelChange",function(o){t.CHM(i);const s=t.oxw(2);return t.KtG(s.msg=o)})("keyup.enter",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.enviarMensaje())}),t._uU(2,"            "),t.qZA()}if(2&r){const i=t.oxw(2);t.Q6J("ngModel",i.msg)}}function se(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar",30)(2,"ion-buttons")(3,"ion-button",31),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.cancelarEnviarFoto())}),t._UZ(4,"ion-icon",32),t.qZA()()()(),t.TgZ(5,"ion-content")(6,"div",33),t._UZ(7,"ion-img",34),t.qZA()(),t.TgZ(8,"ion-footer")(9,"ion-toolbar",35),t.YNc(10,oe,3,1,"textarea",36),t.TgZ(11,"ion-buttons",37)(12,"ion-button",31),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.enviarMensaje())}),t._UZ(13,"ion-icon",38),t.qZA()()()()}if(2&r){const i=t.oxw();t.xp6(7),t.Q6J("src",i.fotoTomada),t.xp6(3),t.Q6J("ngIf",!i.grabacionIniciada)}}function re(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"div",51)(1,"app-audio-wave",52),t.NdJ("isAudioPlaying",function(o){t.CHM(i);const s=t.oxw(3);return t.KtG(s.onAudioPlay(o))}),t.qZA()()}if(2&r){const i=t.oxw(2).$implicit,e=t.oxw();t.xp6(1),t.Q6J("color",e.setColorAudio(i.idPersona))("idArchivo",i.idArchivo)("height",36)("width",132)}}function ae(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"div",53),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2).$implicit,s=t.oxw();return t.KtG(s.clickArchivo(o.idArchivo))}),t._UZ(1,"ion-ripple-effect"),t.TgZ(2,"div",54),t._UZ(3,"ion-icon",55),t.TgZ(4,"span",56),t._uU(5),t.qZA()()()}if(2&r){const i=t.oxw(2).$implicit;t.xp6(5),t.Oqu(i.archivoNombre)}}function ce(r,n){if(1&r&&(t.TgZ(0,"div",48),t.YNc(1,re,2,4,"div",49),t.YNc(2,ae,6,1,"div",50),t.qZA()),2&r){const i=t.oxw().$implicit,e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.adjuntoEsAudio(i)),t.xp6(1),t.Q6J("ngIf",!e.adjuntoEsAudio(i))}}function le(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"div",41)(1,"div",42)(2,"div",43)(3,"div",44),t.NdJ("click",function(){const s=t.CHM(i).$implicit,a=t.oxw();return t.KtG(a.validarMeet(s))}),t.TgZ(4,"span"),t._uU(5),t.qZA()(),t.YNc(6,ce,3,2,"div",45),t.qZA(),t.TgZ(7,"div",46)(8,"div",47)(9,"span"),t._uU(10),t.ALo(11,"date"),t.qZA()()()()()}if(2&r){const i=n.$implicit,e=t.oxw();t.Q6J("ngClass",e.esMensajeMio(i.idPersona)?"mio":"otra-persona"),t.xp6(1),t.Q6J("ngClass",e.esMensajeMio(i.idPersona)?"mio":"otra-persona"),t.xp6(4),t.Oqu(i.mensaje),t.xp6(1),t.Q6J("ngIf",e.hayAdjuntoEnMensaje(i)),t.xp6(4),t.Oqu(t.gM2(11,5,i.fecha,"dd/MM/yyyy 'a las' h:mm a","","es-MX"))}}function he(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"div",60),t._UZ(1,"audio",61),t.TgZ(2,"ion-buttons",62)(3,"ion-button",31),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.changeAudio())}),t._UZ(4,"ion-icon",63),t.qZA()()()}if(2&r){const i=t.oxw(2);t.xp6(1),t.Q6J("src",i.audio2,t.LSH)}}function de(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"div",60)(1,"ion-item",64),t._UZ(2,"ion-icon",65),t.TgZ(3,"ion-label"),t._uU(4),t.qZA()(),t.TgZ(5,"ion-buttons",62)(6,"ion-button",31),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.eliminarArchivo())}),t._UZ(7,"ion-icon",63),t.qZA()()()}if(2&r){const i=t.oxw(2);t.xp6(4),t.Oqu(null==i.archivo?null:i.archivo.name)}}function ue(r,n){if(1&r&&(t.TgZ(0,"ion-toolbar",57),t.YNc(1,he,5,1,"div",58),t.YNc(2,de,8,1,"div",59),t.qZA()),2&r){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.isAudio),t.xp6(1),t.Q6J("ngIf",i.archivo)}}function pe(r,n){if(1&r&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&r){const i=t.oxw(2);t.xp6(1),t.hij(" ",i.duracionAudio," ")}}function me(r,n){if(1&r&&(t.TgZ(0,"div",66)(1,"div",67)(2,"ion-buttons",68)(3,"ion-button",69),t._UZ(4,"ion-icon",70),t.qZA()(),t.YNc(5,pe,2,1,"span",71),t.ALo(6,"async"),t.qZA(),t.TgZ(7,"span",72,73),t._uU(9," Desliza para cancelar "),t._UZ(10,"ion-icon",74),t.qZA()()),2&r){const i=t.oxw();t.xp6(5),t.Q6J("ngIf",t.lcZ(6,1,i.timer$))}}function ge(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"ion-buttons",75)(1,"ion-button",31),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.openFileInput())}),t._UZ(2,"ion-icon",76),t.qZA(),t.TgZ(3,"input",77,78),t.NdJ("change",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.onFileSelected(o))}),t.qZA()()}}function fe(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"div",79)(1,"textarea",80,81),t.NdJ("ngModelChange",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.msg=o)})("keyup.enter",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.enviarMensaje())})("input",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.ajustarAlturaTextarea(o))}),t._uU(4,"        "),t.qZA()()}if(2&r){const i=t.oxw();t.xp6(1),t.Q6J("ngModel",i.msg)}}function ve(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"ion-button",86),t.NdJ("click",function(){t.CHM(i);const o=t.oxw(2);return t.KtG(o.tomarFoto())}),t._UZ(1,"ion-icon",87),t.qZA()}}const _e=function(r){return{color:r}};function Ce(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"ion-buttons",82),t.YNc(1,ve,2,0,"ion-button",83),t.TgZ(2,"ion-button",84),t.NdJ("press",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.presionarGrabarAudio(o))})("swipe",function(o){t.CHM(i);const s=t.oxw();return t.KtG(s.deslizarCancelarAudio(o))}),t._UZ(3,"ion-icon",85),t.qZA()()}if(2&r){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",!i.grabacionIniciada),t.xp6(2),t.Q6J("ngStyle",t.VKq(2,_e,i.grabacionIniciada?"var(--primary-700)":"var(--neutral-500)"))}}function be(r,n){if(1&r){const i=t.EpF();t.TgZ(0,"ion-buttons",82)(1,"ion-button",88),t.NdJ("click",function(){t.CHM(i);const o=t.oxw();return t.KtG(o.enviarMensaje())}),t._UZ(2,"ion-icon",38),t.qZA()()}if(2&r){const i=t.oxw();t.xp6(1),t.Q6J("disabled",!i.escribiendoMensaje())}}const Me=function(r){return{"contenedor-principal2":r}},ye=[{path:"",component:ct,children:[{path:"",component:Tt},{path:"chat/:id",component:(()=>{var r;class n{constructor(e,o,s,a,c,h,l,d,g,p,f,v){this.ChatMensajeHubService=e,this.ChatPersonaService=o,this.router=s,this.route=a,this.ChatHubServiceService=c,this.ArchivoService=h,this.plataformaService=l,this.ModalController=d,this.capacitorUtils=g,this.PopoverController=p,this.rout=f,this.dataJitsiService=v,this.msg="",this.chat={fecha:new Date,habilitado:!0,titulo:"Chat",idCreadorChat:0},this.escribiendo=!1,this.isModalOpen=!1,this.stop$=new At.x,this.duracionAudio="",this.duracion=0,this.archivo=void 0,this.alturaTextAreaAlterada=!1,this.isAudio=!1,this.grabacionIniciada=!1,this.grabacionCancelada=!1,this.audio="",this.isAudioPlaying=!1,(0,G.a)({file:"assets/img/svg/file.svg","chevron-left":"assets/img/svg/chevron-left.svg",camera:"assets/img/svg/camera.svg",send:"assets/img/svg/send-filled.svg","send-filled":"assets/img/svg/send_filled.svg",trash:"assets/img/svg/trash-2.svg",mic:"assets/img/svg/mic.svg","ellipsis-vertical":"assets/img/svg/ellipsis-vertical.svg",video:"assets/img/svg/video.svg"})}ionViewWillEnter(){this.obtenerIdUsuario(),this.obtenerIdChat(),this.solicitarPermisos()}ngAfterViewInit(){this.scrollContentToBottom()}obtenerIdChat(){this.router.params.subscribe(e=>{this.idChat=Number(e.id),this.obtenerMensajes(),this.obtenerChat()})}obtenerChat(){this.ChatHubServiceService.chat$.subscribe(e=>{this.chat=e.find(o=>o.idChat==this.idChat)||{fecha:new Date,habilitado:!1,idCreadorChat:0}})}enviarMensaje(){var e=this;return(0,y.Z)(function*(){if(/^\n+$/.test(e.msg))return void(e.msg="");e.descripcionTextarea.nativeElement.style.height="auto",e.alturaTextAreaAlterada=!1;let a={fecha:new Date,idChat:e.idChat,mensaje:e.msg,idPersona:e.idUsuario,archivo:"",idArchivo:0};if(e.archivo){let c=yield e.convertirBase64String();c=c.split(",")[1],a.archivo=c,a.archivoNombre=e.archivo.name,a.archivoTipoMime=e.archivo.type,a.fechaRealizacion=new Date,a.nombre=e.archivo.name}if(e.fotoTomada){let l=`Trackr-Image_${(0,Ft.Z)(new Date,"yyyy-MM-dd HH:mm:ss")}.jpeg`,d=e.fotoTomada.split(",")[1];a.archivo=d,a.archivoNombre=l,a.archivoTipoMime="image/jpeg",a.fechaRealizacion=new Date,a.nombre=l}""!=e.audio&&(a.archivo=e.audio,a.archivoNombre=`audio-${Date.now()}.wav`,a.archivoTipoMime="audio/wav",a.fechaRealizacion=new Date,a.nombre=`audio-${Date.now()}.wav`),e.ChatMensajeHubService.enviarMensaje(a),0==e.mensajes.length&&e.ChatMensajeHubService.chatMensaje$.subscribe(c=>{e.mensajes=c.find(h=>h.some(l=>l.idChat===e.idChat))||[]}),e.msg="",e.fotoTomada="",e.isModalOpen=!1,e.archivo=void 0,e.audio="",e.audio2="",e.isAudio=!1})()}obtenerIdUsuario(){this.ChatPersonaService.obtenerIdUsuario().subscribe(e=>{this.idUsuario=e})}esMensajeMio(e){return e==this.idUsuario}obtenerMensajes(){this.chatMensajes$=this.ChatMensajeHubService.chatMensaje$,this.chatMensajes$.subscribe(e=>{this.chatMensajes=e,this.obtenerChatSeleccionado(),this.scrollContentToBottom()})}obtenerChatSeleccionado(){this.mensajes=this.chatMensajes.find(e=>e.some(o=>o.idChat==this.idChat))||[]}regresarBtn(){this.route.navigate(["home/chat-movil"])}onFileSelected(e){this.archivo=e.target.files[0]}readFileAsByteArray(e){return new Promise((o,s)=>{const a=new FileReader;a.onload=c=>{const l=new Uint8Array(c.target.result);o(l)},a.onerror=c=>{s(c)},a.readAsArrayBuffer(e)})}convertirBase64String(){return new Promise((e,o)=>{if(this.archivo){const s=new FileReader;s.onload=a=>{e(a.target.result)},s.onerror=a=>{o(a)},s.readAsDataURL(this.archivo)}else o("No se ha seleccionado ning\xfan archivo.")})}subirArchivo(){var e=this;return(0,y.Z)(function*(){if(e.archivo){let o=yield e.readFileAsByteArray(e.archivo),s={idUsuario:e.idUsuario,archivo:Array.from(o),archivoNombre:e.archivo.name,archivoTipoMime:e.archivo.type,fechaRealizacion:new Date,nombre:e.archivo.name};e.ArchivoService.subirArchivo(s).subscribe(a=>{})}})()}clickArchivo(e){var o=this;return(0,y.Z)(function*(){(yield o.ModalController.create({component:jt.D,componentProps:{fileSource:"id",idArchivo:e}})).present()})()}downloadFileMobile(e,o,s){return(0,y.Z)(function*(){try{yield W.fy.writeFile({path:`${W.tP.Data}/${o}`,data:e,directory:W.tP.External,recursive:!0})}catch(a){console.error("Error al descargar el archivo:",a)}})()}downloadFileWeb(e,o,s){const a=atob(e),c=new Array(a.length);for(let p=0;p<a.length;p++)c[p]=a.charCodeAt(p);const h=new Uint8Array(c),l=new Blob([h],{type:"application/octet-stream"}),d=URL.createObjectURL(l),g=document.createElement("a");document.body.appendChild(g),g.style.display="none",g.href=d,g.download=`${o}`,g.click(),URL.revokeObjectURL(d)}openFileInput(){""!=this.audio&&(this.audio="",this.audio2="",this.isAudio=!1),this.fileInput.nativeElement.value="",this.fileInput.nativeElement.click()}imprimirFecha(e){let o=new Date(e);return`${o.getDate()}/${o.getMonth()+1}/${o.getFullYear()} - ${o.getHours()}:${o.getMinutes()}`}scrollContentToBottom(){this.content.scrollToBottom()}eliminarArchivo(){this.archivo=void 0}changeAudio(){this.audio="",this.audio2="",this.isAudio=!this.isAudio}solicitarPermisos(){R.hasAudioRecordingPermission().then(e=>{e.value||R.requestAudioRecordingPermission()})}grabar(){this.grabacionIniciada||(this.grabacionIniciada=!0,R.startRecording().then(e=>{this.calcularDuracion()}))}detenerGrabacion(){this.grabacionIniciada&&!this.grabacionCancelada?(this.archivo&&(this.archivo=void 0),R.stopRecording().then(e=>{this.grabacionIniciada=!1,this.isAudio=!0,e.value&&(this.audio=e.value.recordDataBase64,this.audio2="data:audio/wav;base64,"+e.value.recordDataBase64)})):this.grabacionCancelada=!1}cancelarGrabacion(){this.grabacionIniciada&&(this.archivo&&(this.archivo=void 0),R.stopRecording().then(e=>{this.grabacionCancelada=!0,this.grabacionIniciada=!1}))}calcularDuracion(){if(!this.grabacionIniciada)return this.duracion=0,void(this.duracionAudio="");this.timer$=function It(r=0,n,i=Zt.P){let e=-1;return null!=n&&((0,Dt.K)(n)?i=n:e=n),new St.y(o=>{let s=(0,Et.q)(r)?+r-i.now():r;s<0&&(s=0);let a=0;return i.schedule(function(){o.closed||(o.next(a++),0<=e?this.schedule(void 0,e):o.complete())},s)})}(0,1e3).pipe((0,kt.R)(this.stop$),(0,Nt.o)(e=>this.duracion>=0),(0,Ut.x)(()=>{this.duracion=0}),(0,Rt.U)(e=>{this.duracion=this.duracion+1;const o=Math.floor(this.duracion/60),s=(this.duracion%60).toString().padStart(2,"0");return this.duracionAudio=`${o}:${s}`,this.duracion}))}crearLlamadaJitsi(){this.route.navigate(["/home/video-jitsi/create-call",this.idChat]),setTimeout(()=>{this.dataJitsiService.comenzarLlamada(this.idChat)},200)}crearLlamadaWebRTC(){let e=this.idUsuario,a=`\u{1f4de} Te espero la sala webrtc-${this.idChat}-${e}`;this.ChatMensajeHubService.enviarMensaje({fecha:new Date,idChat:this.idChat,mensaje:a,idPersona:e,archivo:"",idArchivo:0,esVideoChat:!0}),this.route.navigate(["/home/chat"])}contestarLlamada(e){this.route.navigate(["/home/video-jitsi/answer-call",e]),setTimeout(()=>{this.dataJitsiService.contestarLlamada(e)},200)}validarMeet(e){if(!this.esMensajeMio(e.idPersona)){if(e.mensaje.includes("trackr-"+this.idChat)){const s=e.mensaje.match(/trackr-\d+-\d+/);s&&s.length>0?this.contestarLlamada(s[0]):console.error("Error al validar codigo meet jitsi.")}if(e.mensaje.includes("webrtc-"+this.idChat)){const s=e.mensaje.match(/webrtc-\d-(\d+)/);s&&s.length>0?this.route.navigate(["/home/chat",s[1]]):console.error("Error al validar codigo meet jitsi.")}}}escribiendoMensaje(){return!(!this.isAudio&&!this.archivo&&/^ *$/.test(this.msg))}presionarGrabarAudio(e){"start"==e&&(V.impact({style:K.y$.Light}),this.grabar()),"end"==e&&(V.impact({style:K.y$.Light}),this.detenerGrabacion())}deslizarCancelarAudio(e){"left"==e.dirX&&(e.currentX<=e.startX-100&&this.cancelarGrabacion(),this.grabacionCancelada||this.updateSpanPosition(e.currentX-e.startX+15))}updateSpanPosition(e){this.movableSpan.nativeElement.style.transform=`translateX(calc(-50% + ${e}px))`}tomarFoto(){var e=this;return(0,y.Z)(function*(){e.archivo=void 0,e.audio="",e.audio2="",e.isAudio=!1,e.fotoTomada=yield e.capacitorUtils.takePicture(),e.isModalOpen=!0})()}cancelarEnviarFoto(){this.msg="",this.fotoTomada="",this.isModalOpen=!1}abandonarChat(){var e=this;return(0,y.Z)(function*(){e.ChatMensajeHubService.abandonarChat(e.idChat),e.ChatMensajeHubService.enviarMensaje({idChat:e.idChat,fecha:new Date,idPersona:0,mensaje:"He abandonado el chat",idArchivo:0}),yield e.PopoverController.dismiss(),e.regresarBtn()})()}ajustarAlturaTextarea(e){const o=this.descripcionTextarea.nativeElement;o.style.height="auto",this.alturaTextAreaAlterada=o.scrollHeight>40,o.style.height=o.scrollHeight+"px"}esAudio(e){return null!=e&&"audio"==e.split("/")[0]}hayAdjuntoEnMensaje(e){return 0!==e.idArchivo&&null!=e.idArchivo}adjuntoEsAudio(e){return"audio/wav"===e.archivoTipoMime||"audio/webm"===e.archivoTipoMime}setColorAudio(e){return this.idUsuario==e?"dark":"light"}onAudioPlay(e){this.isAudioPlaying=e}}return(r=n).\u0275fac=function(e){return new(e||r)(t.Y36(F.U),t.Y36(Y.R),t.Y36(J.gz),t.Y36(J.F0),t.Y36(P.L),t.Y36(st.g),t.Y36(Xt.O),t.Y36(u.IN),t.Y36(tt.Z),t.Y36(u.Dh),t.Y36(J.gz),t.Y36(Kt.s))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-mensajes"]],viewQuery:function(e,o){if(1&e&&(t.Gf(Vt,5),t.Gf(u.W2,5),t.Gf(te,5),t.Gf(ee,5)),2&e){let s;t.iGM(s=t.CRH())&&(o.fileInput=s.first),t.iGM(s=t.CRH())&&(o.content=s.first),t.iGM(s=t.CRH())&&(o.movableSpan=s.first),t.iGM(s=t.CRH())&&(o.descripcionTextarea=s.first)}},standalone:!0,features:[t._Bn([tt.Z]),t.jDz],decls:36,vars:12,consts:[[1,"chat-header","ion-no-border"],["slot","start",1,"start"],["fill","clear","routerLink","home/chat-movil",3,"click"],["name","chevron-left"],[1,"titulo"],["slot","end",1,"end","popup-wrapper"],["fill","clear","id","click-trigger",1,"popup-button"],["name","video"],["fill","clear","id","puntos-trigger"],["name","ellipsis-vertical"],["trigger","puntos-trigger","triggerAction","click",1,"custom-popover"],["trigger","click-trigger","triggerAction","click","dismiss-on-select","true","size","auto",1,"custom-popover"],[1,"contenedor-principal"],[1,"enviar-foto-modal",3,"isOpen"],[1,"contenedor-chat"],[1,"lista-mensajes"],["scrollContainer",""],["class","row-mensaje",3,"ngClass",4,"ngFor","ngForOf"],[1,"chat-footer","ion-no-border"],["class","optional-toolbar",4,"ngIf"],[1,"main-toolbar"],[1,"contenedor-principal1",3,"ngClass"],["class","grabando-audio-container",4,"ngIf"],[1,"contenedor-izquierda"],["slot","start","class","left-buttons",4,"ngIf"],["class","contenedor-central",4,"ngIf"],[1,"contenedor-derecha"],["slot","end","class","right-buttons",4,"ngIf"],["lines","none"],["button","",3,"click"],[1,"header"],["fill","clear",3,"click"],["slot","icon-only","name","chevron-left"],[1,"contenedor-imagen"],[1,"imagen",3,"src"],[1,"footer"],["placeholder","A\xf1ade un comentario...","class","texto-mensaje","name","mensaje","type","text","maxlength","800","autocomplete","off","rows","1","required","",3,"ngModel","ngModelChange","keyup.enter",4,"ngIf"],["slot","end"],["slot","icon-only","name","send-filled",2,"color","var(--primary-700)"],["placeholder","A\xf1ade un comentario...","name","mensaje","type","text","maxlength","800","autocomplete","off","rows","1","required","",1,"texto-mensaje",3,"ngModel","ngModelChange","keyup.enter"],["descripcion","ngModel"],[1,"row-mensaje",3,"ngClass"],[1,"bubble",3,"ngClass"],[1,"bubble-content"],[1,"mensaje",3,"click"],["class","adjunto",4,"ngIf"],[1,"bubble-footer"],[1,"fecha-mensaje"],[1,"adjunto"],["class","audio",4,"ngIf"],["class","archivo ion-activatable",3,"click",4,"ngIf"],[1,"audio"],[3,"color","idArchivo","height","width","isAudioPlaying"],[1,"archivo","ion-activatable",3,"click"],["id","contenido-archivo"],["name","file",1,"icono"],[1,"nombre-archivo"],[1,"optional-toolbar"],["style","display: flex; justify-content: space-between;  margin: 1vw 2vw 0 2vw;",4,"ngIf"],["style","display: flex; justify-content: space-between; margin: 1vw 2vw 0 2vw;",4,"ngIf"],[2,"display","flex","justify-content","space-between","margin","1vw 2vw 0 2vw"],["controls","",3,"src"],[2,"color","var(--error-200)"],["name","trash","slot","icon-only"],["lines","none",2,"width","100%"],["slot","start","name","file"],[1,"grabando-audio-container"],[1,"contador-tiempo"],["slot","start"],["fill","clear","disabled",""],["size","small","slot","icon-only","name","mic",2,"color","var(--error-200)"],[4,"ngIf"],[2,"position","absolute","transform","translateX(-50%)","left","50%"],["movableSpan",""],["name","chevron-left",2,"position","absolute","right","-10%","bottom","18%"],["slot","start",1,"left-buttons"],["slot","icon-only","name","file"],["type","file","id","fileInput",2,"display","none",3,"change"],["fileInput",""],[1,"contenedor-central"],["name","mensaje","type","text","maxlength","800","autocomplete","off","rows","1","required","",1,"texto-mensaje",3,"ngModel","ngModelChange","keyup.enter","input"],["textarea","","descripcion","ngModel"],["slot","end",1,"right-buttons"],[3,"click",4,"ngIf"],["appSwipe","","appPress","",3,"press","swipe"],["slot","icon-only","name","mic",3,"ngStyle"],[3,"click"],["slot","icon-only","name","camera"],["type","submit",3,"disabled","click"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-button",2),t.NdJ("click",function(){return o.regresarBtn()}),t._UZ(4,"ion-icon",3),t.qZA()(),t.TgZ(5,"ion-title",4),t._uU(6),t.qZA(),t.TgZ(7,"ion-buttons",5)(8,"ion-button",6),t._UZ(9,"ion-icon",7),t.qZA(),t.TgZ(10,"ion-button",8),t._UZ(11,"ion-icon",9),t.qZA(),t.TgZ(12,"ion-popover",10),t.YNc(13,ne,5,0,"ng-template"),t.qZA(),t.TgZ(14,"ion-popover",11),t.YNc(15,ie,8,0,"ng-template"),t.qZA()()()(),t.TgZ(16,"ion-content")(17,"div",12)(18,"ion-modal",13),t.YNc(19,se,14,2,"ng-template"),t.qZA(),t.TgZ(20,"div",14)(21,"div",15,16),t.YNc(23,le,12,10,"div",17),t.qZA()()()(),t.TgZ(24,"ion-footer",18)(25,"div"),t.YNc(26,ue,3,2,"ion-toolbar",19),t.TgZ(27,"ion-toolbar",20)(28,"div",21),t.YNc(29,me,11,3,"div",22),t.TgZ(30,"div",23),t.YNc(31,ge,5,0,"ion-buttons",24),t.qZA(),t.YNc(32,fe,5,1,"div",25),t.TgZ(33,"div",26),t.YNc(34,Ce,4,4,"ion-buttons",27),t.YNc(35,be,3,1,"ion-buttons",27),t.qZA()()()()()),2&e&&(t.xp6(6),t.hij(" ",o.chat.titulo," "),t.xp6(12),t.Q6J("isOpen",o.isModalOpen),t.xp6(5),t.Q6J("ngForOf",o.mensajes),t.xp6(3),t.Q6J("ngIf",o.isAudio||o.archivo),t.xp6(2),t.Q6J("ngClass",t.VKq(10,Me,!o.alturaTextAreaAlterada)),t.xp6(1),t.Q6J("ngIf",o.grabacionIniciada),t.xp6(2),t.Q6J("ngIf",!o.grabacionIniciada),t.xp6(1),t.Q6J("ngIf",!o.grabacionIniciada),t.xp6(2),t.Q6J("ngIf",!o.escribiendoMensaje()),t.xp6(1),t.Q6J("ngIf",o.escribiendoMensaje()))},dependencies:[Z.u5,Z.Fj,Z.JJ,Z.Q7,Z.nD,Z.On,_.ez,_.mk,_.sg,_.O5,_.PC,_.Ov,_.uU,u.Pc,u.YG,u.Sm,u.W2,u.fr,u.Gu,u.gu,u.Xz,u.Ie,u.Q$,u.q_,u.H$,u.wd,u.sr,u.ki,u.d8,u.YI,Lt,$t,Qt],styles:[".chat-header[_ngcontent-%COMP%]{min-height:15vh;display:flex;flex-direction:column;justify-content:end;border-bottom:1px solid var(--neutral-100)}.chat-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: var(--neutral-50);padding-top:32px}.chat-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]{font-family:var(--font-body);font-size:18px;color:var(--neutral-900);font-weight:700}.chat-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{color:var(--primary-700)}.chat-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px!important}.chat-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .start[_ngcontent-%COMP%]{margin-left:16px}.chat-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   .end[_ngcontent-%COMP%]{margin-right:16px}.contenedor-principal[_ngcontent-%COMP%]{min-height:100%;height:-moz-fit-content;height:fit-content;background:url(background_pattern.94ba27a8d2a9cd08.svg)}.lista-mensajes[_ngcontent-%COMP%]{overflow-y:scroll;padding:32px}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]{width:100%;height:auto;display:flex}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;max-width:80%;margin:8px 0;font-family:var(--font-body)}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]   .bubble-content[_ngcontent-%COMP%]{padding:10px;padding-bottom:4px!important}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]   .bubble-content[_ngcontent-%COMP%]   .mensaje[_ngcontent-%COMP%]{font-size:16px}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]   .bubble-content[_ngcontent-%COMP%]   .adjunto[_ngcontent-%COMP%]{border-radius:4px}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]   .bubble-footer[_ngcontent-%COMP%]{padding:10px;padding-top:4px!important}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble[_ngcontent-%COMP%]   .bubble-footer[_ngcontent-%COMP%]   .fecha-mensaje[_ngcontent-%COMP%]{width:100%;font-size:10px;text-align:end}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble.otra-persona[_ngcontent-%COMP%]{background:var(--neutral-50)!important;border-radius:16px 16px 16px 0!important}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble.otra-persona[_ngcontent-%COMP%]   .bubble-content[_ngcontent-%COMP%]{color:var(--neutral-900)}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble.otra-persona[_ngcontent-%COMP%]   .bubble-content[_ngcontent-%COMP%]   .adjunto[_ngcontent-%COMP%]{background:var(--neutral-200)}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble.otra-persona[_ngcontent-%COMP%]   .bubble-footer[_ngcontent-%COMP%]{color:var(--neutral-600)}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble.otra-persona[_ngcontent-%COMP%]   .bubble-footer[_ngcontent-%COMP%]   .fecha-mensaje[_ngcontent-%COMP%]{text-align:start!important}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble.mio[_ngcontent-%COMP%]{background:var(--primary-700)!important;border-radius:16px 16px 0!important;color:var(--neutral-50)}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje[_ngcontent-%COMP%]   .bubble.mio[_ngcontent-%COMP%]   .adjunto[_ngcontent-%COMP%]{background:var(--primary-800)}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje.mio[_ngcontent-%COMP%]{justify-content:end!important}.lista-mensajes[_ngcontent-%COMP%]   .row-mensaje.otra-persona[_ngcontent-%COMP%]{justify-content:start!important}.lista-mensajes[_ngcontent-%COMP%]   .adjunto[_ngcontent-%COMP%]{margin-top:4px}.lista-mensajes[_ngcontent-%COMP%]   .adjunto[_ngcontent-%COMP%]   .audio[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;height:36px;padding:0 16px 0 8px}.lista-mensajes[_ngcontent-%COMP%]   .adjunto[_ngcontent-%COMP%]   .archivo[_ngcontent-%COMP%]{width:100%;max-width:320px;height:36px;padding:0 8px;position:relative}.lista-mensajes[_ngcontent-%COMP%]   .adjunto[_ngcontent-%COMP%]   .archivo[_ngcontent-%COMP%]   #contenido-archivo[_ngcontent-%COMP%]{height:100%;display:flex;align-items:center}.lista-mensajes[_ngcontent-%COMP%]   .adjunto[_ngcontent-%COMP%]   .archivo[_ngcontent-%COMP%]   #contenido-archivo[_ngcontent-%COMP%]   .icono[_ngcontent-%COMP%]{margin-right:4px;font-size:16px!important}.lista-mensajes[_ngcontent-%COMP%]   .adjunto[_ngcontent-%COMP%]   .archivo[_ngcontent-%COMP%]   #contenido-archivo[_ngcontent-%COMP%]   .nombre-archivo[_ngcontent-%COMP%]{font-size:12px;width:calc(100% - 24px);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:inline-block}.chat-footer[_ngcontent-%COMP%]{min-height:10vh;display:flex;flex-direction:column;justify-content:start;border-top:1px solid var(--neutral-100)}.chat-footer[_ngcontent-%COMP%]   .optional-toolbar[_ngcontent-%COMP%]   audio[_ngcontent-%COMP%]::-webkit-media-controls-panel{background-color:var(--neutral-50)}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]{padding-bottom:32px}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .grabando-audio-container[_ngcontent-%COMP%]{display:flex;align-items:center}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .grabando-audio-container[_ngcontent-%COMP%]   .contador-tiempo[_ngcontent-%COMP%]{display:flex;align-items:center;z-index:99;background-color:var(--neutral-50);padding-right:2vw}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .grabando-audio-container[_ngcontent-%COMP%]   .contador-tiempo[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{color:var(--error-200);opacity:1}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .contenedor-principal1[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .contenedor-principal1[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--neutral-500)}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .contenedor-principal2[_ngcontent-%COMP%]{align-items:center}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .contenedor-izquierda[_ngcontent-%COMP%]{display:flex;align-items:flex-end!important}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .contenedor-central[_ngcontent-%COMP%]{display:flex;align-items:flex-end;margin-bottom:12px;margin-top:12px;width:100%}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .contenedor-central[_ngcontent-%COMP%]   .texto-mensaje[_ngcontent-%COMP%]{border:1px solid;border-color:var(--primary-100);border-radius:5px;background-color:var(--primary-50);max-height:100px!important;padding:8px;width:100%;scrollbar-width:none!important;-ms-overflow-style:none!important}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .contenedor-central[_ngcontent-%COMP%]   .texto-mensaje[_ngcontent-%COMP%]:focus{outline:none!important}.chat-footer[_ngcontent-%COMP%]   .main-toolbar[_ngcontent-%COMP%]   .contenedor-derecha[_ngcontent-%COMP%]{display:flex;align-items:flex-end}.enviar-foto-modal[_ngcontent-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: var(--neutral-950)}.enviar-foto-modal[_ngcontent-%COMP%]   .contenedor-imagen[_ngcontent-%COMP%]{height:100%;display:flex;justify-content:center;align-items:center}.enviar-foto-modal[_ngcontent-%COMP%]   .texto-mensaje[_ngcontent-%COMP%]{margin-left:10vw;width:70vw;border:0px;border-radius:5px;background-color:var(--primary-50)}.enviar-foto-modal[_ngcontent-%COMP%]   .texto-mensaje[_ngcontent-%COMP%]:focus{outline:none!important;border:1px solid;border-color:var(--primary-700)}"]}),n})()},{path:"**",redirectTo:"",pathMatch:"full"}]}]},9134:(z,N,m)=>{m.d(N,{q:()=>_});var y=m(1571),u=m(529);let _=(()=>{var t;class P{constructor(A){this.http=A,this.url="expedienteDoctor/"}consultarExpediente(){return this.http.get(this.url)}consultarExpedienteConImagenes(){return this.http.get(this.url+"conImagenes")}consultarSelector(){return this.http.get(this.url+"selector")}consultarPorUsuarioParaSelector(){return this.http.get(this.url+"selectorPorUsuario")}eliminar(A){return this.http.delete(this.url+"eliminarDoctorTrackr",{body:A})}agregar(A){return this.http.post(this.url,A)}}return(t=P).\u0275fac=function(A){return new(A||t)(y.LFG(u.eN))},t.\u0275prov=y.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),P})()}}]);