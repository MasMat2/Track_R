"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5902],{5902:(y,_,d)=>{d.r(_),d.d(_,{AgregarTratamientoPage:()=>k});var h=d(5861),g=d(6895),c=d(433),r=d(9149),e=d(1571),T=d(281),f=d(6388);let v=(()=>{var n;class l{constructor(){}takePicture(){return(0,h.Z)(function*(){return yield f.V1.getPhoto({resultType:f.dk.Base64,source:f.oK.Camera,quality:100})})()}}return(n=l).\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),l})();var Z=d(4384);function A(n,l){if(1&n&&(e.TgZ(0,"ion-select-option",32),e._uU(1),e.qZA()),2&n){const a=l.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.nombre)}}function b(n,l){if(1&n&&(e.TgZ(0,"ion-select-option",32),e._uU(1),e.qZA()),2&n){const a=l.$implicit;e.Q6J("value",a.id),e.xp6(1),e.Oqu(a.nombre)}}function P(n,l){if(1&n&&(e.TgZ(0,"ion-col",33),e._UZ(1,"ion-checkbox",34),e.TgZ(2,"ion-label",35),e._uU(3),e.qZA()()),2&n){const a=l.$implicit,t=l.index;e.xp6(1),e.Q6J("formControlName",t),e.xp6(2),e.Oqu(a)}}function M(n,l){if(1&n){const a=e.EpF();e.TgZ(0,"ion-button",42),e.NdJ("click",function(){e.CHM(a);const o=e.oxw().index,i=e.oxw();return e.KtG(i.removeHour(o))}),e._UZ(1,"ion-icon",43),e.qZA()}}function D(n,l){if(1&n){const a=e.EpF();e.TgZ(0,"ion-button",42),e.NdJ("click",function(){e.CHM(a);const o=e.oxw(2);return e.KtG(o.addHour())}),e._UZ(1,"ion-icon",44),e.qZA()}}function x(n,l){if(1&n){const a=e.EpF();e.TgZ(0,"ion-row",36)(1,"ion-col",37)(2,"ion-input",38),e.NdJ("click",function(){const i=e.CHM(a).index,s=e.oxw();return e.KtG(s.openTimeModal(i))}),e.ALo(3,"date"),e.qZA(),e._UZ(4,"ion-icon",39),e.qZA(),e.TgZ(5,"ion-col",40),e.YNc(6,M,2,0,"ion-button",41),e.YNc(7,D,2,0,"ion-button",41),e.qZA()()}if(2&n){const a=l.$implicit,t=l.last;e.xp6(2),e.Q6J("value",e.xi3(3,3,a.value,"HH:mm")),e.xp6(4),e.Q6J("ngIf",!t),e.xp6(1),e.Q6J("ngIf",t)}}function C(n,l){if(1&n){const a=e.EpF();e.TgZ(0,"ion-datetime",45),e.NdJ("ngModelChange",function(o){e.CHM(a);const i=e.oxw();return e.KtG(i.selectedDate=o)}),e.qZA()}if(2&n){const a=e.oxw();e.Q6J("showDefaultButtons",!0)("ngModel",a.selectedDate)}}function w(n,l){if(1&n){const a=e.EpF();e.TgZ(0,"ion-datetime",46),e.NdJ("ngModelChange",function(o){e.CHM(a);const i=e.oxw();return e.KtG(i.selectedDate=o)}),e.qZA()}if(2&n){const a=e.oxw();e.Q6J("showDefaultButtons",!0)("ngModel",a.selectedDate)}}let k=(()=>{var n;class l{constructor(t,o,i,s){this.perfilTratamientoService=t,this.fb=o,this.photoService=i,this.router=s,this.weekDays=["Lu","Ma","Mi","Ju","Vi","S\xe1","Do"],this.selectedDate=(new Date).toISOString(),this.showDateModal=!1,this.showTimeModal=!1}ngOnInit(){this.formTratamiento=this.fb.group({fechaRegistro:[(new Date).toISOString(),c.kI.required],farmaco:["",c.kI.required],cantidad:["",c.kI.required],unidad:["",c.kI.required],indicaciones:["",c.kI.required],idPadecimiento:["",c.kI.required],idUsuarioDoctor:["",c.kI.required],tratamientoPermanente:[!1],fechaInicio:[(new Date).toISOString(),c.kI.required],fechaFin:[(new Date).toISOString()],imagenBase64:[""],recordatorioActivo:[!1],diaSemana:this.fb.array([!1,!1,!1,!1,!1,!1,!1]),horas:this.fb.array([(new Date).toISOString()])},{validators:[this.validateDiaSemana(),this.compareDates()]}),this.selectorPadecimeintos(),this.selectorDoctor()}get horas(){return this.formTratamiento.get("horas")}selectorPadecimeintos(){this.padecimientos$=this.perfilTratamientoService.selectorPadecimeintos()}selectorDoctor(){this.doctores$=this.perfilTratamientoService.selectorDeDoctor()}addPhotoToGallery(){var t=this;return(0,h.Z)(function*(){t.photo=yield t.photoService.takePicture()})()}openTimeModal(t){this.hourIndex=t,this.showTimeModal=!0}closeTimeModal(){this.horas.at(this.hourIndex).setValue(this.selectedDate),this.showTimeModal=!1}openDateModal(t){this.dateIndex=t,this.showDateModal=!0}closeDateModal(){this.formTratamiento.controls[this.dateIndex].setValue(this.selectedDate),this.showDateModal=!1}removeHour(t){this.horas.removeAt(t)}addHour(){this.horas.push(this.fb.control((new Date).toISOString()))}compareDates(){return t=>{var o,i,s;const m=null===(o=t.get("tratamientoPermanente"))||void 0===o?void 0:o.value,u=new Date(null===(i=t.get("fechaInicio"))||void 0===i?void 0:i.value),p=new Date(null===(s=t.get("fechaFin"))||void 0===s?void 0:s.value);return!m&&u&&p&&u>p?{fechaFinLessThanFechaInicio:!0}:null}}validateDiaSemana(){return t=>{var o,i;const s=null===(o=t.get("recordatorioActivo"))||void 0===o?void 0:o.value,m=null===(i=t.get("diaSemana"))||void 0===i?void 0:i.value;return s&&!m.some(u=>u)?{sinDiaSelecionado:!0}:null}}submitForm(){var t;const o=this.formTratamiento.value,i=o.horas.map(m=>m.split("T")[1].split(".")[0]),s={farmaco:o.farmaco,fechaRegistro:new Date(o.fechaRegistro),cantidad:o.cantidad,unidad:o.unidad,indicaciones:o.indicaciones,padecimiento:o.padecimiento,idPadecimiento:o.idPadecimiento,idUsuarioDoctor:o.idUsuarioDoctor,imagenBase64:(null===(t=this.photo)||void 0===t?void 0:t.base64String)||"",recordatorioActivo:o.recordatorioActivo,diaSemana:o.recordatorioActivo?o.diaSemana:null,horas:o.recordatorioActivo?i:null};this.perfilTratamientoDto=s,this.agregar(this.perfilTratamientoDto),this.router.navigateByUrl("/home/perfil/mis-tratamientos")}agregar(t){return this.perfilTratamientoService.agregar(t).toPromise().then(()=>!0).catch(()=>!1)}}return(n=l).\u0275fac=function(t){return new(t||n)(e.Y36(T.$),e.Y36(c.qu),e.Y36(v),e.Y36(Z.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-agregar-tratamiento"]],standalone:!0,features:[e.jDz],decls:79,vars:30,consts:[[3,"formGroup"],[1,"form-group"],["id","date","readonly","","placeholder","Fecha","label","Fecha","label-placement","floating","fill","outline","shape","round",1,"readonly",3,"value"],["slot","end","name","calendar-outline"],["formControlName","farmaco","placeholder","F\xe1rmaco","label","F\xe1rmaco","label-placement","floating","fill","outline","shape","round"],["formControlName","cantidad","placeholder","Cantidad","label","Cantidad","label-placement","floating","type","number","fill","outline","shape","round"],["formControlName","unidad","placeholder","Unidad","label","Unidad","label-placement","floating","fill","outline","shape","round"],["formControlName","indicaciones","placeholder","Indicaciones","label","Indicaciones","label-placement","floating","fill","outline","shape","round"],["formControlName","idPadecimiento","interface","popover","placeholder","Seleccionar","label","Padecimiento Asociado","label-placement","floating","fill","outline","shape","round"],[3,"value",4,"ngFor","ngForOf"],["formControlName","idUsuarioDoctor","interface","popover","placeholder","Seleccionar","label","Doctor","label-placement","floating","fill","outline","shape","round"],["formControlName","tratamientoPermanente"],["size","6"],["id","date","readonly","","label","Fecha Inicio","label-placement","floating","fill","outline","shape","round",3,"value","click"],["size","6",3,"hidden"],["id","date","readonly","","label","Fecha Fin","label-placement","floating","fill","outline","shape","round",3,"value","click"],[1,"form-group","form-group-camera"],["readonly","",3,"click"],["slot","start","name","camera"],[1,"centered",3,"hidden"],["size","2"],[3,"src"],["formControlName","recordatorioActivo"],[3,"hidden"],["formArrayName","diaSemana"],["class","checkbox-container",4,"ngFor","ngForOf"],["formArrayName","horas"],["class","mt-3",4,"ngFor","ngForOf"],[3,"disabled","click"],["datetime","timeModal","hidden",""],[3,"keepContentsMounted","isOpen","didDismiss"],["datetime","dateModal","hidden",""],[3,"value"],[1,"checkbox-container"],[3,"formControlName"],[1,"checkbox-label"],[1,"mt-3"],["size","auto",1,"form-group","mt-0"],["readonly","","label","Horario(h)","label-placement","floating","fill","outline","shape","round",3,"value","click"],["slot","end","name","time-outline"],["size","auto"],[3,"click",4,"ngIf"],[3,"click"],["name","close-outline"],["name","add-outline"],["id","timeModal","presentation","time","doneText","Confirmar","cancelText","Cancelar",3,"showDefaultButtons","ngModel","ngModelChange"],["id","dateModal","presentation","date","doneText","Confirmar","cancelText","Cancelar",3,"showDefaultButtons","ngModel","ngModelChange"]],template:function(t,o){if(1&t&&(e.TgZ(0,"ion-content")(1,"form",0)(2,"ion-grid")(3,"ion-row")(4,"ion-col")(5,"div",1),e._UZ(6,"ion-input",2),e.ALo(7,"date"),e._UZ(8,"ion-icon",3),e.qZA()(),e.TgZ(9,"ion-col",1),e._UZ(10,"ion-input",4),e.qZA()(),e.TgZ(11,"ion-row")(12,"ion-col",1),e._UZ(13,"ion-input",5),e.qZA(),e.TgZ(14,"ion-col",1),e._UZ(15,"ion-input",6),e.qZA()(),e.TgZ(16,"ion-row")(17,"ion-col",1),e._UZ(18,"ion-input",7),e.qZA()(),e.TgZ(19,"ion-row")(20,"ion-col",1)(21,"ion-select",8),e.YNc(22,A,2,2,"ion-select-option",9),e.ALo(23,"async"),e.qZA()()(),e.TgZ(24,"ion-row")(25,"ion-col",1)(26,"ion-select",10),e.YNc(27,b,2,2,"ion-select-option",9),e.ALo(28,"async"),e.qZA()()(),e.TgZ(29,"ion-row")(30,"ion-col")(31,"ion-toggle",11),e._uU(32,"Tratamiento permanente"),e.qZA()()(),e.TgZ(33,"ion-row")(34,"ion-col",12)(35,"div",1)(36,"ion-input",13),e.NdJ("click",function(){return o.openDateModal("fechaInicio")}),e.ALo(37,"date"),e.qZA(),e._UZ(38,"ion-icon",3),e.qZA()(),e.TgZ(39,"ion-col",14)(40,"div",1)(41,"ion-input",15),e.NdJ("click",function(){return o.openDateModal("fechaFin")}),e.ALo(42,"date"),e.qZA(),e._UZ(43,"ion-icon",3),e.qZA()()(),e.TgZ(44,"ion-row")(45,"ion-col")(46,"div",16)(47,"ion-label"),e._uU(48,"Tomar Fotograf\xeda F\xe1rmaco"),e.qZA(),e.TgZ(49,"ion-input",17),e.NdJ("click",function(){return o.addPhotoToGallery()}),e.qZA(),e._UZ(50,"ion-icon",18),e.qZA()()(),e.TgZ(51,"ion-row",19)(52,"ion-col",20),e._UZ(53,"ion-img",21),e.qZA()(),e.TgZ(54,"ion-row")(55,"ion-col")(56,"ion-toggle",22),e._uU(57,"Activar Recordatorio de tomas"),e.qZA()()(),e.TgZ(58,"div",23)(59,"ion-row")(60,"ion-col")(61,"ion-label"),e._uU(62,"D\xedas de la semana"),e.qZA()()(),e.TgZ(63,"ion-row",24),e.YNc(64,P,4,2,"ion-col",25),e.qZA(),e.TgZ(65,"div",26),e.YNc(66,x,8,6,"ion-row",27),e.qZA()(),e.TgZ(67,"ion-row")(68,"ion-col")(69,"ion-label"),e._uU(70,"Se notificara 15 min. antes de la hora establecida."),e.qZA(),e.TgZ(71,"ion-button",28),e.NdJ("click",function(){return o.submitForm()}),e._uU(72,"Guardar"),e.qZA()()()()(),e._UZ(73,"ion-datetime-button",29),e.TgZ(74,"ion-modal",30),e.NdJ("didDismiss",function(){return o.closeTimeModal()}),e.YNc(75,C,1,2,"ng-template"),e.qZA(),e._UZ(76,"ion-datetime-button",31),e.TgZ(77,"ion-modal",30),e.NdJ("didDismiss",function(){return o.closeDateModal()}),e.YNc(78,w,1,2,"ng-template"),e.qZA()()),2&t){let i,s,m,u,p;e.xp6(1),e.Q6J("formGroup",o.formTratamiento),e.xp6(5),e.Q6J("value",e.xi3(7,17,null==(i=o.formTratamiento.get("fechaRegistro"))?null:i.value,"dd.MM.yyyy")),e.xp6(16),e.Q6J("ngForOf",e.lcZ(23,20,o.padecimientos$)),e.xp6(5),e.Q6J("ngForOf",e.lcZ(28,22,o.doctores$)),e.xp6(9),e.Q6J("value",e.xi3(37,24,null==(s=o.formTratamiento.get("fechaInicio"))?null:s.value,"dd.MM.yyyy")),e.xp6(3),e.Q6J("hidden",null==(m=o.formTratamiento.get("tratamientoPermanente"))?null:m.value),e.xp6(2),e.Q6J("value",e.xi3(42,27,null==(u=o.formTratamiento.get("fechaFin"))?null:u.value,"dd.MM.yyyy")),e.xp6(10),e.Q6J("hidden",!o.photo),e.xp6(2),e.Q6J("src","data:image/jpeg;base64,"+(null==o.photo?null:o.photo.base64String)),e.xp6(5),e.Q6J("hidden",!(null!=(p=o.formTratamiento.get("recordatorioActivo"))&&p.value)),e.xp6(6),e.Q6J("ngForOf",o.weekDays),e.xp6(2),e.Q6J("ngForOf",o.horas.controls),e.xp6(5),e.Q6J("disabled",!o.formTratamiento.valid),e.xp6(3),e.Q6J("keepContentsMounted",!0)("isOpen",o.showTimeModal),e.xp6(3),e.Q6J("keepContentsMounted",!0)("isOpen",o.showDateModal)}},dependencies:[r.Pc,r.YG,r.nz,r.wI,r.W2,r.x4,r.Mj,r.jY,r.gu,r.Xz,r.pK,r.Q$,r.Nd,r.t9,r.n0,r.ho,r.ki,r.w,r.as,r.QI,r.j9,g.ez,g.sg,g.O5,g.Ov,g.uU,c.u5,c._Y,c.JJ,c.JL,c.On,c.UX,c.sg,c.u,c.CE],styles:[".input-fill-outline.input-shape-round[_ngcontent-%COMP%]{--border-color: lightgrey;border:0px}.readonly[_ngcontent-%COMP%]{--background: #e9ecef}.form-group[_ngcontent-%COMP%]{position:relative}.form-group[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{position:absolute;right:20px;top:50%;transform:translateY(-50%);z-index:1002}.form-group-camera[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{--ion-label-padding-top: 0;--ion-label-padding-bottom: 0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center;width:100%}.form-group-camera[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{left:20px}.checkbox-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.checkbox-container[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]{padding-left:5px}.checkbox-container[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]{--checkbox-background-checked: purple}.centered[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}ion-button[_ngcontent-%COMP%]{--color: black;--background: #9BD8AC}"]}),l})()}}]);