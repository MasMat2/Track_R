"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6387],{6387:(Z,m,r)=>{r.r(m),r.d(m,{MisEstudiosFormularioPage:()=>T});var c=r(5861),g=r(6895),l=r(433),p=r(4384),s=r(9149),h=r(458);class b{constructor(){this.nombre="",this.archivoTipoMime="",this.archivoNombre=""}}var v=r(429),e=r(1571),E=r(5697);function M(a,d){1&a&&(e.TgZ(0,"div",20),e._uU(1," El estudio es requerido "),e.qZA())}function x(a,d){1&a&&(e.TgZ(0,"div",20),e._uU(1," El documento es requerido "),e.qZA())}let T=(()=>{var a;class d{constructor(t,i,n,o){this.capacitorUtil=t,this.alertController=i,this.expedienteEstudioService=n,this.router=o,this.files=[],this.isPictureTaken=!1,this.fecha=new Date,this.image_src="",this.mimeType="",this.btnSubmit=!1,this.expedienteEstudio=new b}ngOnInit(){}takePicture(){var t=this;return(0,c.Z)(function*(){t.isPictureTaken=!0,t.image_src=yield t.capacitorUtil.takePicture();const[,i]=t.image_src.split(","),n=t.image_src.split(":")[1].split(";")[0];t.expedienteEstudio.archivo=i,t.expedienteEstudio.archivoTipoMime=n,t.expedienteEstudio.archivoNombre=t.generateFileName()})()}enviarFormulario(t){if(this.btnSubmit=!0,!t.valid)return(0,v.CW)(t),void(this.btnSubmit=!1);this.agregarExpediente()}agregarArchivo(){var t=this;return(0,c.Z)(function*(){t.files=yield t.capacitorUtil.pickFiles(),t.expedienteEstudio.archivo=t.files[0].data,t.expedienteEstudio.archivoTipoMime=t.files[0].mimeType,t.expedienteEstudio.archivoNombre=t.files[0].name})()}generateFileName(){const t=new Date;return`foto_${t.toISOString().split("T")[0]}_${t.getTime()}.${"image/png"===this.mimeType?"png":"jpg"}`}agregarExpediente(){this.expedienteEstudioService.agregarExpediente(this.expedienteEstudio).subscribe({next:()=>{this.presentAlert("El estudio ha sido agregado correctamente"),this.router.navigateByUrl("home/perfil/mis-estudios")},error:()=>{this.btnSubmit=!1}})}presentAlert(t){var i=this;return(0,c.Z)(function*(){yield(yield i.alertController.create({header:"Mis Estudios",message:t,buttons:["OK"]})).present()})()}}return(a=d).\u0275fac=function(t){return new(t||a)(e.Y36(h.Z),e.Y36(s.Br),e.Y36(E.a),e.Y36(p.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-mis-estudios-formulario"]],standalone:!0,features:[e._Bn([h.Z]),e.jDz],decls:32,vars:9,consts:[[1,"container"],["novalidate","novalidate",3,"keydown.enter","ngSubmit"],["formulario","ngForm"],["size","5"],["type","text","readonly","true","label","Fecha","labelPlacement","floating","shape","round","fill","outline",3,"value"],["size","7"],["name","estudioName","type","text","maxlength","200","autocomplete","off","required","","label","Estudio","labelPlacement","floating","shape","round","fill","outline",3,"ngModel","ngModelChange"],["nombre","ngModel"],["class","error",4,"ngIf"],[1,"d-flex","align-items-center"],["type","text","readonly","true","name","ArchivoNombre","required","","label","Documento","labelPlacement","floating","shape","round","fill","outline",3,"ngModel","ngModelChange"],["documento","ngModel"],["size","5",1,"ion-align-self-end"],[1,"label-input","required-label"],["size","small",1,"boton-cargar",3,"click"],["name","document-outline"],[1,""],["fill","outline","size","small",1,"boton-agregar",3,"click"],["name","camera-outline","slot","start"],["type","submit",1,"boton-guardar",3,"disabled"],[1,"error"]],template:function(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"div",0)(1,"form",1,2),e.NdJ("keydown.enter",function(u){return u.preventDefault()})("ngSubmit",function(){e.CHM(n);const u=e.MAs(2);return e.KtG(i.enviarFormulario(u))}),e.TgZ(3,"ion-grid")(4,"ion-row")(5,"ion-col",3),e._UZ(6,"ion-input",4),e.ALo(7,"date"),e.qZA(),e.TgZ(8,"ion-col",5)(9,"div")(10,"ion-input",6,7),e.NdJ("ngModelChange",function(u){return i.expedienteEstudio.nombre=u}),e.qZA(),e.YNc(12,M,2,0,"div",8),e.qZA()()(),e.TgZ(13,"ion-row",9)(14,"ion-col",5)(15,"ion-input",10,11),e.NdJ("ngModelChange",function(u){return i.expedienteEstudio.archivoNombre=u}),e.qZA(),e.YNc(17,x,2,0,"div",8),e.qZA(),e.TgZ(18,"ion-col",12)(19,"label",13),e._uU(20,"\xa0"),e.qZA(),e.TgZ(21,"ion-button",14),e.NdJ("click",function(){return i.agregarArchivo()}),e._uU(22,"Cargar "),e._UZ(23,"br")(24,"ion-icon",15),e.qZA(),e.TgZ(25,"label",16),e._uU(26,"\xa0"),e.qZA()()(),e.TgZ(27,"ion-button",17),e.NdJ("click",function(){return i.takePicture()}),e._UZ(28,"ion-icon",18),e._uU(29," Tomar fotografia "),e.qZA(),e.TgZ(30,"ion-button",19),e._uU(31,"Guardar"),e.qZA()()()()}if(2&t){const n=e.MAs(11),o=e.MAs(16);e.xp6(6),e.Q6J("value",e.xi3(7,6,i.fecha,"dd/MM/yyyy")),e.xp6(4),e.Q6J("ngModel",i.expedienteEstudio.nombre),e.xp6(2),e.Q6J("ngIf",(null==n.errors?null:n.errors.required)&&n.touched),e.xp6(3),e.Q6J("ngModel",i.expedienteEstudio.archivoNombre),e.xp6(2),e.Q6J("ngIf",(null==o.errors?null:o.errors.required)&&o.touched),e.xp6(13),e.Q6J("disabled",i.btnSubmit)}},dependencies:[s.Pc,s.YG,s.wI,s.jY,s.gu,s.pK,s.Nd,s.j9,l.u5,l._Y,l.JJ,l.JL,l.Q7,l.nD,l.On,l.F,g.ez,g.O5,g.uU,p.Bz],styles:[".container[_ngcontent-%COMP%]{box-shadow:3px 3px 3px 1px #0003;border-radius:10px;margin-left:5px;margin-right:5px}ion-input[_ngcontent-%COMP%]{border:0px}ion-button[_ngcontent-%COMP%]{font-weight:500}.boton-agregar[_ngcontent-%COMP%]{--color: black;--border-color: #9BD8AC}.boton-guardar[_ngcontent-%COMP%]{margin-top:5vh;margin-bottom:5vh;--color: black;--background: #9BD8AC}.boton-cargar[_ngcontent-%COMP%]{--color: black;--background: #9ED1FE}ion-row[_ngcontent-%COMP%]{align-items:center}"]}),d})()}}]);