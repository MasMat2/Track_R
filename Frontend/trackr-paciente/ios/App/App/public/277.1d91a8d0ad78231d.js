"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[277],{76:(x,_,c)=>{c.d(_,{GW:()=>g,dk:()=>d,oK:()=>m});var m=(()=>{return(a=m||(m={})).Prompt="PROMPT",a.Camera="CAMERA",a.Photos="PHOTOS",m;var a})(),g=(()=>{return(a=g||(g={})).Rear="REAR",a.Front="FRONT",g;var a})(),d=(()=>{return(a=d||(d={})).Uri="uri",a.Base64="base64",a.DataUrl="dataUrl",d;var a})()},277:(x,_,c)=>{c.r(_),c.d(_,{AgregarTratamientoPage:()=>rt});var m=c(5861),g=c(6895),d=c(433),a=c(12),h=c(2583),f=c(7126),t=c(1571),T=c(529);let v=(()=>{var i;class l{constructor(e){this.http=e,this.dataUrl="unidadMedida/"}consultarParaFormulario(e){return this.http.get(this.dataUrl+`formulario/${e}`)}consultarParaGrid(){return this.http.get(this.dataUrl+"grid")}agregar(e){return console.log(e),this.http.post(this.dataUrl,e)}editar(e){return this.http.put(this.dataUrl,e)}eliminar(e){return this.http.delete(this.dataUrl+`${e}`)}}return(i=l).\u0275fac=function(e){return new(e||i)(t.LFG(T.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),l})();var S=c(281),y=c(9134),w=c(6203),D=c(1814);function F(i,l){1&i&&(t.TgZ(0,"div",49),t._UZ(1,"ion-icon",50),t._uU(2," El f\xe1rmaco es requerido "),t.qZA())}function k(i,l){1&i&&(t.TgZ(0,"div",49),t._UZ(1,"ion-icon",50),t._uU(2," La cantidad es requerida "),t.qZA())}function I(i,l){if(1&i&&(t.TgZ(0,"ion-select-option",51),t._uU(1),t.qZA()),2&i){const n=l.$implicit;t.Q6J("value",n.nombre),t.xp6(1),t.hij(" ",n.nombre," ")}}function q(i,l){1&i&&(t.TgZ(0,"div",49),t._UZ(1,"ion-icon",50),t._uU(2," La unidad es requerida "),t.qZA())}function N(i,l){1&i&&(t.TgZ(0,"div",49),t._UZ(1,"ion-icon",50),t._uU(2," La indicaci\xf3n es requerida "),t.qZA())}function E(i,l){if(1&i&&(t.TgZ(0,"ion-select-option",51),t._uU(1),t.qZA()),2&i){const n=l.$implicit;t.Q6J("value",n.idPadecimiento),t.xp6(1),t.hij(" ",n.nombre," ")}}function J(i,l){1&i&&(t.TgZ(0,"div",49),t._UZ(1,"ion-icon",50),t._uU(2," El padecimiento es requerido "),t.qZA())}function Q(i,l){if(1&i&&(t.TgZ(0,"ion-select-option",51),t._uU(1),t.qZA()),2&i){const n=l.$implicit;t.Q6J("value",n.idUsuarioDoctor),t.xp6(1),t.hij(" ",n.nombre," ")}}function Y(i,l){1&i&&(t.TgZ(0,"div",49),t._UZ(1,"ion-icon",50),t._uU(2," El doctor es requerido "),t.qZA())}function z(i,l){1&i&&t._UZ(0,"ion-datetime",52)}function j(i,l){1&i&&(t.TgZ(0,"div",49),t._UZ(1,"ion-icon",50),t._uU(2," La fecha de inicio no puede ser mayor a la fecha de fin "),t.qZA())}function H(i,l){1&i&&t._UZ(0,"ion-datetime",56)}function G(i,l){if(1&i&&(t.TgZ(0,"ion-row")(1,"ion-col",13)(2,"div",19)(3,"ion-label"),t._uU(4,"Fecha de fin"),t.qZA(),t.TgZ(5,"ion-item",37),t._UZ(6,"ion-datetime-button",53)(7,"ion-icon",54),t.qZA(),t.YNc(8,j,3,0,"div",17),t.TgZ(9,"ion-modal",55),t.YNc(10,H,1,0,"ng-template"),t.qZA()()()()),2&i){const n=t.oxw(2);let e;t.xp6(8),t.Q6J("ngIf",n.formTratamiento.hasError("fechaFinLessThanFechaInicio")&&((null==(e=n.formTratamiento.get("fechaFin"))?null:e.dirty)||(null==(e=n.formTratamiento.get("fechaFin"))?null:e.touched))),t.xp6(1),t.Q6J("keepContentsMounted",!0)}}function K(i,l){1&i&&(t.TgZ(0,"ion-label"),t._uU(1," Fijar recordatorio "),t.qZA())}function R(i,l){1&i&&(t.TgZ(0,"ion-label"),t._uU(1," Editar recordatorio "),t.qZA())}const C=function(i){return{selected:i}};function $(i,l){if(1&i){const n=t.EpF();t.TgZ(0,"ion-button",73),t.NdJ("click",function(){const r=t.CHM(n).index,s=t.oxw(3);return t.KtG(s.seleccionarDiaRecordatorio(r))}),t._uU(1),t.qZA()}if(2&i){const n=l.$implicit,e=l.index,o=t.oxw(3);t.Q6J("ngClass",t.VKq(2,C,o.esDiaSemanaSeleccionado(e))),t.xp6(1),t.hij(" ",n.name," ")}}const L=function(){return{standalone:!0}};function B(i,l){if(1&i){const n=t.EpF();t.TgZ(0,"ion-datetime",74),t.NdJ("ngModelChange",function(o){t.CHM(n);const r=t.oxw(3);return t.KtG(r.fechaSeleccionada=o)}),t.qZA()}if(2&i){const n=t.oxw(3);t.Q6J("ngModel",n.fechaSeleccionada)("ngModelOptions",t.DdM(2,L))}}function V(i,l){if(1&i&&t._UZ(0,"ion-datetime",80),2&i){const n=t.oxw(),e=n.index,o=n.$implicit;t.s9C("formControlName",e),t.Q6J("value",null==o?null:o.value)("name","horaName"+e)("id","hora"+e)}}function W(i,l){if(1&i){const n=t.EpF();t.TgZ(0,"ion-button",81),t.NdJ("click",function(){t.CHM(n);const o=t.oxw().index,r=t.oxw(3);return t.KtG(r.removeHour(o))}),t._UZ(1,"ion-icon",82),t.qZA()}}function X(i,l){if(1&i&&(t.TgZ(0,"ion-row")(1,"ion-col")(2,"div",19)(3,"ion-label"),t._uU(4),t.qZA(),t.TgZ(5,"ion-item",75),t._UZ(6,"ion-datetime-button",76)(7,"ion-icon",77),t.qZA(),t.TgZ(8,"ion-modal",78),t.YNc(9,V,1,4,"ng-template"),t.qZA()()(),t.TgZ(10,"ion-col",68)(11,"div",69),t.YNc(12,W,2,0,"ion-button",79),t.qZA()()()),2&i){const n=l.index;t.xp6(4),t.hij("Horario ",n+1,""),t.xp6(2),t.Q6J("datetime","hora"+n),t.xp6(2),t.Q6J("keepContentsMounted",!0),t.xp6(4),t.Q6J("ngIf",!0)}}function tt(i,l){if(1&i){const n=t.EpF();t.TgZ(0,"ion-header",57)(1,"ion-toolbar")(2,"ion-buttons",58)(3,"ion-button",3),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2);return t.KtG(o.setOpenModalRecordatorio(!1))}),t._UZ(4,"ion-icon",59),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6,"Fijar recordatorio"),t.qZA()()(),t.TgZ(7,"ion-content",60)(8,"div",61)(9,"ion-grid",12)(10,"ion-row")(11,"ion-col",13)(12,"div",62),t.YNc(13,$,2,4,"ion-button",63),t.qZA()()(),t.TgZ(14,"div",64)(15,"ion-row")(16,"ion-col")(17,"div",19)(18,"ion-label"),t._uU(19,"Definir hora"),t.qZA(),t.TgZ(20,"ion-item",37),t._UZ(21,"ion-datetime-button",65)(22,"ion-icon",66),t.qZA(),t.TgZ(23,"ion-modal",67),t.YNc(24,B,1,3,"ng-template"),t.qZA()()(),t.TgZ(25,"ion-col",68)(26,"div",69)(27,"ion-button",70),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2);return t.KtG(o.addHour())}),t._UZ(28,"ion-icon",25),t.qZA()()()(),t.TgZ(29,"ion-row")(30,"ion-col",13)(31,"ion-text")(32,"p"),t._uU(33,"Se notificar\xe1 15 minutos antes de la hora establecida."),t.qZA()()()()(),t.TgZ(34,"div",71),t.YNc(35,X,13,4,"ion-row",72),t.qZA()()()()}if(2&i){const n=t.oxw(2);t.xp6(13),t.Q6J("ngForOf",n.weekDays),t.xp6(10),t.Q6J("keepContentsMounted",!0),t.xp6(4),t.Q6J("disabled",!n.hayDiaSeleccionado()),t.xp6(8),t.Q6J("ngForOf",n.horas.controls)}}function et(i,l){if(1&i){const n=t.EpF();t.TgZ(0,"ion-item",83),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2);return t.KtG(o.takePicture())}),t.TgZ(1,"ion-label"),t._uU(2,"Adjuntar imagen"),t.qZA(),t._UZ(3,"ion-icon",84),t.qZA()}}function nt(i,l){if(1&i){const n=t.EpF();t.TgZ(0,"div",85)(1,"div",86),t._UZ(2,"ion-img",87),t.TgZ(3,"div",88)(4,"ion-text")(5,"p"),t._uU(6),t.qZA()(),t.TgZ(7,"ion-button",3),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2);return t.KtG(o.eliminarAdjunto())}),t._UZ(8,"ion-icon",89),t.qZA()()()()}if(2&i){const n=t.oxw(2);t.xp6(2),t.Q6J("src","data:image/png;base64,"+n.archivo),t.xp6(4),t.Oqu(n.archivoNombre)}}const O=function(){return{cssClass:"custom-select-action-sheet"}},ot=function(i){return{activated:i}};function it(i,l){if(1&i){const n=t.EpF();t.TgZ(0,"div",7)(1,"div",8)(2,"ion-text")(3,"h3"),t._uU(4),t.qZA()()(),t.TgZ(5,"div",9)(6,"form",10)(7,"div",11)(8,"ion-grid",12)(9,"ion-row")(10,"ion-col",13)(11,"div",14)(12,"ion-label"),t._uU(13,"F\xe1rmaco"),t.qZA(),t.TgZ(14,"ion-item",15),t._UZ(15,"ion-input",16),t.qZA(),t.YNc(16,F,3,0,"div",17),t.qZA()()(),t.TgZ(17,"ion-row")(18,"ion-col",18)(19,"div",19)(20,"ion-label"),t._uU(21,"Cantidad"),t.qZA(),t.TgZ(22,"ion-item",20)(23,"ion-button",21),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.decrementarCantidad())}),t._UZ(24,"ion-icon",22),t.qZA(),t.TgZ(25,"ion-input",23),t.NdJ("ngModelChange",function(o){t.CHM(n);const r=t.oxw();return t.KtG(r.cantidadFarmaco=o)}),t.qZA(),t.TgZ(26,"ion-button",24),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.incrementarCantidad())}),t._UZ(27,"ion-icon",25),t.qZA()(),t.YNc(28,k,3,0,"div",17),t.qZA()(),t.TgZ(29,"ion-col",26)(30,"div",19)(31,"ion-label"),t._uU(32,"Unidad"),t.qZA(),t.TgZ(33,"ion-item",27)(34,"ion-select",28),t.YNc(35,I,2,2,"ion-select-option",29),t.qZA()(),t.YNc(36,q,3,0,"div",17),t.qZA()()(),t.TgZ(37,"ion-row")(38,"ion-col",13)(39,"div",19)(40,"ion-label"),t._uU(41,"Indicaciones"),t.qZA(),t.TgZ(42,"ion-item",30),t._UZ(43,"ion-textarea",31),t.qZA(),t.YNc(44,N,3,0,"div",17),t.qZA()()(),t.TgZ(45,"ion-row")(46,"ion-col",13)(47,"div",19)(48,"ion-label"),t._uU(49,"Padecimiento asociado"),t.qZA(),t.TgZ(50,"ion-item",27)(51,"ion-select",32),t.YNc(52,E,2,2,"ion-select-option",29),t.qZA()(),t.YNc(53,J,3,0,"div",17),t.qZA()()(),t.TgZ(54,"ion-row")(55,"ion-col",13)(56,"div",19)(57,"ion-label"),t._uU(58,"Doctor"),t.qZA(),t.TgZ(59,"ion-item",27)(60,"ion-select",33),t.YNc(61,Q,2,2,"ion-select-option",29),t.qZA()(),t.YNc(62,Y,3,0,"div",17),t.qZA()()(),t.TgZ(63,"ion-row")(64,"div",19)(65,"ion-label"),t._uU(66,"Duracion del tratamiento"),t.qZA()(),t.TgZ(67,"ion-col",34)(68,"ion-button",35),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.seleccionarTratamientoPermanente(!0))}),t._uU(69," Tratamiento permanente "),t.qZA()(),t.TgZ(70,"ion-col",34)(71,"ion-button",36),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.seleccionarTratamientoPermanente(!1))}),t._uU(72," Tratamiento no permanente "),t.qZA()()(),t.TgZ(73,"ion-row")(74,"ion-col",13)(75,"div",19)(76,"ion-label"),t._uU(77,"Fecha de inicio"),t.qZA(),t.TgZ(78,"ion-item",37),t._UZ(79,"ion-datetime-button",38)(80,"ion-icon",39),t.qZA(),t.TgZ(81,"ion-modal",40),t.YNc(82,z,1,0,"ng-template"),t.qZA()()()(),t.YNc(83,G,11,2,"ion-row",41),t.TgZ(84,"ion-row")(85,"ion-col",13)(86,"ion-item",42),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.setOpenModalRecordatorio(!0))}),t.YNc(87,K,2,0,"ion-label",41),t.YNc(88,R,2,0,"ion-label",41),t._UZ(89,"ion-icon",43),t.qZA(),t.TgZ(90,"ion-modal",44),t.YNc(91,tt,36,4,"ng-template"),t.qZA()()(),t.TgZ(92,"ion-row")(93,"ion-col",13),t.YNc(94,et,4,0,"ion-item",45),t.YNc(95,nt,9,2,"div",46),t.qZA()()()(),t.TgZ(96,"div",47)(97,"ion-button",48),t.NdJ("click",function(){t.CHM(n);const o=t.oxw();return t.KtG(o.submitForm())}),t._uU(98," Guardar "),t.qZA()()()()()}if(2&i){const n=t.oxw();let e,o,r,s,u,p,P,M,b,Z,A,U;t.xp6(4),t.hij("",n.tituloAccion," tratamiento"),t.xp6(2),t.Q6J("formGroup",n.formTratamiento),t.xp6(10),t.Q6J("ngIf",(null==(e=n.formTratamiento.get("farmaco"))?null:e.hasError("required"))&&((null==(e=n.formTratamiento.get("farmaco"))?null:e.dirty)||(null==(e=n.formTratamiento.get("farmaco"))?null:e.touched))),t.xp6(9),t.Q6J("ngModel",n.cantidadFarmaco),t.xp6(3),t.Q6J("ngIf",(null==(o=n.formTratamiento.get("cantidad"))?null:o.hasError("required"))&&((null==(o=n.formTratamiento.get("cantidad"))?null:o.dirty)||(null==(o=n.formTratamiento.get("cantidad"))?null:o.touched))),t.xp6(6),t.Q6J("interfaceOptions",t.DdM(26,O)),t.xp6(1),t.Q6J("ngForOf",n.unidades),t.xp6(1),t.Q6J("ngIf",(null==(r=n.formTratamiento.get("unidad"))?null:r.hasError("required"))&&((null==(r=n.formTratamiento.get("unidad"))?null:r.dirty)||(null==(r=n.formTratamiento.get("unidad"))?null:r.touched))),t.xp6(8),t.Q6J("ngIf",(null==(s=n.formTratamiento.get("indicaciones"))?null:s.hasError("required"))&&((null==(s=n.formTratamiento.get("indicaciones"))?null:s.dirty)||(null==(s=n.formTratamiento.get("indicaciones"))?null:s.touched))),t.xp6(7),t.Q6J("interfaceOptions",t.DdM(27,O)),t.xp6(1),t.Q6J("ngForOf",n.padecimientosSelector),t.xp6(1),t.Q6J("ngIf",(null==(u=n.formTratamiento.get("idPadecimiento"))?null:u.hasError("required"))&&((null==(u=n.formTratamiento.get("idPadecimiento"))?null:u.dirty)||(null==(u=n.formTratamiento.get("idPadecimiento"))?null:u.touched))),t.xp6(7),t.Q6J("interfaceOptions",t.DdM(28,O)),t.xp6(1),t.Q6J("ngForOf",n.doctoresSelector),t.xp6(1),t.Q6J("ngIf",(null==(p=n.formTratamiento.get("idUsuarioDoctor"))?null:p.hasError("required"))&&((null==(p=n.formTratamiento.get("idUsuarioDoctor"))?null:p.dirty)||(null==(p=n.formTratamiento.get("idUsuarioDoctor"))?null:p.touched))),t.xp6(6),t.Q6J("ngClass",t.VKq(29,C,null==(P=n.formTratamiento.get("tratamientoPermanente"))?null:P.value)),t.xp6(3),t.Q6J("ngClass",t.VKq(31,C,!(null!=(M=n.formTratamiento.get("tratamientoPermanente"))&&M.value))),t.xp6(10),t.Q6J("keepContentsMounted",!0),t.xp6(2),t.Q6J("ngIf",!(null!=(b=n.formTratamiento.get("tratamientoPermanente"))&&b.value)),t.xp6(3),t.Q6J("ngClass",t.VKq(33,ot,null==(Z=n.formTratamiento.get("recordatorioActivo"))?null:Z.value)),t.xp6(1),t.Q6J("ngIf",!(null!=(A=n.formTratamiento.get("recordatorioActivo"))&&A.value)),t.xp6(1),t.Q6J("ngIf",null==(U=n.formTratamiento.get("recordatorioActivo"))?null:U.value),t.xp6(2),t.Q6J("isOpen",n.isModalRecordatorioOpen),t.xp6(4),t.Q6J("ngIf",!n.archivo),t.xp6(1),t.Q6J("ngIf",n.archivo),t.xp6(2),t.Q6J("disabled",!n.formTratamiento.valid||n.btnSubmit||!n.formTratamiento.dirty&&!n.isFormModified)}}let rt=(()=>{var i;class l{constructor(e,o,r,s,u,p,P,M){this.perfilTratamientoService=e,this.doctoresService=o,this.expedientePadecimientoService=r,this.fb=s,this._modalCtrl=u,this.alertController=p,this.capacitorUtils=P,this.unidadMedidaService=M,this.now=new Date,this.localOffset=6e4*this.now.getTimezoneOffset(),this.localISOTime=new Date(this.now.getTime()-this.localOffset).toISOString().slice(0,-1),this.dateToday=this.localISOTime,this.isFormModified=!1,this.cantidadFarmaco=1,this.isModalRecordatorioOpen=!1,this.btnSubmit=!1,this.fechaSeleccionada=this.dateToday,this.isPictureTaken=!1,this.mimeType="",this.tituloAccion="Agregar",this.weekDays=[{id:0,name:"L"},{id:1,name:"M"},{id:2,name:"M"},{id:3,name:"J"},{id:4,name:"V"},{id:5,name:"S"},{id:6,name:"D"}],(0,h.a)({"chevron-left":"assets/img/svg/chevron-left.svg","chevron-right":"assets/img/svg/chevron-right.svg","chevron-up":"assets/img/svg/chevron-up.svg","chevron-down":"assets/img/svg/chevron-down.svg",calendar:"assets/img/svg/calendar.svg",clock:"assets/img/svg/clock-2.svg",info:"assets/img/svg/info.svg",camera:"assets/img/svg/camera.svg",minus:"assets/img/svg/minus.svg",plus:"assets/img/svg/plus.svg",x:"assets/img/svg/x.svg","trash-2":"assets/img/svg/trash-2.svg"})}ngOnInit(){this.formTratamiento=this.fb.group({farmaco:["",d.kI.required],cantidad:["1",d.kI.required],unidad:["",d.kI.required],indicaciones:["",d.kI.required],idPadecimiento:["",d.kI.required],idUsuarioDoctor:["",d.kI.required],tratamientoPermanente:[!1],fechaInicio:[(new Date).toISOString(),d.kI.required],fechaFin:[(new Date).toISOString()],recordatorioActivo:[!1],diaSemana:this.fb.array([!1,!1,!1,!1,!1,!1,!1]),horas:this.fb.array([])},{validators:[this.validateDiaSemana(),this.compareDates()]}),this.consutarUnidadesMedida(),this.selectorPadecimientos(),this.selectorDoctor(),this.verificarAccionFormulario()}verificarAccionFormulario(){"editar"==this.accion?(this.tituloAccion="Editar",this.rellenarValoresEditar()):this.tituloAccion="A\xf1adir"}consutarUnidadesMedida(){this.unidadMedidaService.consultarParaGrid().subscribe({next:e=>{this.unidades=e}})}rellenarValoresEditar(){this.formTratamiento.patchValue({farmaco:this.perfilTratamientoDto.farmaco,cantidad:this.perfilTratamientoDto.cantidad,unidad:this.perfilTratamientoDto.unidad,indicaciones:this.perfilTratamientoDto.indicaciones,idPadecimiento:this.perfilTratamientoDto.idPadecimiento,idUsuarioDoctor:this.perfilTratamientoDto.idUsuarioDoctor,tratamientoPermanente:null==this.perfilTratamientoDto.fechaFin,fechaInicio:this.perfilTratamientoDto.fechaInicio,fechaFin:this.perfilTratamientoDto.fechaFin,imagenBase64:this.perfilTratamientoDto.imagenBase64,recordatorioActivo:this.perfilTratamientoDto.recordatorioActivo}),this.formTratamiento.get("diaSemana").patchValue(this.perfilTratamientoDto.diaSemana);const o=this.formTratamiento.get("horas");o.clear(),this.perfilTratamientoDto.horas.forEach(r=>{const s=this.formatearHoraAFechaLocal(r);o.push(new d.NI(s))}),""!=this.perfilTratamientoDto.imagenBase64&&(this.archivo=`${this.perfilTratamientoDto.imagenBase64}`),this.archivoNombre=this.perfilTratamientoDto.archivoNombre,this.archivoTipoMime=this.perfilTratamientoDto.archivoTipoMime,this.cantidadFarmaco=this.perfilTratamientoDto.cantidad}get horas(){return this.formTratamiento.get("horas")}formatearHoraAFechaLocal(e){const o=this.dateToday.split("T")[0];return new Date(new Date(`${o}T${e}`).getTime()-this.localOffset).toISOString().slice(0,-1)}selectorPadecimientos(){this.expedientePadecimientoService.consultarPorUsuarioParaSelector().subscribe({next:e=>{this.padecimientosSelector=e}})}selectorDoctor(){this.doctoresService.consultarPorUsuarioParaSelector().subscribe({next:e=>{this.doctoresSelector=e}})}takePicture(){var e=this;return(0,m.Z)(function*(){const o=yield e.capacitorUtils.takePicture(),[,r]=o.split(","),s=o.split(":")[1].split(";")[0];e.archivo=r,e.archivoTipoMime=s,e.archivoNombre=e.generateFileName(),e.isPictureTaken=!0,e.isFormModified=!0})()}removeHour(e){this.isFormModified=!0,this.horas.removeAt(e),0===this.horas.length&&this.formTratamiento.patchValue({recordatorioActivo:!1})}addHour(){this.isFormModified=!0,0===this.horas.length&&this.formTratamiento.patchValue({recordatorioActivo:!0});const e=this.fechaSeleccionada;this.validarHoraRepetida(e,this.horas.value)||this.horas.push(this.fb.control(e)),this.fechaSeleccionada=this.dateToday}validarHoraRepetida(e,o){const r=e.substring(11,16);return o.some(u=>u.substring(11,16)===r)}compareDates(){return e=>{var o,r,s;const u=null===(o=e.get("tratamientoPermanente"))||void 0===o?void 0:o.value,p=new Date(null===(r=e.get("fechaInicio"))||void 0===r?void 0:r.value),P=new Date(null===(s=e.get("fechaFin"))||void 0===s?void 0:s.value);return!u&&p&&P&&p>P?{fechaFinLessThanFechaInicio:!0}:null}}validateDiaSemana(){return e=>{var o,r;const s=null===(o=e.get("recordatorioActivo"))||void 0===o?void 0:o.value,u=null===(r=e.get("diaSemana"))||void 0===r?void 0:r.value;return s&&!u.some(p=>p)?{sinDiaSelecionado:!0}:null}}submitForm(){var e;this.btnSubmit=!0;const o=this.formTratamiento.value,r=o.horas.map(u=>u.split("T")[1].split(".")[0]),s={idExpedienteTratamiento:null===(e=this.perfilTratamientoDto)||void 0===e?void 0:e.idExpedienteTratamiento,farmaco:o.farmaco,fechaInicio:new Date(o.fechaInicio),fechaFin:o.tratamientoPermanente?void 0:new Date(o.fechaFin),cantidad:o.cantidad,unidad:o.unidad,indicaciones:o.indicaciones,padecimiento:o.padecimiento,idPadecimiento:o.idPadecimiento,idUsuarioDoctor:o.idUsuarioDoctor,imagenBase64:"",archivo:this.archivo,archivoNombre:this.archivoNombre,archivoTipoMime:this.archivoTipoMime,recordatorioActivo:o.recordatorioActivo,diaSemana:o.recordatorioActivo?o.diaSemana:null,horas:o.recordatorioActivo?r:null};this.perfilTratamientoDto=s,"editar"==this.accion?this.editar(this.perfilTratamientoDto):this.agregar(this.perfilTratamientoDto)}agregar(e){this.perfilTratamientoService.agregar(e).subscribe({next:()=>{},error:()=>{this.btnSubmit=!1},complete:()=>{this.btnSubmit=!1,this.presentarAlertaSuccess("agregado")}})}editar(e){this.perfilTratamientoService.editarTratamiento(e).subscribe({next:()=>{},error:()=>{this.btnSubmit=!1},complete:()=>{this.btnSubmit=!1,this.presentarAlertaSuccess("editado")}})}seleccionarTratamientoPermanente(e){this.formTratamiento.patchValue({tratamientoPermanente:e})}incrementarCantidad(){this.isFormModified=!0,this.cantidadFarmaco<99&&(this.cantidadFarmaco+=1,this.formTratamiento.patchValue({cantidad:this.cantidadFarmaco}))}decrementarCantidad(){this.isFormModified=!0,this.cantidadFarmaco>0&&(this.cantidadFarmaco-=1,this.formTratamiento.patchValue({cantidad:this.cantidadFarmaco}))}esDiaSemanaSeleccionado(e){return this.formTratamiento.get("diaSemana").at(e).value}seleccionarDiaRecordatorio(e){const r=this.formTratamiento.get("diaSemana").at(e);r.patchValue(!r.value)}hayDiaSeleccionado(){return-1!==this.formTratamiento.get("diaSemana").value.indexOf(!0)}hayHoraRepetida(){}eliminarAdjunto(){this.archivo=void 0,this.archivoNombre="",this.archivoTipoMime="",this.isFormModified=!0}presentarAlertaSuccess(e){var o=this;return(0,m.Z)(function*(){yield(yield o.alertController.create({header:`Tratamiento ${e} exitosamente`,buttons:[{text:"De acuerdo",role:"confirm",handler:()=>{o.cerrarModal("confirm")}}],cssClass:"custom-alert color-primary icon-check"})).present()})()}cerrarModal(e){this._modalCtrl.dismiss(null,e)}setOpenModalRecordatorio(e){this.isModalRecordatorioOpen=e}generateFileName(){const e=new Date;return`TrackrImage_${e.toISOString().split("T")[0]}_${e.getTime()}.${"image/png"===this.mimeType?"png":"jpg"}`}}return(i=l).\u0275fac=function(e){return new(e||i)(t.Y36(S.$),t.Y36(y.q),t.Y36(w.n),t.Y36(d.qu),t.Y36(D.IN),t.Y36(a.Br),t.Y36(f.Z),t.Y36(v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-agregar-tratamiento"]],standalone:!0,features:[t._Bn([f.Z,v]),t.jDz],decls:10,vars:1,consts:[[1,"ion-no-border"],[1,"contenedor-header-light"],["slot","start",1,"start"],[3,"click"],["slot","start","name","chevron-left"],[1,"primary"],["class","contenedor-principal",4,"ngIf"],[1,"contenedor-principal"],[1,"titulo"],[1,"formulario"],[3,"formGroup"],[1,"contenido-formulario"],[1,"inputs","ion-no-padding"],["size","12"],[1,"input","first-input"],["lines","none",1,"general-input"],["id","nombreEstudio","name","nombreEstudio","type","text","maxlength","200","required","","autocomplete","off","formControlName","farmaco"],["class","input-text-error",4,"ngIf"],["size","6",1,"padding-derecho"],[1,"input"],["lines","none",1,"quantity-selector"],["id","decrementar",3,"click"],["slot","icon-only","name","minus"],["type","number","formControlName","cantidad",3,"ngModel","ngModelChange"],["id","incrementar",3,"click"],["slot","icon-only","name","plus"],["size","6",1,"padding-izquierdo"],["lines","none",1,"select-input"],["id","unidad","name","unidadName","interface","action-sheet","cancelText","Cancelar","placeholder","Seleccionar","toggleIcon","chevron-down","formControlName","unidad",3,"interfaceOptions"],[3,"value",4,"ngFor","ngForOf"],["lines","none",1,"textarea-input"],["maxlength","500","rows","8","autoGrow","","placeholder","Escriba aqu\xed indicaciones que le de su m\xe9dico de confianza.","formControlName","indicaciones"],["id","padecimiento","name","padecimientoName","interface","action-sheet","cancelText","Cancelar","placeholder","Seleccionar","toggleIcon","chevron-down","formControlName","idPadecimiento",3,"interfaceOptions"],["id","doctor","name","doctorName","interface","action-sheet","cancelText","Cancelar","placeholder","Seleccionar","toggleIcon","chevron-down","formControlName","idUsuarioDoctor",3,"interfaceOptions"],["size","6"],[1,"selection-button","padding-derecho",3,"ngClass","click"],[1,"selection-button","padding-izquierdo",3,"ngClass","click"],["lines","none",1,"date-input"],["datetime","fechaInicio"],["name","calendar","slot","end","id","fechaInicioIcon"],["trigger","fechaInicioIcon",3,"keepContentsMounted"],[4,"ngIf"],["lines","none","button","",1,"action-button-item",3,"ngClass","click"],["slot","end","name","chevron-right"],[3,"isOpen"],["lines","none","button","","class","action-button-item",3,"click",4,"ngIf"],["class","adjuntar-elemento",4,"ngIf"],[1,"botones","botones-column"],[1,"dark",3,"disabled","click"],[1,"input-text-error"],["slot","start","name","info"],[3,"value"],["presentation","date","color","morado-custom","name","fechaInicio","id","fechaInicio","showDefaultButtons","true","cancelText","Cancelar","doneText","Ok","locale","es-ES","formControlName","fechaInicio"],["datetime","fechaFin"],["name","calendar","id","fechaFinIcon","slot","end"],["trigger","fechaFinIcon",3,"keepContentsMounted"],["presentation","date","color","morado-custom","name","fechaFin","id","fechaFin","showDefaultButtons","true","cancelText","Cancelar","doneText","Ok","locale","es-ES","formControlName","fechaFin"],[1,"ion-no-border","header-modal"],["slot","start"],["name","x"],[1,"neutral"],[1,"contenedor-principal-modal"],[1,"selector-dias"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"selector-hora"],["datetime","selectorHora"],["id","selectorHoraIcon","name","clock","slot","end"],["trigger","selectorHoraIcon",3,"keepContentsMounted"],["size","auto"],[1,"boton-agregar-eliminar"],[1,"agregar",3,"disabled","click"],["formArrayName","horas",1,"horas-seleccionadas"],[4,"ngFor","ngForOf"],[3,"ngClass","click"],["presentation","time","color","morado-custom","name","selectorHoraName","id","selectorHora","showDefaultButtons","true","cancelText","Cancelar","doneText","Ok","locale","es-ES",3,"ngModel","ngModelOptions","ngModelChange"],["lines","none",1,"date-input","input-disabled"],["disabled","",3,"datetime"],["name","clock","slot","end","aria-hidden","true"],[3,"keepContentsMounted"],["class","eliminar",3,"click",4,"ngIf"],["presentation","time","color","morado-custom","showDefaultButtons","true","locale","es-ES","readonly","",3,"value","name","id","formControlName"],[1,"eliminar",3,"click"],["slot","icon-only","name","x"],["lines","none","button","",1,"action-button-item",3,"click"],["slot","end","name","camera"],[1,"adjuntar-elemento"],[1,"previsualizacion"],[3,"src"],[1,"datos-archivo"],["slot","icon-only","name","trash-2"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header",0)(1,"div",1)(2,"ion-toolbar")(3,"ion-buttons",2)(4,"ion-button",3),t.NdJ("click",function(){return o.cerrarModal("cancel")}),t._UZ(5,"ion-icon",4),t.TgZ(6,"ion-label"),t._uU(7,"Atr\xe1s"),t.qZA()()()()()(),t.TgZ(8,"ion-content",5),t.YNc(9,it,99,35,"div",6),t.qZA()),2&e&&(t.xp6(9),t.Q6J("ngIf",!0))},dependencies:[a.Pc,a.YG,a.Sm,a.wI,a.W2,a.x4,a.Mj,a.jY,a.Gu,a.gu,a.Xz,a.pK,a.Ie,a.Q$,a.Nd,a.t9,a.n0,a.yW,a.g2,a.wd,a.sr,a.ki,a.as,a.QI,a.j9,g.ez,g.mk,g.sg,g.O5,d.u5,d._Y,d.JJ,d.JL,d.Q7,d.nD,d.On,d.UX,d.sg,d.u,d.CE],styles:[".contenedor-principal[_ngcontent-%COMP%]{background:var(--primary-50)}.contenedor-principal[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]{height:8vh;padding:16px 32px 0}.contenedor-principal[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{text-align:start}.contenedor-principal[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--primary-700);font-family:var(--font-display);font-size:24px;font-weight:700;line-height:32px}.contenedor-principal[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   .botones[_ngcontent-%COMP%]{height:15vh}.contenedor-principal[_ngcontent-%COMP%]   .selection-button[_ngcontent-%COMP%]{width:100%;height:70px;margin:12px 0 0;--border-width: 1px;--border-style: solid;--border-color: var(--primary-700);--border-radius: 8px;font-family:var(--font-body);font-size:16px;font-weight:400;text-wrap:wrap!important;color:var(--primary-700);--background: var(--primary-50);--box-shadow: 0}.contenedor-principal[_ngcontent-%COMP%]   .selection-button.selected[_ngcontent-%COMP%]{color:var(--neutral-50);--background: var(--primary-700)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item[_ngcontent-%COMP%]{width:100%;margin-top:24px;--border-width: 1px;--border-color: var(--primary-400);--border-radius: 8px;--background: var(--primary-100)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{width:100%;font-family:var(--font-body);font-size:16px;font-weight:700;color:var(--primary-700)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--primary-700)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item.activated[_ngcontent-%COMP%]{--background: var(--primary-700)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item.activated[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--neutral-50)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item.activated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--neutral-50)}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]{padding:32px 0 0;background:var(--primary-50);width:100%}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]{background:var(--primary-100);padding:16px 16px 20px;border-width:1px;border-color:var(--primary-200);border-style:solid;border-radius:8px;height:170px;display:flex;flex-direction:column;align-items:center}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]::part(image){width:calc(100vw - 96px);height:92px;border-radius:8px;object-fit:cover}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]{padding-top:8px;display:flex;justify-content:space-between;height:100%;width:100%;align-items:center}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{max-width:calc(100% - 56px);overflow:hidden}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:var(--font-body);font-size:14px;color:var(--neutral-900);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:40px;width:40px;--border-radius: 4px;--border-style: solid;--border-width: 1px;--border-color: var(--error-200);--background: var(--error-100);--box-shadow: 0;margin:0}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px!important;color:var(--error-200)}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]::part(native){padding:0!important}ion-header.header-modal[_ngcontent-%COMP%]{--background: var(--neutral-50);border-bottom:1px solid var(--neutral-200)}ion-header.header-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding:52px 32px 0}ion-header.header-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-family:var(--font-body);font-size:18px;color:var(--neutral-800)}ion-header.header-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]::part(native){padding:0}ion-header.header-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px}.contenedor-principal-modal[_ngcontent-%COMP%]{height:100%;background:var(--neutral-50)}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-dias[_ngcontent-%COMP%]{width:100%;padding-top:48px;display:flex;justify-content:space-between}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-dias[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:40px!important;max-width:40px!important;height:40px!important;--border-radius: 100%;max-height:40px!important;--background: transparent;--box-shadow: 0;color:var(--neutral-500);font-family:var(--font-body);font-size:20px}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-dias[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]::part(native){padding:0}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-dias[_ngcontent-%COMP%]   ion-button.selected[_ngcontent-%COMP%]{--background: var(--primary-700);color:var(--neutral-50)}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-hora[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%], .contenedor-principal-modal[_ngcontent-%COMP%]   .horas-seleccionadas[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;align-items:flex-end;justify-content:flex-end}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-hora[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%], .contenedor-principal-modal[_ngcontent-%COMP%]   .horas-seleccionadas[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 8px;color:var(--neutral-50);min-width:68px;height:50px;margin:0 0 0 16px;--box-shadow: 0}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-hora[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   .agregar[_ngcontent-%COMP%], .contenedor-principal-modal[_ngcontent-%COMP%]   .horas-seleccionadas[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   .agregar[_ngcontent-%COMP%]{--background: var(--primary-700)}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-hora[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   .eliminar[_ngcontent-%COMP%], .contenedor-principal-modal[_ngcontent-%COMP%]   .horas-seleccionadas[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   .eliminar[_ngcontent-%COMP%]{--background: var(--error-200)}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-hora[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;font-family:var(--font-body);font-size:16px;color:var(--neutral-900)}.contenedor-principal-modal[_ngcontent-%COMP%]   .horas-seleccionadas[_ngcontent-%COMP%]{margin-top:16px;padding-top:16px;border-top:1px solid var(--neutral-200)}"]}),l})()},6203:(x,_,c)=>{c.d(_,{n:()=>d});var m=c(1571),g=c(529);let d=(()=>{var a;class h{constructor(t){this.http=t,this.dataUrl="expedientePadecimiento/"}consultarPorUsuarioParaSelector(){return this.http.get(this.dataUrl+"consultarPorUsuarioSelector")}eliminar(t){return this.http.delete(this.dataUrl+`${t}`)}agregarPadecimiento(t){return this.http.post(this.dataUrl+"agregarExpedientePadecimiento",t)}}return(a=h).\u0275fac=function(t){return new(t||a)(m.LFG(g.eN))},a.\u0275prov=m.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),h})()},9134:(x,_,c)=>{c.d(_,{q:()=>d});var m=c(1571),g=c(529);let d=(()=>{var a;class h{constructor(t){this.http=t,this.url="expedienteDoctor/"}consultarExpediente(){return this.http.get(this.url)}consultarExpedienteConImagenes(){return this.http.get(this.url+"conImagenes")}consultarSelector(){return this.http.get(this.url+"selector")}consultarPorUsuarioParaSelector(){return this.http.get(this.url+"selectorPorUsuario")}eliminar(t){return this.http.delete(this.url+"eliminarDoctorTrackr",{body:t})}agregar(t){return this.http.post(this.url,t)}}return(a=h).\u0275fac=function(t){return new(t||a)(m.LFG(g.eN))},a.\u0275prov=m.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),h})()},281:(x,_,c)=>{c.d(_,{$:()=>d});var m=c(1571),g=c(529);let d=(()=>{var a;class h{constructor(t){this.http=t,this.dataUrl="expedienteTratamiento/"}consultarTratamientos(){return this.http.get(this.dataUrl+"consultarTratamientosTrackr")}consultarTratamientoDetalle(t){return this.http.get(this.dataUrl+`consultarTratamientoDetalle/${t}`)}agregar(t){return this.http.post(this.dataUrl+"agregar",t)}editarTratamiento(t){return this.http.put(this.dataUrl+"editar",t)}eliminarTratamiento(t){return this.http.delete(this.dataUrl+`eliminar/${t}`)}}return(a=h).\u0275fac=function(t){return new(t||a)(m.LFG(g.eN))},a.\u0275prov=m.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),h})()},7126:(x,_,c)=>{c.d(_,{Z:()=>f});var m=c(5861),g=c(7423),d=c(76);const a=(0,g.fo)("Camera",{web:()=>c.e(3954).then(c.bind(c,3954)).then(t=>new t.CameraWeb)}),h=(0,g.fo)("FilePicker",{web:()=>c.e(3405).then(c.bind(c,3405)).then(t=>new t.FilePickerWeb)});class f{constructor(){var T=this;this.takePicture=(0,m.Z)(function*(){try{const v=yield a.getPhoto({quality:90,allowEditing:!0,resultType:d.dk.DataUrl});if(T.imageSrc=v.dataUrl,T.imageSrc)return T.imageSrc;throw new Error("Error")}catch(v){throw console.error("Error al tomar la foto:",v),v}}),this.pickFiles=(0,m.Z)(function*(){const{files:v}=yield h.pickFiles({types:["image/png","image/jpeg","application/pdf","image/gif"],readData:!0});return v})}}}}]);