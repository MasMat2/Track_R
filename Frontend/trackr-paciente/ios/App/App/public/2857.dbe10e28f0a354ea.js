"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2857],{1639:(P,g,e)=>{e.r(g),e.d(g,{default:()=>E});var u=e(12),a=e(433),v=e(6895),i=e(1571),M=e(933),h=e(4602),C=e(4384);const m=["jaasContainer"],E=[{path:"",children:[{path:"answer-call/:meet-name",component:(()=>{var s;class f{constructor(n,o,l){this.orientationService=n,this.router=o,this.dataJitsiService=l,this.domain="8x8.vc",this.isAudioMuted=!1,this.isVideoMuted=!1}ngOnInit(){}executeCommand(n){if("hangup"==n){const o=document.getElementById("jaas-container");return o&&(o.innerHTML=""),this.router.navigate(["/home"]),this.orientationService.lockPortrait(),void this.dataJitsiService.hangup()}"toggleAudio"==n&&(this.isAudioMuted=!this.isAudioMuted),"toggleVideo"==n&&(this.isVideoMuted=!this.isVideoMuted)}}return(s=f).\u0275fac=function(n){return new(n||s)(i.Y36(h.H),i.Y36(C.F0),i.Y36(M.s))},s.\u0275cmp=i.Xpm({type:s,selectors:[["app-answer-meet"]],standalone:!0,features:[i.jDz],decls:2,vars:0,consts:[["id","jaas-container"],["jaasContainer",""]],template:function(n,o){1&n&&i._UZ(0,"div",0,1)},dependencies:[u.Pc,v.ez,a.u5],styles:['@charset "UTF-8";#jaas-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;position:relative}.hangup-btn[_ngcontent-%COMP%]{position:absolute;bottom:0;padding:0;text-align:end;direction:revert;height:10%}']}),f})()},{path:"create-call/:id-chat",component:(()=>{var s;class f{constructor(n,o,l){this.dataJitsiService=n,this.orientationService=o,this.router=l,this.chats=[],this.isAudioMuted=!1,this.isVideoMuted=!1}ngOnInit(){}ngAfterViewInit(){}executeCommand(n){if("hangup"==n){const o=document.getElementById("jaas-container");return o&&(o.innerHTML=""),this.router.navigate(["/home"]),this.orientationService.lockPortrait(),void this.dataJitsiService.hangup()}"toggleAudio"==n&&(this.isAudioMuted=!this.isAudioMuted),"toggleVideo"==n&&(this.isVideoMuted=!this.isVideoMuted)}}return(s=f).\u0275fac=function(n){return new(n||s)(i.Y36(M.s),i.Y36(h.H),i.Y36(C.F0))},s.\u0275cmp=i.Xpm({type:s,selectors:[["app-create-jitsi-meet"]],viewQuery:function(n,o){if(1&n&&i.Gf(m,5),2&n){let l;i.iGM(l=i.CRH())&&(o.jaasContainer=l.first)}},standalone:!0,features:[i.jDz],decls:2,vars:0,consts:[["id","jaas-container"],["jaasContainer",""]],template:function(n,o){1&n&&i._UZ(0,"div",0,1)},dependencies:[u.Pc,v.ez,a.u5],styles:['@charset "UTF-8";#jaas-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}.hangup-btn[_ngcontent-%COMP%]{position:absolute;bottom:0;padding:0;text-align:end;direction:revert;height:10%}']}),f})()}]}]},9160:(P,g,e)=>{e.d(g,{L:()=>n});var u=e(5861),a=e(9856),v=e(5079),i=e(1651),M=e(162),h=e(1135),C=e(9300),m=e(5698),c=e(7414),D=e(262),E=e(2340),s=e(1571),f=e(2644),_=e(5423);let n=(()=>{var o;class l{constructor(t,r){this.ChatPersonaService=t,this.authService=r,this.connectionStatus=new h.X(a.A.Disconnected),this.chatSubject=new h.X([]),this.chat$=this.chatSubject.asObservable(),this.endpoint="hub/chat",this.iniciarConexion()}iniciarConexion(){var t=this;return(0,u.Z)(function*(){const r=yield t.authService.obtenerToken();if(!r)return;const d=`${E.N.urlBackend}${t.endpoint}`,O={accessTokenFactory:()=>r,transport:v.n.LongPolling};t.connection=(new i.s).configureLogging(M.i.Debug).withUrl(d,O).build(),t.connection.on("NuevoChat",(p,j)=>t.onNuevoChat(p,j)),t.connection.on("NuevaConexion",p=>t.onNuevaConexion(p)),t.connection.on("CargarChats",p=>t.onCargarChats(p)),t.connectionStatus.next(a.A.Connecting),yield t.connection.start()})()}detenerConexion(){var t=this;return(0,u.Z)(function*(){t.connectionStatus.next(a.A.Disconnecting),yield t.connection.stop(),t.chatSubject.next([]),t.connectionStatus.next(a.A.Disconnected)})()}obtenerNotificaciones(){return this.chatSubject.value}onNuevoChat(t,r){var d=this;return(0,u.Z)(function*(){t.fecha=new Date,d.chatSubject.value.push(t)})()}onNuevaConexion(t){for(const r of t)r.fecha=new Date(r.fecha);this.chatSubject.next(t)}onCargarChats(t){this.chatSubject.next(t)}ensureConnection(){var t=this;return(0,u.Z)(function*(){if(t.connection.state!==a.A.Connected){if(t.connection.state===a.A.Disconnected||t.connection.state===a.A.Disconnecting)throw new Error("No se ha iniciado la conexion con el Hub de Notificaciones");(t.connection.state===a.A.Connecting||t.connection.state===a.A.Reconnecting)&&t.connectionStatus.asObservable().pipe((0,C.h)(d=>d===a.A.Connected),(0,m.q)(1),(0,c.V)(1e4),(0,D.K)(()=>{throw new Error("No se pudo establecer la conexi\xf3n con el Hub de Notificaciones")}))}})()}agregarChat(t,r){var d=this;return(0,u.Z)(function*(){yield d.ensureConnection(),yield d.connection.invoke("NuevoChat",t,r)})()}abandonarChat(t){let r=this.chatSubject.value;r=r.filter(d=>d.idChat!=t),this.chatSubject.next(r)}}return(o=l).\u0275fac=function(t){return new(t||o)(s.LFG(f.R),s.LFG(_.e))},o.\u0275prov=s.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),l})()},2644:(P,g,e)=>{e.d(g,{R:()=>M});var u=e(5861),a=e(9808),v=e(1571),i=e(529);let M=(()=>{var h;class C{constructor(c){this.http=c,this.dataUrl="ChatPersona/"}agregarPersonas(c){return this.http.post(this.dataUrl,c)}obtenerIdUsuario(){return this.http.get(`${this.dataUrl}IdUsuario`)}obtenerIdUsuarioAsync(){var c=this;return(0,u.Z)(function*(){return yield(0,a.n)(c.http.get(c.dataUrl+"IdUsuario"))})()}obtenerIdPacientesPadecimiento(c){return this.http.get(`${this.dataUrl}Padecimiento/${c}`)}}return(h=C).\u0275fac=function(c){return new(c||h)(v.LFG(i.eN))},h.\u0275prov=v.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"}),C})()}}]);