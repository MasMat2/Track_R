"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2605],{2605:(A,v,a)=>{a.r(v),a.d(v,{default:()=>b});var c=a(5861),C=a(9149),M=a(433),S=a(6895),t=a(1571),g=a(4384);let w=(()=>{var n;class h{constructor(){}}return(n=h).\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),h})();var j=a(1481),P=a(4602),J=a(4273),V=a(9160);const b=[{path:"",children:[{path:"answer-call/:meet-name",component:(()=>{var n;class h{constructor(e,i,u,f){var p=this;this.orientationService=e,this.route=i,this.router=u,this.meta=f,this.domain="meet.jit.si",this.isAudioMuted=!1,this.isVideoMuted=!1,this.iniciarWebCam=(0,c.Z)(function*(){p.localStream=yield navigator.mediaDevices.getUserMedia({video:!0,audio:!0})}),this.handleClose=()=>{console.log("handleClose")},this.handleParticipantLeft=function(){var s=(0,c.Z)(function*(o){console.log("handleParticipantLeft",o)});return function(o){return s.apply(this,arguments)}}(),this.handleParticipantJoined=function(){var s=(0,c.Z)(function*(o){console.log("handleParticipantJoined",o),yield p.getParticipants()});return function(o){return s.apply(this,arguments)}}(),this.handleVideoConferenceJoined=function(){var s=(0,c.Z)(function*(o){console.log("handleVideoConferenceJoined",o),yield p.getParticipants()});return function(o){return s.apply(this,arguments)}}(),this.handleVideoConferenceLeft=()=>{console.log("handleVideoConferenceLeft")},this.handleMuteStatus=s=>{console.log("handleMuteStatus",s)},this.handleVideoStatus=s=>{console.log("handleVideoStatus",s)}}ngOnInit(){this.route.paramMap.subscribe(i=>{this.meetName=i.get("meet-name")}),this.orientationService.lockLandscape(),this.iniciarWebCam(),this.meta.addTag({name:"Content-Security-Policy",content:"default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;"}),this.answerMeet()}answerMeet(){const e={roomName:this.meetName,width:900,height:500,configOverwrite:{prejoinPageEnabled:!1},interfaceConfigOverwrite:{},parentNode:document.querySelector("#jitsi-answer-call-iframe"),userInfo:{displayName:"Medico-Trackr"}};this.api=new JitsiMeetExternalAPI(this.domain,e),this.api.addEventListeners({readyToClose:this.handleClose,participantLeft:this.handleParticipantLeft,participantJoined:this.handleParticipantJoined,videoConferenceJoined:this.handleVideoConferenceJoined,videoConferenceLeft:this.handleVideoConferenceLeft,audioMuteStatusChanged:this.handleMuteStatus,videoMuteStatusChanged:this.handleVideoStatus})}executeCommand(e){if(this.api.executeCommand(e),"hangup"==e)return this.localStream.getTracks().forEach(i=>i.stop()),this.router.navigate(["/home"]),this.orientationService.lockPortrait(),this.api.dispose(),void this.api.remove();"toggleAudio"==e&&(this.isAudioMuted=!this.isAudioMuted),"toggleVideo"==e&&(this.isVideoMuted=!this.isVideoMuted)}getParticipants(){return new Promise((e,i)=>{setTimeout(()=>{e(this.api.getParticipantsInfo())},500)})}}return(n=h).\u0275fac=function(e){return new(e||n)(t.Y36(P.H),t.Y36(g.gz),t.Y36(g.F0),t.Y36(j.h_))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-answer-meet"]],standalone:!0,features:[t.jDz],decls:3,vars:0,consts:[["id","jitsi-answer-call-iframe"],[1,"item-center"],["aria-hidden","true","title","Leave",1,"fas","fa-phone-slash","fa-2x","red-color","hangup-btn",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"i",2),t.NdJ("click",function(){return i.executeCommand("hangup")}),t.qZA()()())},dependencies:[C.Pc,S.ez,M.u5],styles:['@charset "UTF-8";#jitsi-answer-call-iframe[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;position:relative}.hangup-btn[_ngcontent-%COMP%]{position:absolute;bottom:2%;padding:0;text-align:end;direction:revert;height:10%;color:#fff;left:2%}']}),h})()},{path:"create-call/:id-chat",component:(()=>{var n;class h{constructor(e,i,u,f,p,s,o){var m=this;this.router=e,this.dataJitsiService=i,this.meta=u,this.orientationService=f,this.mensajeHubService=p,this.chatMensajeHubServiceService=s,this.route=o,this.chats=[],this.domain="meet.jit.si",this.isAudioMuted=!1,this.isVideoMuted=!1,this.iniciarWebCam=(0,c.Z)(function*(){m.localStream=yield navigator.mediaDevices.getUserMedia({video:!0,audio:!0})}),this.handleClose=()=>{console.log("handleClose"),this.orientationService.lockPortrait()},this.handleParticipantLeft=function(){var r=(0,c.Z)(function*(d){console.log("handleParticipantLeft",d),yield m.getParticipants()});return function(d){return r.apply(this,arguments)}}(),this.handleParticipantJoined=function(){var r=(0,c.Z)(function*(d){console.log("handleParticipantJoined",d),yield m.getParticipants()});return function(d){return r.apply(this,arguments)}}(),this.handleVideoConferenceJoined=function(){var r=(0,c.Z)(function*(d){console.log("handleVideoConferenceJoined",d),yield m.getParticipants()});return function(d){return r.apply(this,arguments)}}(),this.handleVideoConferenceLeft=()=>{console.log("handleVideoConferenceLeft"),this.router.navigate(["/home"])},this.handleMuteStatus=r=>{console.log("handleMuteStatus",r)},this.handleVideoStatus=r=>{console.log("handleVideoStatus",r)}}ngOnInit(){this.route.paramMap.subscribe(i=>{this.idChat=i.get("id-chat")}),this.orientationService.lockLandscape(),this.iniciarWebCam(),this.meta.addTag({name:"Content-Security-Policy",content:"default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;"}),this.createNewRoom()}obtenerChats(){this.chatMensajeHubServiceService.iniciarConexion(),this.chats$=this.chatMensajeHubServiceService.chat$,this.chats$.subscribe(e=>{this.chats=e})}obtenerMensajes(){this.mensajeHubService.iniciarConexion(),this.mensajes$=this.mensajeHubService.chatMensaje$,this.mensajes$.subscribe(e=>{this.mensajes=e,console.log(this.mensajes)})}createNewRoom(){const e="trackr-"+this.idChat+"-"+Math.floor(1e4*Math.random());this.mandarMensajeLlamada("\u{1f4de} Te espero la sala "+e),window.location.assign(`intent://${this.domain}/${e}#Intent;scheme=org.jitsi.meet;package=org.jitsi.meet;end`);const f={roomName:e,width:800,height:500,configOverwrite:{prejoinPageEnabled:!1},interfaceConfigOverwrite:{},parentNode:document.querySelector("#jitsi-new-meet-iframe"),userInfo:{displayName:"Trackr-user"}};this.roomApi=new JitsiMeetExternalAPI(this.domain,f),this.roomApi.addEventListeners({readyToClose:this.handleClose,participantLeft:this.handleParticipantLeft,participantJoined:this.handleParticipantJoined,videoConferenceJoined:this.handleVideoConferenceJoined,videoConferenceLeft:this.handleVideoConferenceLeft,audioMuteStatusChanged:this.handleMuteStatus,videoMuteStatusChanged:this.handleVideoStatus}),console.log("Nueva sala creada:",e)}mandarMensajeLlamada(e){console.log("id chat mensaje "+this.idChat);let i={fecha:new Date,idChat:parseInt(this.idChat),mensaje:e,idPersona:5333,archivo:"",idArchivo:0};this.mensajeHubService.enviarMensaje(i),console.log("mandarMensajeLlamada method msg: "+e)}getParticipants(){return new Promise((e,i)=>{setTimeout(()=>{e(this.roomApi.getParticipantsInfo())},500)})}executeCommand(e){if(this.roomApi.executeCommand(e),"hangup"==e)return this.localStream.getTracks().forEach(i=>i.stop()),this.router.navigate(["/home"]),this.orientationService.lockPortrait(),this.roomApi.dispose(),void this.roomApi.remove();"toggleAudio"==e&&(this.isAudioMuted=!this.isAudioMuted),"toggleVideo"==e&&(this.isVideoMuted=!this.isVideoMuted)}}return(n=h).\u0275fac=function(e){return new(e||n)(t.Y36(g.F0),t.Y36(w),t.Y36(j.h_),t.Y36(P.H),t.Y36(J.U),t.Y36(V.L),t.Y36(g.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-jitsi-meet"]],standalone:!0,features:[t.jDz],decls:3,vars:0,consts:[["id","jitsi-new-meet-iframe"],[1,"item-center"],["aria-hidden","true","title","Leave",1,"fas","fa-phone-slash","fa-2x","red-color","hangup-btn",3,"click"]],template:function(e,i){1&e&&(t._UZ(0,"div",0),t.TgZ(1,"div",1)(2,"i",2),t.NdJ("click",function(){return i.executeCommand("hangup")}),t.qZA()())},dependencies:[C.Pc,S.ez,M.u5],styles:['@charset "UTF-8";#jitsi-new-meet-iframe[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}.hangup-btn[_ngcontent-%COMP%]{position:absolute;bottom:0;padding:0;text-align:end;direction:revert;height:10%}']}),h})()}]}]}}]);