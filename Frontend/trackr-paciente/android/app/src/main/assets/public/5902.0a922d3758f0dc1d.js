"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5902],{76:(P,_,r)=>{r.d(_,{GW:()=>m,dk:()=>c,oK:()=>s});var s=(()=>{return(a=s||(s={})).Prompt="PROMPT",a.Camera="CAMERA",a.Photos="PHOTOS",s;var a})(),m=(()=>{return(a=m||(m={})).Rear="REAR",a.Front="FRONT",m;var a})(),c=(()=>{return(a=c||(c={})).Uri="uri",a.Base64="base64",a.DataUrl="dataUrl",c;var a})()},6388:(P,_,r)=>{r.d(_,{V1:()=>c,dk:()=>m.dk,oK:()=>m.oK});var s=r(7423),m=r(76);const c=(0,s.fo)("Camera",{web:()=>r.e(3954).then(r.bind(r,3954)).then(a=>new a.CameraWeb)})},5902:(P,_,r)=>{r.r(_),r.d(_,{AgregarTratamientoPage:()=>lt});var s=r(5861),m=r(6895),c=r(433),a=r(12),h=r(2583),f=r(4649),t=r(1571),T=r(281),y=r(9134),D=r(6203),C=r(6388);let S=(()=>{var o;class l{constructor(){}takePicture(){return(0,s.Z)(function*(){return yield C.V1.getPhoto({resultType:C.dk.Base64,source:C.oK.Camera,quality:100})})()}}return(o=l).\u0275fac=function(n){return new(n||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),l})();var k=r(1814);function q(o,l){1&o&&t._UZ(0,"ion-datetime",49)}function E(o,l){1&o&&(t.TgZ(0,"div",50),t._UZ(1,"ion-icon",51),t._uU(2," El f\xe1rmaco es requerido "),t.qZA())}function I(o,l){1&o&&(t.TgZ(0,"div",50),t._UZ(1,"ion-icon",51),t._uU(2," La cantidad es requerida "),t.qZA())}function F(o,l){if(1&o&&(t.TgZ(0,"ion-select-option",52),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.Q6J("value",e.nombre),t.xp6(1),t.hij(" ",e.nombre," ")}}function N(o,l){1&o&&(t.TgZ(0,"div",50),t._UZ(1,"ion-icon",51),t._uU(2," La unidad es requerida "),t.qZA())}function J(o,l){1&o&&(t.TgZ(0,"div",50),t._UZ(1,"ion-icon",51),t._uU(2," La indicaci\xf3n es requerida "),t.qZA())}function Q(o,l){if(1&o&&(t.TgZ(0,"ion-select-option",52),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.Q6J("value",e.idPadecimiento),t.xp6(1),t.hij(" ",e.nombre," ")}}function Y(o,l){1&o&&(t.TgZ(0,"div",50),t._UZ(1,"ion-icon",51),t._uU(2," El padecimiento es requerido "),t.qZA())}function z(o,l){if(1&o&&(t.TgZ(0,"ion-select-option",52),t._uU(1),t.qZA()),2&o){const e=l.$implicit;t.Q6J("value",e.idUsuarioDoctor),t.xp6(1),t.hij(" ",e.nombre," ")}}function j(o,l){1&o&&(t.TgZ(0,"div",50),t._UZ(1,"ion-icon",51),t._uU(2," El doctor es requerido "),t.qZA())}function K(o,l){1&o&&t._UZ(0,"ion-datetime",53)}function G(o,l){1&o&&t._UZ(0,"ion-datetime",55)}function R(o,l){1&o&&(t.TgZ(0,"ion-row")(1,"ion-col",13)(2,"div",14)(3,"ion-label"),t._uU(4,"Fecha de fin"),t.qZA(),t.TgZ(5,"ion-item",39),t._UZ(6,"ion-datetime-button",54)(7,"ion-icon",17),t.qZA(),t.TgZ(8,"ion-modal",18),t.YNc(9,G,1,0,"ng-template"),t.qZA()()()()),2&o&&(t.xp6(8),t.Q6J("keepContentsMounted",!0))}function B(o,l){1&o&&(t.TgZ(0,"ion-label"),t._uU(1," Fijar recordatorio "),t.qZA())}function H(o,l){1&o&&(t.TgZ(0,"ion-label"),t._uU(1," Editar recordatorio "),t.qZA())}const O=function(o){return{selected:o}};function L(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",71),t.NdJ("click",function(){const d=t.CHM(e).index,g=t.oxw(3);return t.KtG(g.seleccionarDiaRecordatorio(d))}),t._uU(1),t.qZA()}if(2&o){const e=l.$implicit,n=l.index,i=t.oxw(3);t.Q6J("ngClass",t.VKq(2,O,i.esDiaSemanaSeleccionado(n))),t.xp6(1),t.hij(" ",e.name," ")}}const $=function(){return{standalone:!0}};function V(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"ion-datetime",72),t.NdJ("ngModelChange",function(i){t.CHM(e);const d=t.oxw(3);return t.KtG(d.fechaSeleccionada=i)}),t.qZA()}if(2&o){const e=t.oxw(3);t.Q6J("ngModel",e.fechaSeleccionada)("ngModelOptions",t.DdM(2,$))}}function W(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",73),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(3);return t.KtG(i.addHour())}),t._UZ(1,"ion-icon",27),t.qZA()}}function X(o,l){if(1&o&&t._UZ(0,"ion-datetime",76),2&o){const e=t.oxw(),n=e.index,i=e.$implicit;t.s9C("formControlName",n),t.Q6J("value",null==i?null:i.value)("name","horaName"+n)("id","hora"+n)}}function tt(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"ion-button",77),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().index,d=t.oxw(3);return t.KtG(d.removeHour(i))}),t._UZ(1,"ion-icon",78),t.qZA()}}function et(o,l){if(1&o&&(t.TgZ(0,"ion-row")(1,"ion-col")(2,"div",14)(3,"ion-label"),t._uU(4),t.qZA(),t.TgZ(5,"ion-item",15),t._UZ(6,"ion-datetime-button",74)(7,"ion-icon",65),t.qZA(),t.TgZ(8,"ion-modal",18),t.YNc(9,X,1,4,"ng-template"),t.qZA()()(),t.TgZ(10,"ion-col",66)(11,"div",67),t.YNc(12,tt,2,0,"ion-button",75),t.qZA()()()),2&o){const e=l.index;t.xp6(4),t.hij("Horario ",e+1,""),t.xp6(2),t.Q6J("datetime","hora"+e),t.xp6(2),t.Q6J("keepContentsMounted",!0),t.xp6(4),t.Q6J("ngIf",!0)}}function nt(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"ion-header",56)(1,"ion-toolbar")(2,"ion-buttons",57)(3,"ion-button",3),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.setOpen(!1))}),t._UZ(4,"ion-icon",58),t.qZA()(),t.TgZ(5,"ion-title"),t._uU(6,"Fijar recordatorio"),t.qZA()()(),t.TgZ(7,"ion-content",59)(8,"div",60)(9,"ion-grid",12)(10,"ion-row")(11,"ion-col",13)(12,"div",61),t.YNc(13,L,2,4,"ion-button",62),t.qZA()()(),t.TgZ(14,"div",63)(15,"ion-row")(16,"ion-col")(17,"div",14)(18,"ion-label"),t._uU(19,"Definir hora"),t.qZA(),t.TgZ(20,"ion-item",39),t._UZ(21,"ion-datetime-button",64)(22,"ion-icon",65),t.qZA(),t.TgZ(23,"ion-modal",18),t.YNc(24,V,1,3,"ng-template"),t.qZA()()(),t.TgZ(25,"ion-col",66)(26,"div",67),t.YNc(27,W,2,0,"ion-button",68),t.qZA()()(),t.TgZ(28,"ion-row")(29,"ion-col",13)(30,"ion-text")(31,"p"),t._uU(32,"Se notificar\xe1 15 minutos antes de la hora establecida."),t.qZA()()()()(),t.TgZ(33,"div",69),t.YNc(34,et,13,4,"ion-row",70),t.qZA()()()()}if(2&o){const e=t.oxw(2);t.xp6(13),t.Q6J("ngForOf",e.weekDays),t.xp6(10),t.Q6J("keepContentsMounted",!0),t.xp6(4),t.Q6J("ngIf",!0),t.xp6(7),t.Q6J("ngForOf",e.horas.controls)}}function ot(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"ion-item",79),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addPhotoToGallery())}),t.TgZ(1,"ion-label"),t._uU(2,"Adjuntar imagen"),t.qZA(),t._UZ(3,"ion-icon",80),t.qZA()}}function it(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",81)(1,"div",82),t._UZ(2,"ion-img",83),t.TgZ(3,"div",84)(4,"ion-text")(5,"p"),t._uU(6),t.qZA()(),t.TgZ(7,"ion-button",3),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.eliminarAdjunto())}),t._UZ(8,"ion-icon",85),t.qZA()()()()}if(2&o){const e=t.oxw(2);t.xp6(2),t.Q6J("src",e.photo),t.xp6(4),t.Oqu(null==e.photoPreview?null:e.photoPreview.dataUrl)}}const M=function(){return{cssClass:"custom-select-action-sheet"}},at=function(o){return{activated:o}};function rt(o,l){if(1&o){const e=t.EpF();t.TgZ(0,"div",7)(1,"div",8)(2,"ion-text")(3,"h3"),t._uU(4,"A\xf1adir tratamiento"),t.qZA()()(),t.TgZ(5,"div",9)(6,"form",10)(7,"div",11)(8,"ion-grid",12)(9,"ion-row")(10,"ion-col",13)(11,"div",14)(12,"ion-label"),t._uU(13,"Fecha de registro"),t.qZA(),t.TgZ(14,"ion-item",15),t._UZ(15,"ion-datetime-button",16)(16,"ion-icon",17),t.qZA(),t.TgZ(17,"ion-modal",18),t.YNc(18,q,1,0,"ng-template"),t.qZA()()()(),t.TgZ(19,"ion-row")(20,"ion-col",13)(21,"div",14)(22,"ion-label"),t._uU(23,"F\xe1rmaco"),t.qZA(),t.TgZ(24,"ion-item",19),t._UZ(25,"ion-input",20),t.qZA(),t.YNc(26,E,3,0,"div",21),t.qZA()()(),t.TgZ(27,"ion-row")(28,"ion-col",22)(29,"div",14)(30,"ion-label"),t._uU(31,"Cantidad"),t.qZA(),t.TgZ(32,"ion-item",23)(33,"ion-button",24),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.decrementarCantidad())}),t._UZ(34,"ion-icon",25),t.qZA(),t.TgZ(35,"ion-label"),t._uU(36),t.qZA(),t.TgZ(37,"ion-button",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.incrementarCantidad())}),t._UZ(38,"ion-icon",27),t.qZA()(),t.YNc(39,I,3,0,"div",21),t.qZA()(),t.TgZ(40,"ion-col",28)(41,"div",14)(42,"ion-label"),t._uU(43,"Unidad"),t.qZA(),t.TgZ(44,"ion-item",29)(45,"ion-select",30),t.YNc(46,F,2,2,"ion-select-option",31),t.qZA()(),t.YNc(47,N,3,0,"div",21),t.qZA()()(),t.TgZ(48,"ion-row")(49,"ion-col",13)(50,"div",14)(51,"ion-label"),t._uU(52,"Indicaciones"),t.qZA(),t.TgZ(53,"ion-item",32),t._UZ(54,"ion-textarea",33),t.qZA(),t.YNc(55,J,3,0,"div",21),t.qZA()()(),t.TgZ(56,"ion-row")(57,"ion-col",13)(58,"div",14)(59,"ion-label"),t._uU(60,"Padecimiento asociado"),t.qZA(),t.TgZ(61,"ion-item",29)(62,"ion-select",34),t.YNc(63,Q,2,2,"ion-select-option",31),t.qZA()(),t.YNc(64,Y,3,0,"div",21),t.qZA()()(),t.TgZ(65,"ion-row")(66,"ion-col",13)(67,"div",14)(68,"ion-label"),t._uU(69,"Doctor"),t.qZA(),t.TgZ(70,"ion-item",29)(71,"ion-select",35),t.YNc(72,z,2,2,"ion-select-option",31),t.qZA()(),t.YNc(73,j,3,0,"div",21),t.qZA()()(),t.TgZ(74,"ion-row")(75,"div",14)(76,"ion-label"),t._uU(77,"Duracion del tratamiento"),t.qZA()(),t.TgZ(78,"ion-col",36)(79,"ion-button",37),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.seleccionarTratamientoPermanente(!0))}),t._uU(80," Tratamiento permanente "),t.qZA()(),t.TgZ(81,"ion-col",36)(82,"ion-button",38),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.seleccionarTratamientoPermanente(!1))}),t._uU(83," Tratamiento no permanente "),t.qZA()()(),t.TgZ(84,"ion-row")(85,"ion-col",13)(86,"div",14)(87,"ion-label"),t._uU(88,"Fecha de inicio"),t.qZA(),t.TgZ(89,"ion-item",39),t._UZ(90,"ion-datetime-button",40)(91,"ion-icon",17),t.qZA(),t.TgZ(92,"ion-modal",18),t.YNc(93,K,1,0,"ng-template"),t.qZA()()()(),t.YNc(94,R,10,1,"ion-row",41),t.TgZ(95,"ion-row")(96,"ion-col",13)(97,"ion-item",42),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.setOpen(!0))}),t.YNc(98,B,2,0,"ion-label",41),t.YNc(99,H,2,0,"ion-label",41),t._UZ(100,"ion-icon",43),t.qZA(),t.TgZ(101,"ion-modal",44),t.YNc(102,nt,35,4,"ng-template"),t.qZA()()(),t.TgZ(103,"ion-row")(104,"ion-col",13),t.YNc(105,ot,4,0,"ion-item",45),t.YNc(106,it,9,2,"div",46),t.qZA()()()(),t.TgZ(107,"div",47)(108,"ion-button",48),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.submitForm())}),t._uU(109,"Guardar"),t.qZA()()()()()}if(2&o){const e=t.oxw();let n,i,d,g,p,u,v,x,b,Z,A,w,U;t.xp6(6),t.Q6J("formGroup",e.formTratamiento),t.xp6(11),t.Q6J("keepContentsMounted",!0),t.xp6(9),t.Q6J("ngIf",(null==(n=e.formTratamiento.get("farmaco"))?null:n.hasError("required"))&&((null==(n=e.formTratamiento.get("farmaco"))?null:n.dirty)||(null==(n=e.formTratamiento.get("farmaco"))?null:n.touched))),t.xp6(10),t.Oqu(null==(i=e.formTratamiento.get("cantidad"))?null:i.value),t.xp6(3),t.Q6J("ngIf",(null==(d=e.formTratamiento.get("cantidad"))?null:d.hasError("required"))&&((null==(d=e.formTratamiento.get("cantidad"))?null:d.dirty)||(null==(d=e.formTratamiento.get("cantidad"))?null:d.touched))),t.xp6(6),t.Q6J("interfaceOptions",t.DdM(26,M)),t.xp6(1),t.Q6J("ngForOf",e.unidades),t.xp6(1),t.Q6J("ngIf",(null==(g=e.formTratamiento.get("unidad"))?null:g.hasError("required"))&&((null==(g=e.formTratamiento.get("unidad"))?null:g.dirty)||(null==(g=e.formTratamiento.get("unidad"))?null:g.touched))),t.xp6(8),t.Q6J("ngIf",(null==(p=e.formTratamiento.get("indicaciones"))?null:p.hasError("required"))&&((null==(p=e.formTratamiento.get("indicaciones"))?null:p.dirty)||(null==(p=e.formTratamiento.get("indicaciones"))?null:p.touched))),t.xp6(7),t.Q6J("interfaceOptions",t.DdM(27,M)),t.xp6(1),t.Q6J("ngForOf",e.padecimientosSelector),t.xp6(1),t.Q6J("ngIf",(null==(u=e.formTratamiento.get("idPadecimiento"))?null:u.hasError("required"))&&((null==(u=e.formTratamiento.get("idPadecimiento"))?null:u.dirty)||(null==(u=e.formTratamiento.get("idPadecimiento"))?null:u.touched))),t.xp6(7),t.Q6J("interfaceOptions",t.DdM(28,M)),t.xp6(1),t.Q6J("ngForOf",e.doctoresSelector),t.xp6(1),t.Q6J("ngIf",(null==(v=e.formTratamiento.get("idUsuarioDoctor"))?null:v.hasError("required"))&&((null==(v=e.formTratamiento.get("idUsuarioDoctor"))?null:v.dirty)||(null==(v=e.formTratamiento.get("idUsuarioDoctor"))?null:v.touched))),t.xp6(6),t.Q6J("ngClass",t.VKq(29,O,null==(x=e.formTratamiento.get("tratamientoPermanente"))?null:x.value)),t.xp6(3),t.Q6J("ngClass",t.VKq(31,O,!(null!=(b=e.formTratamiento.get("tratamientoPermanente"))&&b.value))),t.xp6(10),t.Q6J("keepContentsMounted",!0),t.xp6(2),t.Q6J("ngIf",!(null!=(Z=e.formTratamiento.get("tratamientoPermanente"))&&Z.value)),t.xp6(3),t.Q6J("ngClass",t.VKq(33,at,null==(A=e.formTratamiento.get("recordatorioActivo"))?null:A.value)),t.xp6(1),t.Q6J("ngIf",!(null!=(w=e.formTratamiento.get("recordatorioActivo"))&&w.value)),t.xp6(1),t.Q6J("ngIf",null==(U=e.formTratamiento.get("recordatorioActivo"))?null:U.value),t.xp6(2),t.Q6J("isOpen",e.isModalRecordatorioOpen),t.xp6(4),t.Q6J("ngIf",!e.photo),t.xp6(1),t.Q6J("ngIf",e.photo),t.xp6(2),t.Q6J("disabled",!e.formTratamiento.valid||e.btnSubmit)}}let lt=(()=>{var o;class l{constructor(n,i,d,g,p,u,v,x){this.perfilTratamientoService=n,this.doctoresService=i,this.expedientePadecimientoService=d,this.fb=g,this.photoService=p,this._modalCtrl=u,this.alertController=v,this.capacitorUtils=x,this.now=new Date,this.localOffset=6e4*this.now.getTimezoneOffset(),this.localISOTime=new Date(this.now.getTime()-this.localOffset).toISOString().slice(0,-1),this.dateToday=this.localISOTime,this.cantidadFarmaco=1,this.isModalRecordatorioOpen=!1,this.btnSubmit=!1,this.fechaSeleccionada=this.dateToday,this.weekDays=[{id:0,name:"L"},{id:1,name:"M"},{id:2,name:"M"},{id:3,name:"J"},{id:4,name:"V"},{id:5,name:"S"},{id:6,name:"D"}],this.unidades=[{id:1,nombre:"mcg"},{id:2,nombre:"mg"},{id:3,nombre:"g"},{id:4,nombre:"ml"},{id:5,nombre:"tabletas"},{id:6,nombre:"cucharadas"}],(0,h.a)({"chevron-left":"assets/img/svg/chevron-left.svg","chevron-right":"assets/img/svg/chevron-right.svg","chevron-up":"assets/img/svg/chevron-up.svg","chevron-down":"assets/img/svg/chevron-down.svg",calendar:"assets/img/svg/calendar.svg",clock:"assets/img/svg/clock-2.svg",info:"assets/img/svg/info.svg",camera:"assets/img/svg/camera.svg",minus:"assets/img/svg/minus.svg",plus:"assets/img/svg/plus.svg",x:"assets/img/svg/x.svg","trash-2":"assets/img/svg/trash-2.svg"})}ngOnInit(){this.formTratamiento=this.fb.group({fechaRegistro:[(new Date).toISOString(),c.kI.required],farmaco:["",c.kI.required],cantidad:["1",c.kI.required],unidad:["",c.kI.required],indicaciones:["",c.kI.required],idPadecimiento:["",c.kI.required],idUsuarioDoctor:["",c.kI.required],tratamientoPermanente:[!1],fechaInicio:[(new Date).toISOString(),c.kI.required],fechaFin:[(new Date).toISOString()],imagenBase64:[""],recordatorioActivo:[!1],diaSemana:this.fb.array([!1,!1,!1,!1,!1,!1,!1]),horas:this.fb.array([])},{validators:[this.validateDiaSemana(),this.compareDates()]}),this.selectorPadecimeintos(),this.selectorDoctor(),this.verificarAccionFormulario()}verificarAccionFormulario(){"editar"==this.accion&&this.rellenarValoresEditar()}rellenarValoresEditar(){this.formTratamiento.patchValue({fechaRegistro:this.perfilTratamientoDto.fechaRegistro,farmaco:this.perfilTratamientoDto.farmaco,cantidad:this.perfilTratamientoDto.cantidad,unidad:this.perfilTratamientoDto.unidad,indicaciones:this.perfilTratamientoDto.indicaciones,idPadecimiento:this.perfilTratamientoDto.idPadecimiento,idUsuarioDoctor:this.perfilTratamientoDto.idUsuarioDoctor,tratamientoPermanente:null==this.perfilTratamientoDto.fechaFin,fechaInicio:this.perfilTratamientoDto.fechaInicio,fechaFin:this.perfilTratamientoDto.fechaFin,imagenBase64:this.perfilTratamientoDto.imagenBase64,recordatorioActivo:this.perfilTratamientoDto.recordatorioActivo}),this.formTratamiento.get("diaSemana").patchValue(this.perfilTratamientoDto.diaSemana);const i=this.formTratamiento.get("horas");i.clear(),this.perfilTratamientoDto.horas.forEach(d=>{const g=this.formatearHoraAFechaLocal(d);i.push(new c.NI(g))}),""!=this.perfilTratamientoDto.imagenBase64&&(this.photo=this.perfilTratamientoDto.imagenBase64,this.photoPreview={format:"jpeg",saved:!1,base64String:this.perfilTratamientoDto.imagenBase64}),this.cantidadFarmaco=this.perfilTratamientoDto.cantidad}get horas(){return this.formTratamiento.get("horas")}formatearHoraAFechaLocal(n){const i=this.dateToday.split("T")[0];return new Date(new Date(`${i}T${n}`).getTime()-this.localOffset).toISOString().slice(0,-1)}selectorPadecimeintos(){this.expedientePadecimientoService.consultarPorUsuarioParaSelector().subscribe({next:n=>{console.log(n),this.padecimientosSelector=n}})}selectorDoctor(){this.doctoresService.consultarPorUsuarioParaSelector().subscribe({next:n=>{console.log(n),this.doctoresSelector=n}})}addPhotoToGallery(){var n=this;return(0,s.Z)(function*(){n.photo=yield n.capacitorUtils.takePicture(),console.log(n.photo)})()}removeHour(n){this.horas.removeAt(n),0===this.horas.length&&this.formTratamiento.patchValue({recordatorioActivo:!1})}addHour(){0===this.horas.length&&this.formTratamiento.patchValue({recordatorioActivo:!0}),this.horas.push(this.fb.control(this.fechaSeleccionada)),this.fechaSeleccionada=this.dateToday}compareDates(){return n=>{var i,d,g;const p=null===(i=n.get("tratamientoPermanente"))||void 0===i?void 0:i.value,u=new Date(null===(d=n.get("fechaInicio"))||void 0===d?void 0:d.value),v=new Date(null===(g=n.get("fechaFin"))||void 0===g?void 0:g.value);return!p&&u&&v&&u>v?{fechaFinLessThanFechaInicio:!0}:null}}validateDiaSemana(){return n=>{var i,d;const g=null===(i=n.get("recordatorioActivo"))||void 0===i?void 0:i.value,p=null===(d=n.get("diaSemana"))||void 0===d?void 0:d.value;return g&&!p.some(u=>u)?{sinDiaSelecionado:!0}:null}}submitForm(){var n;this.btnSubmit=!0;const i=this.formTratamiento.value,d=i.horas.map(u=>u.split("T")[1].split(".")[0]);var g=this.photo?this.photo.split(",")[1]:"";const p={idExpedienteTratamiento:null===(n=this.perfilTratamientoDto)||void 0===n?void 0:n.idExpedienteTratamiento,farmaco:i.farmaco,fechaRegistro:new Date(i.fechaRegistro),fechaInicio:new Date(i.fechaInicio),fechaFin:i.tratamientoPermanente?void 0:new Date(i.fechaFin),cantidad:i.cantidad,unidad:i.unidad,indicaciones:i.indicaciones,padecimiento:i.padecimiento,idPadecimiento:i.idPadecimiento,idUsuarioDoctor:i.idUsuarioDoctor,imagenBase64:g,recordatorioActivo:i.recordatorioActivo,diaSemana:i.recordatorioActivo?i.diaSemana:null,horas:i.recordatorioActivo?d:null};this.perfilTratamientoDto=p,"editar"==this.accion?this.editar(this.perfilTratamientoDto):this.agregar(this.perfilTratamientoDto)}agregar(n){this.perfilTratamientoService.agregar(n).subscribe({next:()=>{},error:()=>{this.btnSubmit=!1},complete:()=>{this.btnSubmit=!1,this.presentarAlertaSuccess("agregado")}})}editar(n){this.perfilTratamientoService.editarTratamiento(n).subscribe({next:()=>{},error:()=>{this.btnSubmit=!1},complete:()=>{this.btnSubmit=!1,this.presentarAlertaSuccess("editado")}})}seleccionarTratamientoPermanente(n){this.formTratamiento.patchValue({tratamientoPermanente:n})}incrementarCantidad(){this.cantidadFarmaco<99&&(this.cantidadFarmaco+=1,this.formTratamiento.patchValue({cantidad:this.cantidadFarmaco}))}decrementarCantidad(){this.cantidadFarmaco>0&&(this.cantidadFarmaco-=1,this.formTratamiento.patchValue({cantidad:this.cantidadFarmaco}))}esDiaSemanaSeleccionado(n){return this.formTratamiento.get("diaSemana").at(n).value}seleccionarDiaRecordatorio(n){const d=this.formTratamiento.get("diaSemana").at(n);d.patchValue(!d.value)}eliminarAdjunto(){this.photo=void 0}presentarAlertaSuccess(n){var i=this;return(0,s.Z)(function*(){yield(yield i.alertController.create({header:`Tratamiento ${n} exitosamente`,buttons:[{text:"De acuerdo",role:"confirm",handler:()=>{i.cerrarModal("confirm")}}],cssClass:"custom-alert color-primary icon-check"})).present()})()}cerrarModal(n){this._modalCtrl.dismiss(null,n)}setOpen(n){this.isModalRecordatorioOpen=n}}return(o=l).\u0275fac=function(n){return new(n||o)(t.Y36(T.$),t.Y36(y.q),t.Y36(D.n),t.Y36(c.qu),t.Y36(S),t.Y36(k.IN),t.Y36(a.Br),t.Y36(f.Z))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-agregar-tratamiento"]],standalone:!0,features:[t._Bn([f.Z]),t.jDz],decls:10,vars:1,consts:[[1,"ion-no-border"],[1,"contenedor-header-light"],["slot","start",1,"start"],[3,"click"],["slot","start","name","chevron-left"],[1,"primary"],["class","contenedor-principal",4,"ngIf"],[1,"contenedor-principal"],[1,"titulo"],[1,"formulario"],[3,"formGroup"],[1,"contenido-formulario"],[1,"inputs","ion-no-padding"],["size","12"],[1,"input"],["lines","none",1,"date-input","input-disabled"],["disabled","true","datetime","fechaRealizacion"],["name","calendar","slot","end","aria-hidden","true"],[3,"keepContentsMounted"],["lines","none",1,"general-input"],["id","nombreEstudio","name","nombreEstudio","type","text","maxlength","200","required","","autocomplete","off","formControlName","farmaco"],["class","input-text-error",4,"ngIf"],["size","6",1,"padding-derecho"],["lines","none",1,"quantity-selector"],["id","decrementar",3,"click"],["slot","icon-only","name","minus"],["id","incrementar",3,"click"],["slot","icon-only","name","plus"],["size","6",1,"padding-izquierdo"],["lines","none",1,"select-input"],["id","unidad","name","unidadName","interface","action-sheet","cancelText","Cancelar","placeholder","Seleccionar","toggleIcon","chevron-down","formControlName","unidad",3,"interfaceOptions"],[3,"value",4,"ngFor","ngForOf"],["lines","none",1,"textarea-input"],["maxlength","500","rows","8","autoGrow","","placeholder","Escriba aqu\xed indicaciones que le de su m\xe9dico de confianza.","formControlName","indicaciones"],["id","padecimiento","name","padecimientoName","interface","action-sheet","cancelText","Cancelar","placeholder","Seleccionar","toggleIcon","chevron-down","formControlName","idPadecimiento",3,"interfaceOptions"],["id","doctor","name","doctorName","interface","action-sheet","cancelText","Cancelar","placeholder","Seleccionar","toggleIcon","chevron-down","formControlName","idUsuarioDoctor",3,"interfaceOptions"],["size","6"],[1,"selection-button","padding-derecho",3,"ngClass","click"],[1,"selection-button","padding-izquierdo",3,"ngClass","click"],["lines","none",1,"date-input"],["datetime","fechaInicio"],[4,"ngIf"],["lines","none","button","",1,"action-button-item",3,"ngClass","click"],["slot","end","name","chevron-right"],[3,"isOpen"],["lines","none","button","","class","action-button-item",3,"click",4,"ngIf"],["class","adjuntar-elemento",4,"ngIf"],[1,"botones"],[1,"guardar",3,"disabled","click"],["presentation","date","color","morado-custom","name","fechaRealizacion","id","fechaRealizacion","showDefaultButtons","true","locale","es-ES","formControlName","fechaRegistro"],[1,"input-text-error"],["slot","start","name","info"],[3,"value"],["presentation","date","color","morado-custom","name","fechaInicio","id","fechaInicio","showDefaultButtons","true","cancelText","Cancelar","doneText","Ok","locale","es-ES","formControlName","fechaInicio"],["datetime","fechaFin"],["presentation","date","color","morado-custom","name","fechaFin","id","fechaFin","showDefaultButtons","true","cancelText","Cancelar","doneText","Ok","locale","es-ES","formControlName","fechaFin"],[1,"ion-no-border","header-modal"],["slot","start"],["name","x"],[1,"neutral"],[1,"contenedor-principal-modal"],[1,"selector-dias"],[3,"ngClass","click",4,"ngFor","ngForOf"],[1,"selector-hora"],["datetime","selectorHora"],["name","clock","slot","end","aria-hidden","true"],["size","auto"],[1,"boton-agregar-eliminar"],["class","agregar",3,"click",4,"ngIf"],["formArrayName","horas",1,"horas-seleccionadas"],[4,"ngFor","ngForOf"],[3,"ngClass","click"],["presentation","time","color","morado-custom","name","selectorHoraName","id","selectorHora","showDefaultButtons","true","cancelText","Cancelar","doneText","Ok","locale","es-ES",3,"ngModel","ngModelOptions","ngModelChange"],[1,"agregar",3,"click"],["disabled","",3,"datetime"],["class","eliminar",3,"click",4,"ngIf"],["presentation","time","color","morado-custom","showDefaultButtons","true","locale","es-ES","readonly","",3,"value","name","id","formControlName"],[1,"eliminar",3,"click"],["slot","icon-only","name","x"],["lines","none","button","",1,"action-button-item",3,"click"],["slot","end","name","camera"],[1,"adjuntar-elemento"],[1,"previsualizacion"],[3,"src"],[1,"datos-archivo"],["slot","icon-only","name","trash-2"]],template:function(n,i){1&n&&(t.TgZ(0,"ion-header",0)(1,"div",1)(2,"ion-toolbar")(3,"ion-buttons",2)(4,"ion-button",3),t.NdJ("click",function(){return i.cerrarModal("cancel")}),t._UZ(5,"ion-icon",4),t.TgZ(6,"ion-label"),t._uU(7,"Atr\xe1s"),t.qZA()()()()()(),t.TgZ(8,"ion-content",5),t.YNc(9,rt,110,35,"div",6),t.qZA()),2&n&&(t.xp6(9),t.Q6J("ngIf",!0))},dependencies:[a.Pc,a.YG,a.Sm,a.wI,a.W2,a.x4,a.Mj,a.jY,a.Gu,a.gu,a.Xz,a.pK,a.Ie,a.Q$,a.Nd,a.t9,a.n0,a.yW,a.g2,a.wd,a.sr,a.ki,a.QI,a.j9,m.ez,m.mk,m.sg,m.O5,c.u5,c._Y,c.JJ,c.JL,c.Q7,c.nD,c.On,c.UX,c.sg,c.u,c.CE],styles:[".contenedor-principal[_ngcontent-%COMP%]{background:var(--primary-50)}.contenedor-principal[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]{height:8vh;padding:16px 32px 0}.contenedor-principal[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{text-align:start}.contenedor-principal[_ngcontent-%COMP%]   .titulo[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--primary-700);font-family:var(--font-display);font-size:24px;font-weight:700;line-height:32px}.contenedor-principal[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   .botones[_ngcontent-%COMP%]{background:var(--primary-50);height:15vh;width:100%;display:flex;flex-direction:column;justify-content:flex-end;padding:0 32px 36px}.contenedor-principal[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   .botones[_ngcontent-%COMP%]   .guardar[_ngcontent-%COMP%]{font-family:var(--font-body);font-size:16px;width:100%;max-width:600px;height:44px;--border-radius: 8px;color:var(--neutral-50);--background: var(--primary-700);--box-shadow: 0}.contenedor-principal[_ngcontent-%COMP%]   .formulario[_ngcontent-%COMP%]   .botones[_ngcontent-%COMP%]   .guardar.button-disabled[_ngcontent-%COMP%]{opacity:1;--background: var(--primary-300)}.contenedor-principal[_ngcontent-%COMP%]   .selection-button[_ngcontent-%COMP%]{width:100%;height:70px;margin:12px 0 0;--border-width: 1px;--border-style: solid;--border-color: var(--primary-700);--border-radius: 8px;font-family:var(--font-body);font-size:16px;font-weight:400;text-wrap:wrap!important;color:var(--primary-700);--background: var(--primary-50);--box-shadow: 0}.contenedor-principal[_ngcontent-%COMP%]   .selection-button.selected[_ngcontent-%COMP%]{color:var(--neutral-50);--background: var(--primary-700)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item[_ngcontent-%COMP%]{width:100%;margin-top:24px;--border-width: 1px;--border-color: var(--primary-400);--border-radius: 8px;--background: var(--primary-100)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{width:100%;font-family:var(--font-body);font-size:16px;font-weight:700;color:var(--primary-700)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--primary-700)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item.activated[_ngcontent-%COMP%]{--background: var(--primary-700)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item.activated[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{color:var(--neutral-50)}.contenedor-principal[_ngcontent-%COMP%]   ion-item.action-button-item.activated[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--neutral-50)}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]{padding:32px 0 0;background:var(--primary-50);width:100%}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]{background:var(--primary-100);padding:16px 16px 20px;border-width:1px;border-color:var(--primary-200);border-style:solid;border-radius:8px;height:170px;display:flex;flex-direction:column;align-items:center}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]::part(image){width:calc(100vw - 96px);height:92px;border-radius:8px;object-fit:cover}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]{padding-top:8px;display:flex;justify-content:space-between;height:100%;width:100%;align-items:center}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{max-width:calc(100% - 56px);overflow:hidden}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:var(--font-body);font-size:14px;color:var(--neutral-900);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:40px;width:40px;--border-radius: 4px;--border-style: solid;--border-width: 1px;--border-color: var(--error-200);--background: var(--error-100);--box-shadow: 0;margin:0}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px!important;color:var(--error-200)}.contenedor-principal[_ngcontent-%COMP%]   .adjuntar-elemento[_ngcontent-%COMP%]   .previsualizacion[_ngcontent-%COMP%]   .datos-archivo[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]::part(native){padding:0!important}ion-header.header-modal[_ngcontent-%COMP%]{--background: var(--neutral-50);border-bottom:1px solid var(--neutral-200)}ion-header.header-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding:52px 32px 0}ion-header.header-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-family:var(--font-body);font-size:18px;color:var(--neutral-800)}ion-header.header-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]::part(native){padding:0}ion-header.header-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px}.contenedor-principal-modal[_ngcontent-%COMP%]{height:100%;background:var(--neutral-50)}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-dias[_ngcontent-%COMP%]{width:100%;padding-top:48px;display:flex;justify-content:space-between}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-dias[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:40px!important;max-width:40px!important;height:40px!important;--border-radius: 100%;max-height:40px!important;--background: transparent;--box-shadow: 0;color:var(--neutral-500);font-family:var(--font-body);font-size:20px}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-dias[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]::part(native){padding:0}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-dias[_ngcontent-%COMP%]   ion-button.selected[_ngcontent-%COMP%]{--background: var(--primary-700);color:var(--neutral-50)}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-hora[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%], .contenedor-principal-modal[_ngcontent-%COMP%]   .horas-seleccionadas[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;align-items:flex-end;justify-content:flex-end}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-hora[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%], .contenedor-principal-modal[_ngcontent-%COMP%]   .horas-seleccionadas[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 8px;color:var(--neutral-50);min-width:68px;height:50px;margin:0 0 0 16px;--box-shadow: 0}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-hora[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   .agregar[_ngcontent-%COMP%], .contenedor-principal-modal[_ngcontent-%COMP%]   .horas-seleccionadas[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   .agregar[_ngcontent-%COMP%]{--background: var(--primary-700)}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-hora[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   .eliminar[_ngcontent-%COMP%], .contenedor-principal-modal[_ngcontent-%COMP%]   .horas-seleccionadas[_ngcontent-%COMP%]   .boton-agregar-eliminar[_ngcontent-%COMP%]   .eliminar[_ngcontent-%COMP%]{--background: var(--error-200)}.contenedor-principal-modal[_ngcontent-%COMP%]   .selector-hora[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;font-family:var(--font-body);font-size:16px;color:var(--neutral-900)}.contenedor-principal-modal[_ngcontent-%COMP%]   .horas-seleccionadas[_ngcontent-%COMP%]{margin-top:16px;padding-top:16px;border-top:1px solid var(--neutral-200)}"]}),l})()},6203:(P,_,r)=>{r.d(_,{n:()=>c});var s=r(1571),m=r(529);let c=(()=>{var a;class h{constructor(t){this.http=t,this.dataUrl="expedientePadecimiento/"}consultarPorUsuarioParaSelector(){return this.http.get(this.dataUrl+"consultarPorUsuarioSelector")}eliminar(t){return this.http.delete(this.dataUrl+`${t}`)}agregarPadecimiento(t){return this.http.post(this.dataUrl+"agregarExpedientePadecimiento",t)}}return(a=h).\u0275fac=function(t){return new(t||a)(s.LFG(m.eN))},a.\u0275prov=s.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),h})()},9134:(P,_,r)=>{r.d(_,{q:()=>c});var s=r(1571),m=r(529);let c=(()=>{var a;class h{constructor(t){this.http=t,this.url="expedienteDoctor/"}consultarExpediente(){return this.http.get(this.url)}consultarExpedienteConImagenes(){return this.http.get(this.url+"conImagenes")}consultarSelector(){return this.http.get(this.url+"selector")}consultarPorUsuarioParaSelector(){return this.http.get(this.url+"selectorPorUsuario")}eliminar(t){return this.http.delete(this.url+"eliminarDoctorTrackr",{body:t})}agregar(t){return this.http.post(this.url,t)}}return(a=h).\u0275fac=function(t){return new(t||a)(s.LFG(m.eN))},a.\u0275prov=s.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),h})()},281:(P,_,r)=>{r.d(_,{$:()=>c});var s=r(1571),m=r(529);let c=(()=>{var a;class h{constructor(t){this.http=t,this.dataUrl="expedienteTratamiento/"}consultarTratamientos(){return this.http.get(this.dataUrl+"consultarTratamientosTrackr")}consultarTratamientoDetalle(t){return this.http.get(this.dataUrl+`consultarTratamientoDetalle/${t}`)}agregar(t){return this.http.post(this.dataUrl+"agregar",t)}editarTratamiento(t){return this.http.put(this.dataUrl+"editar",t)}eliminarTratamiento(t){return this.http.delete(this.dataUrl+`eliminar/${t}`)}}return(a=h).\u0275fac=function(t){return new(t||a)(s.LFG(m.eN))},a.\u0275prov=s.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),h})()},4649:(P,_,r)=>{r.d(_,{Z:()=>h});var s=r(5861),m=r(6388);const a=(0,r(7423).fo)("FilePicker",{web:()=>r.e(3405).then(r.bind(r,3405)).then(f=>new f.FilePickerWeb)});class h{constructor(){var t=this;this.takePicture=(0,s.Z)(function*(){try{const T=yield m.V1.getPhoto({quality:90,allowEditing:!0,resultType:m.dk.DataUrl});if(t.imageSrc=T.dataUrl,t.imageSrc)return t.imageSrc;throw new Error("Error")}catch(T){throw console.error("Error al tomar la foto:",T),T}}),this.pickFiles=(0,s.Z)(function*(){const{files:T}=yield a.pickFiles({types:["image/png","image/jpeg","application/pdf","image/gif"],readData:!0});return T})}}}}]);